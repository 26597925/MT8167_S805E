From: WizMime<support@wiz.cn>
Subject: =?gb2312?B?NXN5c3RlbTMtLVp5Z290ZUluaXQuamF2YbfWzvYtLXp5Z290ZbXEyrXP1g==?=
Date: Date: Mon, 23 Oct 2017 08:44:08 +0800
MIME-Version: 1.0
Content-Type: multipart/related;
	type="multipart/alternative";
	boundary="----=_Next_Part_0415584234.833"

This is a multi-part message in MIME format.

------=_Next_Part_0415584234.833
Content-Type: multipart/alternative;
	boundary="----=_Next_Part_0138528078.115"


------=_Next_Part_0138528078.115
Content-Type: text/plain;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

This is a multi-part message in MIME format.

------=_Next_Part_0138528078.115
Content-Type: text/html;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML><html><head>=0D=0A<meta http-equiv=3D"Content-Type=
" content=3D"text/html; charset=3Dgb2312">=0A=0A<title>5system3--=
ZygoteInit.java=B7=D6=CE=F6--zygote=B5=C4=CA=B5=CF=D6</title>=0A=20=
   <!--mark |wiz_custom_css| for wizeditor replace it-->=0A<style=
 id=3D"wiz_custom_css">html, body {            font-size: 15px; =20=
      }        body {            font-family: Helvetica, 'Hiragin=
o Sans GB', '=CE=A2=C8=ED=D1=C5=BA=DA', 'Microsoft YaHei UI', Sim=
Sun, SimHei, arial, sans-serif;            line-height: 1.6;    =20=
       margin: 0;            padding: 20px 15px;            paddi=
ng: 1.33rem 1rem;        }        h1, h2, h3, h4, h5, h6 {      =20=
     margin: 20px 0 10px;            margin: 1.33rem 0 0.667rem;=20=
           padding: 0;            font-weight: bold;        }   =20=
    h1 {            font-size: 21px;            font-size: 1.4rem=
;        }        h2 {            font-size: 20px;            fon=
t-size: 1.33rem;        }        h3 {            font-size: 18px;=
            font-size: 1.2rem;        }        h4 {            fo=
nt-size: 17px;            font-size: 1.13rem;        }        h5=20=
{            font-size: 15px;            font-size: 1rem;       =20=
}        h6 {            font-size: 15px;            font-size: 1=
rem;            color: #777777;            margin: 1rem 0;      =20=
 }        div, p, ul, ol, dl, li {            margin: 0;        }=
        blockquote, table, pre, code {            margin: 8px 0;=20=
       }        ul, ol {            padding-left: 32px;         =20=
  padding-left: 2.13rem;        }        blockquote {           =20=
padding: 0 12px;            padding: 0 0.8rem;        }        bl=
ockquote > :first-child {            margin-top: 0;        }    =20=
   blockquote > :last-child {            margin-bottom: 0;      =20=
 }        img {            border: 0;            max-width: 100%;=
            height: auto !important;            margin: 2px 0;  =20=
     }        table {            border-collapse: collapse;     =20=
      border: 1px solid #bbbbbb;        }        td, th {       =20=
    padding: 4px 8px;            border-collapse: collapse;     =20=
      border: 1px solid #bbbbbb;			        }        @media only s=
creen and (-webkit-max-device-width: 1024px), only screen and (-o=
-max-device-width: 1024px), only screen and (max-device-width: 10=
24px), only screen and (-webkit-min-device-pixel-ratio: 3), only=20=
screen and (-o-min-device-pixel-ratio: 3), only screen and (min-d=
evice-pixel-ratio: 3) {            html, body {                fo=
nt-size: 17px;            }            body {                line=
-height: 1.7;                padding: 0.75rem 0.9375rem;        =20=
       color: #353c47;            }            h1 {             =20=
  font-size: 2.125rem;            }            h2 {             =20=
  font-size: 1.875rem;            }            h3 {             =20=
  font-size: 1.625rem;            }            h4 {             =20=
  font-size: 1.375rem;            }            h5 {             =20=
  font-size: 1.125rem;            }            h6 {             =20=
  color: inherit;            }            ul, ol {              =20=
 padding-left: 2.5rem;            }            blockquote {     =20=
          padding: 0 0.9375rem;            }        }</style></he=
ad>=0A=0A<body spellcheck=3D"false" ><div><span data-wiz-span=3D"=
data-wiz-span" style=3D"color:rgb(0, 0, 0);font-size:0.867rem"><b=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(255, 0=
, 0);">frameworks/base/core/java/com/android/internal/os/ZygoteIn=
it.java</span></b></span><br></div><div><span data-wiz-span=3D"da=
ta-wiz-span"><div><font color=3D"#ff0000"><span style=3D"font-siz=
e: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-=
wiz-span" style=3D"color: rgb(0, 0, 0);">/*</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">* Copyright (C) 2014 MediaTek In=
c.</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">* Modifi=
cation based on code covered by the mentioned copyright</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">* and/or permission=20=
notice(s).</span></span></font></div><div><font color=3D"#ff0000"=
><span style=3D"font-size: 13.005px; line-height: 20.808px;"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">=
*/</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">/*</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;* Copyright=20=
(C) 2007 The Android Open Source Project</span></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"color: rgb(0, 0, 0);">&nbsp;*</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">&nbsp;* Licensed under the Apache Lice=
nse, Version 2.0 (the "License");</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp;* you may not use this file except i=
n compliance with the License.</span></span></font></div><div><fo=
nt color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-hei=
ght: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"co=
lor: rgb(0, 0, 0);">&nbsp;* You may obtain a copy of the License=20=
at</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;*<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;* &nb=
sp; &nbsp; &nbsp;http://www.apache.org/licenses/LICENSE-2.0</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;*</span></sp=
an></font></div><div><font color=3D"#ff0000"><span style=3D"font-=
size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;* Unless requir=
ed by applicable law or agreed to in writing, software</span></sp=
an></font></div><div><font color=3D"#ff0000"><span style=3D"font-=
size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;* distributed u=
nder the License is distributed on an "AS IS" BASIS,</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;* WITHOUT WARRANT=
IES OR CONDITIONS OF ANY KIND, either express or implied.</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;* See the Li=
cense for the specific language governing permissions and</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;* limitation=
s under the License.</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp;*/</span></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><br></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz=
-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">package co=
m.android.internal.os;</span></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><br></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">impor=
t static android.system.OsConstants.POLLIN;</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">import static android.system.OsC=
onstants.S_IRWXG;</span></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0=
, 0);">import static android.system.OsConstants.S_IRWXO;</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><br></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">import android.content.res.Resources=
;</span></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wi=
z-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">import an=
droid.content.res.TypedArray;</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"col=
or: rgb(0, 0, 0);">import android.icu.impl.CacheValue;</span></sp=
an></font></div><div><font color=3D"#ff0000"><span style=3D"font-=
size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"color: rgb(0, 0, 0);">import android.icu.te=
xt.DecimalFormatSymbols;</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: r=
gb(0, 0, 0);">import android.icu.util.ULocale;</span></span></fon=
t></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13=
.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"color: rgb(0, 0, 0);">import android.net.LocalServe=
rSocket;</span></span></font></div><div><font color=3D"#ff0000"><=
span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">im=
port android.opengl.EGL14;</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">import android.os.Process;</span></span></font></=
div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005=
px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"color: rgb(0, 0, 0);">import android.os.SystemClock;</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">import android.=
os.SystemProperties;</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">import android.os.Trace;</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">import android.security.keystore.AndroidKe=
yStoreProvider;</span></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=20=
0);">import android.system.ErrnoException;</span></span></font></=
div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005=
px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"color: rgb(0, 0, 0);">import android.system.Os;</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">import android.sys=
tem.OsConstants;</span></span></font></div><div><font color=3D"#f=
f0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;=
"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=
 0);">import android.system.StructPollfd;</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">import android.text.Hyphenator;</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">import android.=
util.EventLog;</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">import android.util.Log;</span></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">import android.webkit.WebViewFactory;</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">import android.widge=
t.TextView;</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><br=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">import com.android=
.internal.os.InstallerConnection.InstallerException;</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><br></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">import dalvik.system.DexFile;</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">import dalvik.system.Pa=
thClassLoader;</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">import dalvik.system.VMRuntime;</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">import dalvik.system.ZygoteHooks;</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><br></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">import libcore.io.IoUtils;</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><br></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">import java.io.BufferedReader;</span>=
</span></font></div><div><font color=3D"#ff0000"><span style=3D"f=
ont-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">import java.io.Fil=
eDescriptor;</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">import java.io.FileInputStream;</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">import java.io.FileNotFoundException;</spa=
n></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">import java.io.=
IOException;</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">import java.io.InputStream;</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"col=
or: rgb(0, 0, 0);">import java.io.InputStreamReader;</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">import java.lang.reflec=
t.InvocationTargetException;</span></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">import java.lang.reflect.Method;</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">import java.security.Secu=
rity;</span></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">impor=
t java.security.Provider;</span></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=20=
rgb(0, 0, 0);">import java.util.ArrayList;</span></span></font></=
div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005=
px; line-height: 20.808px;"><br></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=20=
rgb(0, 0, 0);">/// M: Added for BOOTPROF @{</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">import java.io.ObjectOutputStrea=
m;</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">import j=
ava.io.FileOutputStream;</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><br></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">imp=
ort com.mediatek.common.PluginLoader;</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">/// @}</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">/**</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp;* Startup class for the zygote process.</sp=
an></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;*</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;* Pre-initia=
lizes some classes, and then waits for commands on a UNIX domain<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;* soc=
ket. Based on these commands, forks off child processes that inhe=
rit</span></span></font></div><div><font color=3D"#ff0000"><span=20=
style=3D"font-size: 13.005px; line-height: 20.808px;"><span data-=
wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;*=
 the initial state of the VM.</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"col=
or: rgb(0, 0, 0);">&nbsp;*</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp;* Please see {@link ZygoteConnection.Argume=
nts} for documentation on the</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"col=
or: rgb(0, 0, 0);">&nbsp;* client protocol.</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp;*</span></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"color: rgb(0, 0, 0);">&nbsp;* @hide</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp;*/</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">public class ZygoteInit {</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"=
data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; priva=
te static final String TAG =3D "Zygote";</span></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><br></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; private static final String PROPERTY_D=
ISABLE_OPENGL_PRELOADING =3D "ro.zygote.disable_gl_preload";</spa=
n></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; p=
rivate static final String PROPERTY_RUNNING_IN_CONTAINER =3D "ro.=
boot.container";</span></span></font></div><div><font color=3D"#f=
f0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;=
"><br></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbs=
p; private static final String ANDROID_SOCKET_PREFIX =3D "ANDROID=
_SOCKET_";</span></span></font></div><div><font color=3D"#ff0000"=
><span style=3D"font-size: 13.005px; line-height: 20.808px;"><br>=
</span></font></div><div><font color=3D"#ff0000"><span style=3D"f=
ont-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; priv=
ate static final int LOG_BOOT_PROGRESS_PRELOAD_START =3D 3020;</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; p=
rivate static final int LOG_BOOT_PROGRESS_PRELOAD_END =3D 3030;</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><br></span></fon=
t></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13=
.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; /** when preloa=
ding, GC after allocating this many bytes */</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; //private static=20=
final int PRELOAD_GC_THRESHOLD =3D 50000;</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; private static final=
 String heapgrowthlimit =3D</span></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; SystemProperties.get("dalvik.vm.heapgrowthl=
imit", "64m");</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; private static final int PRELOAD_GC_THRESHOLD =3D=
 Integer.parseInt(</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; heapgrowthlimit.substring(0, heapgrowthlimit.length(=
) - 1)) * 1024 * 1024 / 32;</span></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><br></span></font></div><div><font color=3D"#ff0000"=
><span style=3D"font-size: 13.005px; line-height: 20.808px;"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">=
&nbsp; &nbsp; private static final String ABI_LIST_ARG =3D "--abi=
-list=3D";</span></span></font></div><div><font color=3D"#ff0000"=
><span style=3D"font-size: 13.005px; line-height: 20.808px;"><br>=
</span></font></div><div><font color=3D"#ff0000"><span style=3D"f=
ont-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; priv=
ate static final String SOCKET_NAME_ARG =3D "--socket-name=3D";</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><br></span></fon=
t></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13=
.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; private static=20=
LocalServerSocket sServerSocket;</span></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><br></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=20=
0);">&nbsp; &nbsp; /// M: GMO Zygote64 on demand @{</span></span>=
</font></div><div><font color=3D"#ff0000"><span style=3D"font-siz=
e: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-=
wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; private st=
atic final String PROP_ZYGOTE_ON_DEMAND_ENABLE =3D "ro.mtk_gmo_zy=
gote_on_demand";</span></span></font></div><div><font color=3D"#f=
f0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;=
"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=
 0);">&nbsp; &nbsp; private static final String PROP_ZYGOTE_ON_DE=
MAND_DEBUG =3D "persist.sys.mtk_zygote_debug";</span></span></fon=
t></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13=
.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; private static=20=
final String PROP_ZYGOTE_ON_DEMAND_PRELOAD =3D "persist.sys.mtk_z=
ygote_preload";</span></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><br></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp=
; static final boolean sZygoteOnDemandEnabled =3D</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; SystemProperties.get(PROP_ZYGOTE_ON_DEMAND_ENABLE).equals("1");=
</span></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz=
-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nb=
sp; static boolean DEBUG_ZYGOTE_ON_DEMAND =3D false ||</span></sp=
an></font></div><div><font color=3D"#ff0000"><span style=3D"font-=
size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=20=
&nbsp; SystemProperties.get(PROP_ZYGOTE_ON_DEMAND_DEBUG).equals("=
1");</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><br></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; static bo=
olean sZygoteReady =3D false;</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"col=
or: rgb(0, 0, 0);">&nbsp; &nbsp; /// M: GMO Zygote64 on demand @}=
</span></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><br></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; /**</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
* Used to pre-load resources. &nbsp;We hold a global reference on=
 it so it</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; &nbsp;* never gets destroyed.</span></span></font></=
div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005=
px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;*/</span></sp=
an></font></div><div><font color=3D"#ff0000"><span style=3D"font-=
size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; private=
 static Resources mResources;</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><br></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; /**</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp;* The path of a file that contains c=
lasses to preload.</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp;*/</span></span></font></div><div><fo=
nt color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-hei=
ght: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"co=
lor: rgb(0, 0, 0);">&nbsp; &nbsp; private static final String PRE=
LOADED_CLASSES =3D "/system/etc/preloaded-classes";</span></span>=
</font></div><div><font color=3D"#ff0000"><span style=3D"font-siz=
e: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-=
wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; private st=
atic final String TAG1 =3D "Plug-PluginLoad";</span></span></font=
></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.=
005px; line-height: 20.808px;"><br></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">&nbsp; &nbsp; /** Controls whether we should pr=
eload resources during zygote init. */</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; public static final boo=
lean PRELOAD_RESOURCES =3D true;</span></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><br></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=20=
0);">&nbsp; &nbsp; /// M: Added for BOOTPROF @{</span></span></fo=
nt></div><div><font color=3D"#ff0000"><span style=3D"font-size: 1=
3.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-=
span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; private static=
 boolean MTPROF_DISABLE =3D false;</span></span></font></div><div=
><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line=
-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; private static void addBootE=
vent(String bootevent) {</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: r=
gb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; if (MTPROF_DISABLE) {</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; return;</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; }</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"=
data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp=
; &nbsp; FileOutputStream fos =3D null;</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; try {</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; fos =3D new FileOutputStream("/proc/bo=
otprof");</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fos.write(bootevent.getB=
ytes());</span></span></font></div><div><font color=3D"#ff0000"><=
span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fos.flush();</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; } catch (FileNotFoundException e) {</span></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; Log.e("BOOTPROF", "Failure open /proc/bootprof, not found!=
", e);</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp; &nbsp; } catch (java.io.IOException e) {</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; Log.e("BOOTPROF", "Failure open /proc/boo=
tprof entry", e);</span></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0=
, 0);">&nbsp; &nbsp; &nbsp; &nbsp; } finally {</span></span></fon=
t></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13=
.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; if (fos !=3D null) {</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; try {</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; fos.close();</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; } catch (IOException e) {</span></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"=
color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; Log.e("BOOTPROF", "Failure close /proc=
/bootprof entry", e);</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
}</span></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wi=
z-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div=
><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line=
-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; }</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; }</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; ///=20=
@}</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><br></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; /**</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p;* Registers a server socket for zygote command connections</spa=
n></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp;*</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp;* @throws RuntimeException when open fails</span>=
</span></font></div><div><font color=3D"#ff0000"><span style=3D"f=
ont-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p;*/</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; private static void registerZygoteSocket(String socketNam=
e) {</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; &nbsp; &nbsp; if (sServerSocket =3D=3D null) {</span></sp=
an></font></div><div><font color=3D"#ff0000"><span style=3D"font-=
size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; int fileDesc;</span></span></font></div><div=
><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line=
-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
final String fullSocketName =3D ANDROID_SOCKET_PREFIX + socketNam=
e;</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; String env =3D System.getenv(fullSocketName);=
</span></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz=
-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fileDesc =3D Intege=
r.parseInt(env);</span></span></font></div><div><font color=3D"#f=
f0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;=
"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=
 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (RuntimeE=
xception ex) {</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw=
 new RuntimeException(fullSocketName + " unset or invalid", ex);<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><br></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=20=
0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; FileDescriptor fd =3D new FileDe=
scriptor();</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fd.setIn=
t$(fileDesc);</span></span></font></div><div><font color=3D"#ff00=
00"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><=
span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0)=
;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sServe=
rSocket =3D new LocalServerSocket(fd);</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; } catch (IOException ex) {</span></span></font></div><div><f=
ont color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-he=
ight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"c=
olor: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; throw new RuntimeException(</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Error binding to=
 local socket '" + fileDesc + "'", ex);</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; }</span></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nb=
sp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font></div><div><f=
ont color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-he=
ight: 20.808px;"><br></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; /**</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp;* Waits for and accepts a single com=
mand connection. Throws</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; &nbsp;* RuntimeException on failure.</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp=
; &nbsp;*/</span></span></font></div><div><font color=3D"#ff0000"=
><span style=3D"font-size: 13.005px; line-height: 20.808px;"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">=
&nbsp; &nbsp; private static ZygoteConnection acceptCommandPeer(S=
tring abiList) {</span></span></font></div><div><font color=3D"#f=
f0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;=
"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=
 0);">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; return new ZygoteConnection(sServerSocket.accept(), abiList=
);</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp; &nbsp; } catch (IOException ex) {</span></span></fon=
t></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13=
.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; throw new RuntimeException(</span></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "IOException during accept()",=
 ex);</span></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp=
; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: r=
gb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><br></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; /**</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp;* Close and clean up zygote sockets.=
 Called on shutdown and on the</span></span></font></div><div><fo=
nt color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-hei=
ght: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"co=
lor: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* child's exit path.</spa=
n></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp;*/</span></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nb=
sp; &nbsp; static void closeServerSocket() {</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; try=
 {</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (sServerSocket !=3D null) {<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FileDescriptor fd =3D=
 sServerSocket.getFileDescriptor();</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; sServerSocket.close();</span></span></font></div><d=
iv><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; li=
ne-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=
=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; if (fd !=3D null) {</span></span></font></div><d=
iv><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; li=
ne-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=
=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; Os.close(fd);</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; } catch (IOException ex) {</span></span></font></div><d=
iv><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; li=
ne-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=
=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; Log.e(TAG, "Zygote: &nbsp;error closing sockets", ex);</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; } catch (ErrnoException ex) {</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; Log.e(TAG, "Zygote: &nbsp;error closing descriptor", ex);</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp=
; &nbsp; &nbsp; }</span></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><br></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz=
-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nb=
sp; &nbsp; &nbsp; sServerSocket =3D null;</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></fon=
t></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13=
.005px; line-height: 20.808px;"><br></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"col=
or: rgb(0, 0, 0);">&nbsp; &nbsp; /**</span></span></font></div><d=
iv><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; li=
ne-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=
=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* Return the server=
 socket's underlying file descriptor, so that</span></span></font=
></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.=
005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* ZygoteCo=
nnection can pass it to the native code for proper</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* clo=
sure after a child process is forked off.</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;*/</span></spa=
n></font></div><div><font color=3D"#ff0000"><span style=3D"font-s=
ize: 13.005px; line-height: 20.808px;"><br></span></font></div><d=
iv><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; li=
ne-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=
=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; static FileDescriptor get=
ServerSocketFileDescriptor() {</span></span></font></div><div><fo=
nt color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-hei=
ght: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"co=
lor: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; return sServerSoc=
ket.getFileDescriptor();</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: r=
gb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><br></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; private static final int UNPRIVILEGED_UID =3D 999=
9;</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; private static final int UNPRIVILEGED_GID =3D 9999;</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><br></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; private static final=20=
int ROOT_UID =3D 0;</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; private static final int ROOT_GID =3D 0;</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><br></span></fon=
t></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13=
.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; /// M: GMO Zygo=
te64 on demand @{</span></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0=
, 0);">&nbsp; &nbsp; /// M: Added for Zygote preload control @{</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp=
; static void preloadByName(String name) {</span></span></font></=
div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005=
px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; if (s=
ZygoteOnDemandEnabled) {</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: r=
gb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ("zygo=
te".equals(name)) {</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
preload();</span></span></font></div><div><font color=3D"#ff0000"=
><span style=3D"font-size: 13.005px; line-height: 20.808px;"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; preloadSecondary();</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; }</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; } else {</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; preload();</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><br></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; static void preloadSecondary() {</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; Log.d(TAG, "begin preload 2");</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; prel=
oadClasses();</span></span></font></div><div><font color=3D"#ff00=
00"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><=
br></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; if ("1".equals(SystemProperties.get(PROP_ZYGOTE_ON_D=
EMAND_PRELOAD, "0"))) {</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; preloadRes=
ources();</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; preloadOpenGL();</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; preloadSharedLibraries();</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; preloadTextResources();</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; WebViewFactory.prepareWebViewInZygote();</span></span></fon=
t></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13=
.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; }=
</span></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><br></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=
 Log.d(TAG, "end preload 2");</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"col=
or: rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font></div><div=
><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line=
-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; /// @}</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; /// M: GMO Zygote6=
4 on demand @}</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<br></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; s=
tatic void preload() {</span></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb=
(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; Log.d(TAG, "begin preload=
");</span></span></font></div><div><font color=3D"#ff0000"><span=20=
style=3D"font-size: 13.005px; line-height: 20.808px;"><span data-=
wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=20=
&nbsp; &nbsp; &nbsp; Trace.traceBegin(Trace.TRACE_TAG_DALVIK, "Be=
ginIcuCachePinning");</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; beginIcuCachePinning();</spa=
n></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; Trace.traceEnd(Trace.TRACE_TAG_DALVIK);</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; Trace.traceBegin(Trace.TRACE_TAG_DALVIK, "PreloadClasses");<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbs=
p; &nbsp; &nbsp; preloadClasses();</span></span></font></div><div=
><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line=
-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; Trace.traceEnd=
(Trace.TRACE_TAG_DALVIK);</span></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=20=
rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; Trace.traceBegin(Trace=
.TRACE_TAG_DALVIK, "PreloadResources");</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; preloadR=
esources();</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; Trace.traceEnd(Trace.TRACE_TAG_DALVI=
K);</span></span></font></div><div><font color=3D"#ff0000"><span=20=
style=3D"font-size: 13.005px; line-height: 20.808px;"><span data-=
wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=20=
&nbsp; &nbsp; &nbsp; Trace.traceBegin(Trace.TRACE_TAG_DALVIK, "Pr=
eloadOpenGL");</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; &nbsp; &nbsp; preloadOpenGL();</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=
 Trace.traceEnd(Trace.TRACE_TAG_DALVIK);</span></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; preload=
SharedLibraries();</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; preloadTextResources();</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; // Ask the WebViewFactory to do any initialization that=
 must run in the zygote process,</span></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"=
color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; // for memory s=
haring purposes.</span></span></font></div><div><font color=3D"#f=
f0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;=
"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=
 0);">&nbsp; &nbsp; &nbsp; &nbsp; WebViewFactory.prepareWebViewIn=
Zygote();</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; &nbsp; &nbsp; endIcuCachePinning();</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=
 warmUpJcaProviders();</span></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb=
(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; Log.d(TAG, "end preload")=
;</span></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wi=
z-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &n=
bsp; }</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><br></sp=
an></font></div><div><font color=3D"#ff0000"><span style=3D"font-=
size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; private=
 static void beginIcuCachePinning() {</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; // Pin ICU=
 data in memory from this point that would normally be held by so=
ft references.</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; &nbsp; &nbsp; // Without this, any references c=
reated immediately below or during class preloading</span></span>=
</font></div><div><font color=3D"#ff0000"><span style=3D"font-siz=
e: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-=
wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nb=
sp; // would be collected when the Zygote GC runs in gcAndFinaliz=
e().</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; &nbsp; &nbsp; Log.i(TAG, "Installing ICU cache reference=20=
pinning...");</span></span></font></div><div><font color=3D"#ff00=
00"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><=
br></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; CacheValue.setStrength(CacheValue.Strength.STRONG);<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><br></span></fo=
nt></div><div><font color=3D"#ff0000"><span style=3D"font-size: 1=
3.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-=
span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=20=
Log.i(TAG, "Preloading ICU data...");</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; // Explici=
tly exercise code to cache data apps are likely to need.</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"=
data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp=
; &nbsp; ULocale[] localesToPin =3D { ULocale.ROOT, ULocale.US, U=
Locale.getDefault() };</span></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb=
(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; for (ULocale uLocale : lo=
calesToPin) {</span></span></font></div><div><font color=3D"#ff00=
00"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><=
span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0)=
;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new DecimalFormatSym=
bols(uLocale);</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /// N: Added f=
or Boot time profiling @{</span></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=20=
rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; Log.i(TAG, "Preloading=
 ICU data --- End");</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /// @}</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><br></span></font></div><div><f=
ont color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-he=
ight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"c=
olor: rgb(0, 0, 0);">&nbsp; &nbsp; private static void endIcuCach=
ePinning() {</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; &nbsp; &nbsp; // All cache references created by=20=
ICU from this point will be soft.</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; CacheValue.set=
Strength(CacheValue.Strength.SOFT);</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><br></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; Log.i(TAG, "Uninstalled ICU c=
ache reference pinning...");</span></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><br></span></font></div><div><font color=3D"#f=
f0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;=
"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=
 0);">&nbsp; &nbsp; private static void preloadSharedLibraries()=20=
{</span></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wi=
z-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &n=
bsp; &nbsp; &nbsp; Log.i(TAG, "Preloading shared libraries...");<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbs=
p; &nbsp; &nbsp; System.loadLibrary("android");</span></span></fo=
nt></div><div><font color=3D"#ff0000"><span style=3D"font-size: 1=
3.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-=
span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=20=
System.loadLibrary("compiler_rt");</span></span></font></div><div=
><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line=
-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; System.loadLib=
rary("jnigraphics");</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /// N: Added for Boot time p=
rofiling @{</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; Log.i(TAG, "Preloading shared librar=
ies --- End");</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; &nbsp; &nbsp; /// @}</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><br></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; private static void preloadOpenGL()=
 {</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp; &nbsp; /// N: Added for Boot time profiling @{</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; Log.i(TAG, "Preloading OpenGL...");</span></span></font=
></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.=
005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; //=
/ @}</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; &nbsp; &nbsp; if (!SystemProperties.getBoolean(PROPERTY_D=
ISABLE_OPENGL_PRELOADING, false)) {</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
EGL14.eglGetDisplay(EGL14.EGL_DEFAULT_DISPLAY);</span></span></fo=
nt></div><div><font color=3D"#ff0000"><span style=3D"font-size: 1=
3.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-=
span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=20=
}</span></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wi=
z-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &n=
bsp; &nbsp; &nbsp; /// N: Added for Boot time profiling @{</span>=
</span></font></div><div><font color=3D"#ff0000"><span style=3D"f=
ont-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; Log.i(TAG, "Preloading OpenGL --- End");</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbs=
p; /// @}</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; }</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<br></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; p=
rivate static void preloadTextResources() {</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; ///=20=
N: Added for Boot time profiling @{</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; Log.i(TAG, "Pr=
eloading TextResources...");</span></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /// @}</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; Hyphenator.init();</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; TextView.preloadFontCach=
e();</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; &nbsp; &nbsp; /// N: Added for Boot time profiling @{</sp=
an></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; Log.i(TAG, "Preloading TextResources --- End");</spa=
n></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; /// @}</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; }</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><br></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nb=
sp; &nbsp; /**</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; &nbsp;* Register AndroidKeyStoreProvider and wa=
rm up the providers that are already registered.</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;*</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p;* By doing it here we avoid that each app does it when requesti=
ng a service from the</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp;* provider for the first time.</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p;*/</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; private static void warmUpJcaProviders() {</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbs=
p; long startTime =3D SystemClock.uptimeMillis();</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; Trace.traceBegin(</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
Trace.TRACE_TAG_DALVIK, "Starting installation of AndroidKeyStore=
Provider");</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; // AndroidKeyStoreProvider.install()=
 manipulates the list of JCA providers to insert</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=
 // preferred providers. Note this is not done via security.prope=
rties as the JCA providers</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; // are not on the cla=
sspath in the case of, for example, raw dalvikvm runtimes.</span>=
</span></font></div><div><font color=3D"#ff0000"><span style=3D"f=
ont-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; AndroidKeyStoreProvider.install();</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; Log=
.i(TAG, "Installed AndroidKeyStoreProvider in "</span></span></fo=
nt></div><div><font color=3D"#ff0000"><span style=3D"font-size: 1=
3.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-=
span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; + (SystemClock.uptimeMillis() - start=
Time) + "ms.");</span></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=20=
0);">&nbsp; &nbsp; &nbsp; &nbsp; Trace.traceEnd(Trace.TRACE_TAG_D=
ALVIK);</span></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><br></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; startTime =3D SystemClock.uptimeMillis();</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; Trace.traceBegin(</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
Trace.TRACE_TAG_DALVIK, "Starting warm up of JCA providers");</sp=
an></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; for (Provider p : Security.getProviders()) {</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; p.warmUpServiceProvision();</span></span>=
</font></div><div><font color=3D"#ff0000"><span style=3D"font-siz=
e: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-=
wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nb=
sp; }</span></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp=
; &nbsp; &nbsp; &nbsp; Log.i(TAG, "Warmed up JCA providers in "</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + (SystemClock.uptime=
Millis() - startTime) + "ms.");</span></span></font></div><div><f=
ont color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-he=
ight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"c=
olor: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; Trace.traceEnd(T=
race.TRACE_TAG_DALVIK);</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; }</span></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><br></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; /**</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp;* Performs Zygote process initializat=
ion. Loads and initializes</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* commonly used classes.</spa=
n></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp;*</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp;* Most classes only cause a few hundred bytes to=20=
be allocated, but</span></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0=
, 0);">&nbsp; &nbsp; &nbsp;* a few will allocate a dozen Kbytes (=
in one case, 500+K).</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp;*/</span></span></font></div><div><f=
ont color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-he=
ight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"c=
olor: rgb(0, 0, 0);">&nbsp; &nbsp; private static void preloadCla=
sses() {</span></span></font></div><div><font color=3D"#ff0000"><=
span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&n=
bsp; &nbsp; &nbsp; &nbsp; final VMRuntime runtime =3D VMRuntime.g=
etRuntime();</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><b=
r></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; InputStream is;</span></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></span>=
</font></div><div><font color=3D"#ff0000"><span style=3D"font-siz=
e: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-=
wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; is =3D new FileInputStream(PRELOADED_CLASSES);<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbs=
p; &nbsp; &nbsp; } catch (FileNotFoundException e) {</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; Log.e(TAG, "Couldn't find " + PRELOADED_CLASSE=
S + ".");</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=
 }</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><br></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbs=
p; Log.i(TAG, "Preloading classes...");</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; long sta=
rtTime =3D SystemClock.uptimeMillis();</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><br></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; // Drop root perms while run=
ning static initializers.</span></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=20=
rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; final int reuid =3D Os=
.getuid();</span></span></font></div><div><font color=3D"#ff0000"=
><span style=3D"font-size: 13.005px; line-height: 20.808px;"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">=
&nbsp; &nbsp; &nbsp; &nbsp; final int regid =3D Os.getgid();</spa=
n></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><br></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; // W=
e need to drop root perms only if we're already root. In the case=
 of "wrapped"</span></span></font></div><div><font color=3D"#ff00=
00"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><=
span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0)=
;">&nbsp; &nbsp; &nbsp; &nbsp; // processes (see WrapperInit), th=
is function is called from an unprivileged uid</span></span></fon=
t></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13=
.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /=
/ and gid.</span></span></font></div><div><font color=3D"#ff0000"=
><span style=3D"font-size: 13.005px; line-height: 20.808px;"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">=
&nbsp; &nbsp; &nbsp; &nbsp; boolean droppedPriviliges =3D false;<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbs=
p; &nbsp; &nbsp; if (reuid =3D=3D ROOT_UID &amp;&amp; regid =3D=3D=
 ROOT_GID) {</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; Os.setregid(ROOT_GID, UNPRIVILEGED_=
GID);</span></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Os.setreuid(RO=
OT_UID, UNPRIVILEGED_UID);</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch=
 (ErrnoException ex) {</span></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb=
(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; throw new RuntimeException("Failed to drop root", ex);</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><br></span></font></div><div><font color=3D"#ff0000"><=
span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; droppedPriviliges =3D tru=
e;</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><br></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp; &nbsp; // Alter the target heap utilization. &nbsp;W=
ith explicit GCs this</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; // is not likely to have any=
 effect.</span></span></font></div><div><font color=3D"#ff0000"><=
span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&n=
bsp; &nbsp; &nbsp; &nbsp; float defaultUtilization =3D runtime.ge=
tTargetHeapUtilization();</span></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=20=
rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; runtime.setTargetHeapU=
tilization(0.8f);</span></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><br></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz=
-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nb=
sp; &nbsp; &nbsp; /// M: Added for BOOTPROF</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; int=20=
count =3D 0;</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
BufferedReader br</span></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0=
, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =3D=
 new BufferedReader(new InputStreamReader(is), 256);</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><br></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
String line;</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while ((line =3D br.r=
eadLine()) !=3D null) {</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; // Skip comments and blank lines.</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; line =3D line.trim();</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; if (line.startsWith("#") || line.equals(""))=20=
{</span></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wi=
z-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cont=
inue;</span></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><br></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; Trace.traceBegin(Trace.TRACE_TAG_DALVIK, "PreloadCl=
ass " + line);</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {=
</span></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz=
-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (f=
alse) {</span></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; Log.v(TAG, "Preloading " + line + "...");</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></spa=
n></font></div><div><font color=3D"#ff0000"><span style=3D"font-s=
ize: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Load and expli=
citly initialize the given class. Use</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; // Class.forName(String, boolean,=
 ClassLoader) to avoid repeated stack lookups</span></span></font=
></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.=
005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // (to derive the caller'=
s class-loader). Use true to force initialization, and</span></sp=
an></font></div><div><font color=3D"#ff0000"><span style=3D"font-=
size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // null for the=20=
boot classpath class-loader (could as well cache the</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // class-loader of=
 this class in a variable).</span></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; Class.forName(line, true, null);</span></sp=
an></font></div><div><font color=3D"#ff0000"><span style=3D"font-=
size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; count++;</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (ClassNotFoundExcep=
tion e) {</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; Log.w(TAG, "Class not found for preloading: " + line);</span>=
</span></font></div><div><font color=3D"#ff0000"><span style=3D"f=
ont-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (UnsatisfiedLinkErr=
or e) {</span></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
; Log.w(TAG, "Problem preloading " + line + ": " + e);</span></sp=
an></font></div><div><font color=3D"#ff0000"><span style=3D"font-=
size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (Throwable t) {</span>=
</span></font></div><div><font color=3D"#ff0000"><span style=3D"f=
ont-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Log.e(TAG, "E=
rror preloading " + line + ".", t);</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; if (t instanceof Error) {</span></spa=
n></font></div><div><font color=3D"#ff0000"><span style=3D"font-s=
ize: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thr=
ow (Error) t;</span></span></font></div><div><font color=3D"#ff00=
00"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><=
span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0)=
;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; }</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; if (t instanceof RuntimeException) {</span></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw (RuntimeEx=
ception) t;</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; }</span></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
; throw new RuntimeException(t);</span></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"=
color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; }</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Trace=
.traceEnd(Trace.TRACE_TAG_DALVIK);</span></span></font></div><div=
><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line=
-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
}</span></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><br></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; Log.i(TAG, "...preloaded " + count + " classes in=
 "</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + (=
SystemClock.uptimeMillis()-startTime) + "ms.");</span></span></fo=
nt></div><div><font color=3D"#ff0000"><span style=3D"font-size: 1=
3.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-=
span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=20=
} catch (IOException e) {</span></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=20=
rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Log.e(TA=
G, "Error reading " + PRELOADED_CLASSES + ".", e);</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbs=
p; } finally {</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IoUtils.closeQuietl=
y(is);</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Restore default.</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; runtime.setTargetHeapUtilization(defaultU=
tilization);</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><b=
r></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; // Fill in dex caches with classes, fi=
elds, and methods brought in by preloading.</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; Trace.traceBegin(Trace.TRACE_TAG_DALVIK, "PreloadDexCac=
hes");</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; runtime.preloadDexCaches();=
</span></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz=
-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; Trace.traceEnd(Trace.TRACE_TAG_DA=
LVIK);</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><br></sp=
an></font></div><div><font color=3D"#ff0000"><span style=3D"font-=
size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; // Bring back root. We'll need it later if w=
e're in the zygote.</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (droppedPri=
viliges) {</span></span></font></div><div><font color=3D"#ff0000"=
><span style=3D"font-size: 13.005px; line-height: 20.808px;"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</sp=
an></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Os.setreui=
d(ROOT_UID, ROOT_UID);</span></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb=
(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; Os.setregid(ROOT_GID, ROOT_GID);</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; } catch (ErrnoException ex) {</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Run=
timeException("Failed to restore root", ex);</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; /// M: Added for BOOTPROF @{</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; addBootEvent("Zygote:Preload " + count + " cla=
sses in " +</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (SystemClock.uptimeMil=
lis() - startTime) + "ms");</span></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /// @}=
</span></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz=
-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nb=
sp; &nbsp; &nbsp; }</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; }</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><br></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nb=
sp; &nbsp; /**</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; &nbsp;* Load in commonly used resources, so the=
y can be shared across</span></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb=
(0, 0, 0);">&nbsp; &nbsp; &nbsp;* processes.</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;*</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
* These tend to be a few Kbytes, but are frequently in the 20-40K=
</span></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz=
-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nb=
sp; &nbsp;* range, and occasionally even larger.</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;*/</spa=
n></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; p=
rivate static void preloadResources() {</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; final VM=
Runtime runtime =3D VMRuntime.getRuntime();</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><br></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; mResources =3D Resources.getSystem();</span></spa=
n></font></div><div><font color=3D"#ff0000"><span style=3D"font-s=
ize: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; mResources.startPreloading();</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; if (PRELOAD_RESOURCES) {</span></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; Log.i(TAG, "Preloading resources...");</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><br></span></font></=
div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005=
px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; long startTime =3D SystemClock.uptimeMilli=
s();</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TypedArray ar =3D=
 mResources.obtainTypedArray(</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"col=
or: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; com.android.internal.R.arra=
y.preloaded_drawables);</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; int N =3D preloadDrawables(ar);</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; ar.recycle();</span></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; Log.i(TAG, "...preloaded " + N + " resources in "</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 + (SystemClock.uptimeMillis()-startTime) + "ms.");</span></span>=
</font></div><div><font color=3D"#ff0000"><span style=3D"font-siz=
e: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-=
wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; addBootEvent("Zygote:Preload " +=20=
N + " obtain resources in " +</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"col=
or: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 (SystemClock.uptimeMillis() - startTime) + "ms");</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><br></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; startTime =3D SystemClock.uptimeMillis();</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ar =3D mResources.obtainTyped=
Array(</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; com.android.internal.R.array.preloaded_color_state=
_lists);</span></span></font></div><div><font color=3D"#ff0000"><=
span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; N =3D prelo=
adColorStateLists(ar);</span></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb=
(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; ar.recycle();</span></span></font></div><div><font color=3D"#f=
f0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;=
"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=
 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Log=
.i(TAG, "...preloaded " + N + " resources in "</span></span></fon=
t></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13=
.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + (SystemC=
lock.uptimeMillis()-startTime) + "ms.");</span></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><br></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; if (mResources.getBoolean(</span></span></font></div><div><fo=
nt color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-hei=
ght: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"co=
lor: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; com.android.internal.R.boo=
l.config_freeformWindowManagement)) {</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; startTime =3D SystemClock.uptimeM=
illis();</span></span></font></div><div><font color=3D"#ff0000"><=
span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; ar =3D mResources.obtainTypedArray(</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; com.=
android.internal.R.array.preloaded_freeform_multi_window_drawable=
s);</span></span></font></div><div><font color=3D"#ff0000"><span=20=
style=3D"font-size: 13.005px; line-height: 20.808px;"><span data-=
wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; N=20=
=3D preloadDrawables(ar);</span></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=20=
rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; ar.recycle();</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; Log.i(TAG, "...preloaded " + N + " re=
source in "</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + (SystemClock.uptimeMillis() -=
 startTime) + "ms.");</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
}</span></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><br></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; /// M: Added for BOOTPROF @{</span>=
</span></font></div><div><font color=3D"#ff0000"><span style=3D"f=
ont-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; addBootEvent("Zygote:Preloa=
d " + N + " resources in " +</span></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; (SystemClock.uptimeMillis() - startTime) + "ms");</span>=
</span></font></div><div><font color=3D"#ff0000"><span style=3D"f=
ont-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /// @}</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; }</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mResources.finishPrel=
oading();</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; &nbsp; &nbsp; } catch (RuntimeException e) {</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; Log.w(TAG, "Failure preloading resources"=
, e);</span></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp=
; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: r=
gb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><br></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; private static int preloadColorStateLists(TypedAr=
ray ar) {</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; &nbsp; &nbsp; int N =3D ar.length();</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; for (int i=3D0; i&lt;N; i++) {</span></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"=
color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i=
nt id =3D ar.getResourceId(i, 0);</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
if (false) {</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Log.v(T=
AG, "Preloading resource #" + Integer.toHexString(id));</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (id !=3D=
 0) {</span></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (mResources=
.getColorStateList(id, null) =3D=3D null) {</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new IllegalArgumentEx=
ception(</span></span></font></div><div><font color=3D"#ff0000"><=
span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; "Unable to find preloaded color re=
source #0x"</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; + Integer.toHexString(id)</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; + " (" + ar.getString(i) + ")");</span></span></fo=
nt></div><div><font color=3D"#ff0000"><span style=3D"font-size: 1=
3.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-=
span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"col=
or: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; }</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; &nbsp; &nbsp; return N;</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></fon=
t></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13=
.005px; line-height: 20.808px;"><br></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><br></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; private static int preloadDrawables(TypedArray ar=
) {</span></span></font></div><div><font color=3D"#ff0000"><span=20=
style=3D"font-size: 13.005px; line-height: 20.808px;"><span data-=
wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=20=
&nbsp; &nbsp; &nbsp; int N =3D ar.length();</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; for=20=
(int i=3D0; i&lt;N; i++) {</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int id=20=
=3D ar.getResourceId(i, 0);</span></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (fa=
lse) {</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Log.v(TAG, "P=
reloading resource #" + Integer.toHexString(id));</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; }</span></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0=
, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (id !=3D 0) {=
</span></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz=
-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (mResources.getD=
rawable(id, null) =3D=3D null) {</span></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"=
color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; throw new IllegalArgumentException(</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; "Unable to find preloaded drawable resource #0x=
"</span></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wi=
z-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; + Integer.toHexString(id)</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; + " (" + ar.getString(i) + ")");</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; }</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp; &nbsp; return N;</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><br></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; /**</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* Runs several special GCs to=
 try to clean up a few generations of</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* softly- and fina=
l-reachable objects, along with any other garbage.</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* Thi=
s is only useful just before a fork().</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;*/</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; /*package*/=
 static void gcAndFinalize() {</span></span></font></div><div><fo=
nt color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-hei=
ght: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"co=
lor: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; final VMRuntime r=
untime =3D VMRuntime.getRuntime();</span></span></font></div><div=
><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line=
-height: 20.808px;"><br></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0=
, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /* runFinalizationSync() lets=20=
finalizers be called in Zygote,</span></span></font></div><div><f=
ont color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-he=
ight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"c=
olor: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* which do=
esn't have a HeapWorker thread.</span></span></font></div><div><f=
ont color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-he=
ight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"c=
olor: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; System.gc();</span></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb=
(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; runtime.runFinalizationSy=
nc();</span></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp=
; &nbsp; &nbsp; &nbsp; System.gc();</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><br></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; /**</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* Finish remaining work for t=
he newly forked system server process.</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;*/</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; private sta=
tic void handleSystemServerProcess(</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
ZygoteConnection.Arguments parsedArgs)</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; throws ZygoteInit.MethodAndArgsCaller {</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><br></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; closeServerSocket();=
</span></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><br></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=
 // set umask to 0077 so new files and directories will default t=
o owner-only permissions.</span></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=20=
rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; Os.umask(S_IRWXG | S_I=
RWXO);</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><br></sp=
an></font></div><div><font color=3D"#ff0000"><span style=3D"font-=
size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=20=
&nbsp; if (parsedArgs.niceName !=3D null) {</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; Process.setArgV0(parsedArgs.niceName);</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=
 }</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><br></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbs=
p; final String systemServerClasspath =3D Os.getenv("SYSTEMSERVER=
CLASSPATH");</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; &nbsp; &nbsp; if (systemServerClasspath !=3D null=
) {</span></span></font></div><div><font color=3D"#ff0000"><span=20=
style=3D"font-size: 13.005px; line-height: 20.808px;"><span data-=
wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; performSystemServerDexOpt(syst=
emServerClasspath);</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><br></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; if (parsedArgs.invokeWith !=3D=
 null) {</span></span></font></div><div><font color=3D"#ff0000"><=
span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; String[] args =3D parsedA=
rgs.remainingArgs;</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // If we have a=
 non-null system server class path, we'll have to duplicate the</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; // existing arguments and append th=
e classpath to it. ART will handle the classpath</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; // correctly when we exec a new process.</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; if (systemServerClasspath !=3D null) {</spa=
n></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; String[] amendedArgs =3D=
 new String[args.length + 2];</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"col=
or: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; amendedArgs[0] =3D "-cp";</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; amendedArgs[1] =3D systemServerClasspath;</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.arraycopy(parsedArgs.r=
emainingArgs, 0, amendedArgs, 2, parsedArgs.remainingArgs.length)=
;</span></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wi=
z-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div=
><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line=
-height: 20.808px;"><br></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0=
, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WrapperInit.exec=
Application(parsedArgs.invokeWith,</span></span></font></div><div=
><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line=
-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; parsedArgs.niceName, parsedArgs.targe=
tSdkVersion,</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; VMRuntime.getCurrentInstructionSet(), null, args);</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; } else {</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ClassLoader cl=20=
=3D null;</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (systemServerClasspat=
h !=3D null) {</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cl =3D=
 createSystemServerClassLoader(systemServerClasspath,</span></spa=
n></font></div><div><font color=3D"#ff0000"><span style=3D"font-s=
ize: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp;parsedArgs.targetSdkVersion);</span>=
</span></font></div><div><font color=3D"#ff0000"><span style=3D"f=
ont-size: 13.005px; line-height: 20.808px;"><br></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; Thread.currentThread().setContextClassLoade=
r(cl);</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><br></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb=
(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /*</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"=
data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp;* Pass the remaining arguments to Sy=
stemServer.</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</span></span>=
</font></div><div><font color=3D"#ff0000"><span style=3D"font-siz=
e: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-=
wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; RuntimeInit.zygoteInit(parsedArgs.targetSdkVers=
ion, parsedArgs.remainingArgs, cl);</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; }</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><br></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /* should neve=
r reach here */</span></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=20=
0);">&nbsp; &nbsp; }</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><br></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; /**</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; &nbsp;* Creates a PathClassLoader for the system ser=
ver. It also creates</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp;* a shared namespace associated with=
 the classloader to let it access</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* platform-private nat=
ive libraries.</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; &nbsp;*/</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; private static PathClassLoader crea=
teSystemServerClassLoader(String systemServerClasspath,</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp;int targetSdkVersion) {</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; String librarySe=
archPath =3D System.getProperty("java.library.path");</span></spa=
n></font></div><div><font color=3D"#ff0000"><span style=3D"font-s=
ize: 13.005px; line-height: 20.808px;"><br></span></font></div><d=
iv><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; li=
ne-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=
=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; return PathClassLo=
aderFactory.createClassLoader(systemServerClasspath,</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; librarySearchPath,</span></sp=
an></font></div><div><font color=3D"#ff0000"><span style=3D"font-=
size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; null /* libraryPermittedPat=
h */,</span></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ClassLoader=
.getSystemClassLoader(),</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: r=
gb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; targetSdkVersion,</span></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=20=
rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; true /* isNamespaceShared */);</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><br></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; /**</span></span></font></div><div=
><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line=
-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* Performs dex-opt on=20=
the elements of {@code classPath}, if needed. We</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* choos=
e the instruction set of the current runtime.</span></span></font=
></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.=
005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;*/</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; priv=
ate static void performSystemServerDexOpt(String classPath) {</sp=
an></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; final String[] classPathElements =3D classPath.split=
(":");</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp; &nbsp; final InstallerConnection installer =3D n=
ew InstallerConnection();</span></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=20=
rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; installer.waitForConne=
ction();</span></span></font></div><div><font color=3D"#ff0000"><=
span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&n=
bsp; &nbsp; &nbsp; &nbsp; final String instructionSet =3D VMRunti=
me.getRuntime().vmInstructionSet();</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><br></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; String sharedLibraries =3D "";</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; for (String classPathElement : classPathElements) {</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"=
data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // System server is fully AO=
Ted and never profiled</span></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb=
(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; // for profile guided compilation.</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; // TODO: Make this configurable between INTERPR=
ET_ONLY, SPEED, SPACE and EVERYTHING?</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; final int dexoptNeeded =3D DexFile.getDexOptNee=
ded(</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; classPathElement, instructionSet, "speed",</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; f=
alse /* newProfile */);</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; if (dexoptNeeded !=3D DexFile.NO_DEXOPT_NEEDED) {</span></spa=
n></font></div><div><font color=3D"#ff0000"><span style=3D"font-s=
ize: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; installer.dexopt(=
classPathElement, Process.SYSTEM_UID, instructionSet,</span></spa=
n></font></div><div><font color=3D"#ff0000"><span style=3D"font-s=
ize: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; dexoptNeeded, 0 /*dexFlags*/, "speed", null /*volumeUu=
id*/,</span></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; sharedLibraries);</span></span></font=
></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.=
005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; if (!sharedLibraries.isEmpty()) {</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sharedLibraries +=3D ":";</sp=
an></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></=
div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005=
px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; sharedLibraries +=3D classPathElement;</sp=
an></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; } catch (IOExceptio=
n | InstallerException e) {</span></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw=20=
new RuntimeException("Error starting system_server", e);</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"=
data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp=
; &nbsp; } finally {</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; installer.disc=
onnect();</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><br></span></font></div><div><font color=3D"#f=
f0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;=
"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=
 0);">&nbsp; &nbsp; /**</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; &nbsp;* Prepare the arguments and fork=
 for the system server process.</span></span></font></div><div><f=
ont color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-he=
ight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"c=
olor: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;*/</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; private static boo=
lean startSystemServer(String abiList, String socketName)</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; throws MethodAndArgsCaller, RuntimeExcept=
ion {</span></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp=
; &nbsp; &nbsp; &nbsp; long capabilities =3D posixCapabilitiesAsB=
its(</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OsConstants.CAP_IPC_LOCK,</sp=
an></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; OsConstants.CAP_KILL,</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; OsConstants.CAP_NET_ADMIN,</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; OsConstants.CAP_NET_BIND_SERVICE,</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; OsConstants.CAP_NET_BROADCAST,</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; OsConstants.CAP_NET_RAW,</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"col=
or: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OsCo=
nstants.CAP_SYS_MODULE,</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OsConstant=
s.CAP_SYS_NICE,</span></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=20=
0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OsConstants.CAP_SY=
S_RESOURCE,</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OsConstants.CAP_SYS_TI=
ME,</span></span></font></div><div><font color=3D"#ff0000"><span=20=
style=3D"font-size: 13.005px; line-height: 20.808px;"><span data-=
wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OsConstants.CAP_SYS_TTY_CONFIG=
</span></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz=
-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nb=
sp; &nbsp; &nbsp; );</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /* Containers run without th=
is capability, so avoid setting it in that case */</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbs=
p; if (!SystemProperties.getBoolean(PROPERTY_RUNNING_IN_CONTAINER=
, false)) {</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; capabilities |=3D posi=
xCapabilitiesAsBits(OsConstants.CAP_BLOCK_SUSPEND);</span></span>=
</font></div><div><font color=3D"#ff0000"><span style=3D"font-siz=
e: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-=
wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nb=
sp; }</span></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp=
; &nbsp; &nbsp; &nbsp; /* Hardcoded command line to start the sys=
tem server */</span></span></font></div><div><font color=3D"#ff00=
00"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><=
span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0)=
;">&nbsp; &nbsp; &nbsp; &nbsp; String args[] =3D {</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; "--setuid=3D1000",</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
"--setgid=3D1000",</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /// M: ANR mech=
anism for system_server add shell(2000) group to access</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; /// &nbsp; &nbsp;/sys/kernel/debug/tracing/=
tracing_on</span></span></font></div><div><font color=3D"#ff0000"=
><span style=3D"font-size: 13.005px; line-height: 20.808px;"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "--setgroups=3D1001,100=
2,1003,1004,1005,1006,1007,1008,1009,1010,1018,1021,1032,2000," +=
</span></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz=
-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "3001,3002,3003,300=
6,3007,3009,3010",</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "--capabilities=
=3D" + capabilities + "," + capabilities,</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; "--nice-name=3Dsystem_server",</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; "--runtime-args",</span></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb=
(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "com.androi=
d.server.SystemServer",</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; };</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; Zygo=
teConnection.Arguments parsedArgs =3D null;</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><br></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; int pid;</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><br></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; try {</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"=
data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; parsedArgs =3D new ZygoteConnection.Argume=
nts(args);</span></span></font></div><div><font color=3D"#ff0000"=
><span style=3D"font-size: 13.005px; line-height: 20.808px;"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ZygoteConnection.applyD=
ebuggerSystemProperty(parsedArgs);</span></span></font></div><div=
><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line=
-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
ZygoteConnection.applyInvokeWithSystemProperty(parsedArgs);</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><br></span></font></=
div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005=
px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; /* Request to fork the system server process */</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"=
data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; pid =3D Zygote.forkSystemServer(</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parsedArgs.uid,=
 parsedArgs.gid,</span></span></font></div><div><font color=3D"#f=
f0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;=
"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=
 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; parsedArgs.gids,</span></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; parsedArgs.debugFlags,</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; null,</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parsedArgs.permittedCapabi=
lities,</span></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
; parsedArgs.effectiveCapabilities);</span></span></font></div><d=
iv><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; li=
ne-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=
=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; } catch (Il=
legalArgumentException ex) {</span></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw=
 new RuntimeException(ex);</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font=
></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.=
005px; line-height: 20.808px;"><br></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /* For child proces=
s */</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; &nbsp; &nbsp; if (pid =3D=3D 0) {</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; if (hasSecondZygote(abiList)) {</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; waitForSecondaryZygote(socketName);</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><br></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; handleSystemServerProcess(p=
arsedArgs);</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><fo=
nt color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-hei=
ght: 20.808px;"><br></span></font></div><div><font color=3D"#ff00=
00"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><=
span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0)=
;">&nbsp; &nbsp; &nbsp; &nbsp; return true;</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><br></span></font></div><div><f=
ont color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-he=
ight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"c=
olor: rgb(0, 0, 0);">&nbsp; &nbsp; /**</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* Gets the bit ar=
ray representation of the provided list of POSIX capabilities.</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp;*/</span></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nb=
sp; &nbsp; private static long posixCapabilitiesAsBits(int... cap=
abilities) {</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; &nbsp; &nbsp; long result =3D 0;</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=
 for (int capability : capabilities) {</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; if ((capability &lt; 0) || (capability &gt; OsConstants.CAP_=
LAST_CAP)) {</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw n=
ew IllegalArgumentException(String.valueOf(capability));</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"=
data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: r=
gb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result |=3D=
 (1L &lt;&lt; capability);</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font=
></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.=
005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; re=
turn result;</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; }</span></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><br></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz=
-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nb=
sp; public static void main(String argv[]) {</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; ///=
 M: GMO Zygote64 on demand @{</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"col=
or: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; DEBUG_ZYGOTE_ON_DE=
MAND =3D</span></span></font></div><div><font color=3D"#ff0000"><=
span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SystemProperties.get(PROP=
_ZYGOTE_ON_DEMAND_DEBUG).equals("1");</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; if (DEBUG_=
ZYGOTE_ON_DEMAND) {</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Log.d(TAG, "Zy=
goteOnDemand: Zygote ready =3D " + sZygoteReady);</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; }</span></span></font></div><div><font color=3D"#ff0000"><span=20=
style=3D"font-size: 13.005px; line-height: 20.808px;"><span data-=
wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=20=
&nbsp; &nbsp; &nbsp; String socketName =3D "zygote";</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; /// M: GMO Zygote64 on demand @}</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><br></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; // Mark zygote start. This e=
nsures that thread creation will throw</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; // an err=
or.</span></span></font></div><div><font color=3D"#ff0000"><span=20=
style=3D"font-size: 13.005px; line-height: 20.808px;"><span data-=
wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=20=
&nbsp; &nbsp; &nbsp; ZygoteHooks.startZygoteNoThreadCreation();</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><br></span></fon=
t></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13=
.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; t=
ry {</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Trace.traceBegin(Trace.TRACE_=
TAG_DALVIK, "ZygoteInit");</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Runtime=
Init.enableDdms();</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /// M: Added fo=
r BOOTPROF</span></span></font></div><div><font color=3D"#ff0000"=
><span style=3D"font-size: 13.005px; line-height: 20.808px;"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //MTPROF_DISABLE =3D "1=
".equals(SystemProperties.get("ro.mtprof.disable"));</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; // Start profiling the zygote initialization.<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; SamplingProfilerIntegration.start(=
);</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><br></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; boolean startSystemServer =3D false;</span></spa=
n></font></div><div><font color=3D"#ff0000"><span style=3D"font-s=
ize: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; String abiList =3D null;</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; for (int i =3D 1; i &lt; argv.length; i++) {</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ("start-system-server".equ=
als(argv[i])) {</span></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=20=
0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; startSystemServer =3D true;</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; } else if (argv[i].startsWith(ABI_LIST_ARG)) {<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; abiLis=
t =3D argv[i].substring(ABI_LIST_ARG.length());</span></span></fo=
nt></div><div><font color=3D"#ff0000"><span style=3D"font-size: 1=
3.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-=
span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; } else if (argv[i].startsWith(SOCKET_=
NAME_ARG)) {</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; socketName =3D argv[i].substring(SOCKET_NAME_ARG.length())=
;</span></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wi=
z-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Runti=
meException("Unknown command line argument: " + argv[i]);</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; }</span></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><br></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; if (abiList =3D=3D null) {</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; throw new RuntimeException("No ABI l=
ist supplied.");</span></span></font></div><div><font color=3D"#f=
f0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;=
"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=
 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><br></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"=
color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; r=
egisterZygoteSocket(socketName);</span></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"=
color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; T=
race.traceBegin(Trace.TRACE_TAG_DALVIK, "ZygotePreload");</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; EventLog.writeEvent(LOG_BOOT_PROGRESS_PRE=
LOAD_START,</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SystemCl=
ock.uptimeMillis());</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /// M: Added f=
or BOOTPROF</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; addBootEvent("Zygote:P=
reload Start");</span></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><br></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; /// M: GMO Zygote64 on demand @{</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; /// M: Added for Zygote preload contro=
l @{</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; preloadByName(socketName);</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; /// @}</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
/// M: GMO Zygote64 on demand @}</span></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><br></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=20=
0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EventLog.writeEven=
t(LOG_BOOT_PROGRESS_PRELOAD_END,</span></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"=
color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; SystemClock.uptimeMillis());</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; Trace.traceEnd(Trace.TRACE_TAG_DALVIK);</span></span></fo=
nt></div><div><font color=3D"#ff0000"><span style=3D"font-size: 1=
3.005px; line-height: 20.808px;"><br></span></font></div><div><fo=
nt color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-hei=
ght: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"co=
lor: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //=20=
Finish profiling the zygote initialization.</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; SamplingProfilerIntegration.writeZygoteSnapshot();</spa=
n></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><br></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; // Do an initial gc to clean up after startup</span></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; Trace.traceBegin(Trace.TRACE_TAG_DALVIK, "P=
ostZygoteInitGC");</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gcAndFinalize()=
;</span></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wi=
z-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; Trace.traceEnd(Trace.TRACE_TAG_D=
ALVIK);</span></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><br></s=
pan></font></div><div><font color=3D"#ff0000"><span style=3D"font=
-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; Trace.traceEnd(Trace.TRACE_TAG_DALVIK);</sp=
an></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><br></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; // Disable tracing so that forked processes do not inhe=
rit stale tracing tags from</span></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Zyg=
ote.</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Trace.setTracingEnabled(false=
);</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><br></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; // Zygote process unmounts root storage spaces.<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; Zygote.nativeUnmountStorageOnInit(=
);</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><br></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; /// M: Added for BOOTPROF</span></span></font></=
div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005=
px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; addBootEvent("Zygote:Preload End");</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><br></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Zygote=
Hooks.stopZygoteNoThreadCreation();</span></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><br></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /// N: Move MPl=
ugin init after preloading due to "Zygote: No Thread Creation Iss=
ues". @{</span></span></font></div><div><font color=3D"#ff0000"><=
span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; boolean preloadMPlugin =3D=
 false;</span></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!sZygoteOnDemandEnable=
d) {</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; preloadMPlugin=20=
=3D true;</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wi=
z-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; if ("zygote".equals(socketName)) {<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; preloa=
dMPlugin =3D true;</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }=
</span></span></font></div><div><font color=3D"#ff0000"><span sty=
le=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz=
-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
if (preloadMPlugin) {</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
Log.i(TAG1, "preloadMappingTable() -- start ");</span></span></fo=
nt></div><div><font color=3D"#ff0000"><span style=3D"font-size: 1=
3.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-=
span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; PluginLoader.preloadPluginInfo();</sp=
an></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Log.i(TAG1, "preloadMapp=
ingTable() -- end ");</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; /// @}</span></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><br></span></font></div><div><font color=3D"#ff0000"><=
span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (startSystemServer) {<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; startSystemServer(ab=
iList, socketName);</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><br></span></font></div><di=
v><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; lin=
e-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
/// M: GMO Zygote64 on demand @{</span></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"=
color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; s=
ZygoteReady =3D true;</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (DEBUG_ZYGO=
TE_ON_DEMAND) {</span></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=20=
0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Log.=
d(TAG, "ZygoteOnDemand: Zygote ready =3D " + sZygoteReady +</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ", socket nam=
e: " + socketName);</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; /// M: GMO Zygote64 on demand @}</span></span>=
</font></div><div><font color=3D"#ff0000"><span style=3D"font-siz=
e: 13.005px; line-height: 20.808px;"><br></span></font></div><div=
><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line=
-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
Log.i(TAG, "Accepting command socket connections");</span></span>=
</font></div><div><font color=3D"#ff0000"><span style=3D"font-siz=
e: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-=
wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; runSelectLoop(abiList);</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><br></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: r=
gb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /// M: GM=
O Zygote64 on demand @{</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; zygoteStop=
ping("ZygoteOnDemand: End of runSelectLoop", socketName);</span><=
/span></font></div><div><font color=3D"#ff0000"><span style=3D"fo=
nt-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; /// M: GMO Zygote64 on demand @}</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><br></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; closeServerSocket();</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; } catch (MethodAndArg=
sCaller caller) {</span></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0=
, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; caller.run();</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; } catch (RuntimeException ex) {</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; Log.e(TAG, "Zygote died with exception", ex);</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"=
data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; closeServerSocket();</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; throw ex;</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><br></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /// M: GMO Zygote64 on deman=
d @{</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; &nbsp; &nbsp; zygoteStopping("ZygoteOnDemand: End of main=
 function", socketName);</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: r=
gb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /// M: GMO Zygote64 on=20=
demand @}</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; }</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<br></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; /=
// M: GMO Zygote64 on demand @{</span></span></font></div><div><f=
ont color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-he=
ight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"c=
olor: rgb(0, 0, 0);">&nbsp; &nbsp; private static void zygoteStop=
ping(String reason, String socketName) {</span></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; sZygote=
Ready =3D false;</span></span></font></div><div><font color=3D"#f=
f0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;=
"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=
 0);">&nbsp; &nbsp; &nbsp; &nbsp; if (DEBUG_ZYGOTE_ON_DEMAND) {</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; Log.d(TAG, "ZygoteOnDemand: zygoteS=
topping for " + socketName + ", reason: " + reason);</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; }</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp; &nbsp; if (sZygoteOnDemandEnabled &amp;&amp; soc=
ketName.equals("zygote_secondary")</span></span></font></div><div=
><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line=
-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&amp;&amp; Process.isSecondaryZygoteRunning()) {</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; Log.d(TAG, "ZygoteOnDemand: stop secondary Zygote=20=
for " + socketName +</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
", reason: " + reason);</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Process.st=
opSecondaryZygote();</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; /// M: GMO Zygote6=
4 on demand @}</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<br></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; /=
**</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp;* Return {@code true} if this device configuration ha=
s another zygote.</span></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0=
, 0);">&nbsp; &nbsp; &nbsp;*</span></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* We determine this by comp=
aring the device ABI list with this zygotes</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* list. If t=
his zygote supports all ABIs this device supports, there won't</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp;* be another zygote.</span></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=20=
rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;*/</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; private static boolean h=
asSecondZygote(String abiList) {</span></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"=
color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; return !SystemP=
roperties.get("ro.product.cpu.abilist").equals(abiList);</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"=
data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; }</sp=
an></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><br></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; private static voi=
d waitForSecondaryZygote(String socketName) {</span></span></font=
></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.=
005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; St=
ring otherZygoteName =3D Process.ZYGOTE_SOCKET.equals(socketName)=
 ?</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Process.SECONDARY=
_ZYGOTE_SOCKET : Process.ZYGOTE_SOCKET;</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /// M: G=
MO Zygote64 on demand @{</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: r=
gb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; if (sZygoteOnDemandEnab=
led) {</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (DEBUG_ZYGOTE_ON_DEMAND)=
 {</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Log.d(TAG, "Zygot=
eOnDemand: skip waitForSecondaryZygote: " +</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; socketName + " wait " + oth=
erZygoteName);</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span></fo=
nt></div><div><font color=3D"#ff0000"><span style=3D"font-size: 1=
3.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-=
span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; return;</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /// M: GM=
O Zygote64 on demand @}</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><br></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp; &nbsp; while (true) {</span></span></font></div>=
<div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=20=
line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; try {</span></span></font></div><div><font color=3D"#ff0000"=
><span style=3D"font-size: 13.005px; line-height: 20.808px;"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; final Pro=
cess.ZygoteState zs =3D Process.ZygoteState.connect(otherZygoteNa=
me);</span></span></font></div><div><font color=3D"#ff0000"><span=
 style=3D"font-size: 13.005px; line-height: 20.808px;"><span data=
-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; zs.close();</sp=
an></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</span></span></fo=
nt></div><div><font color=3D"#ff0000"><span style=3D"font-size: 1=
3.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-=
span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; } catch (IOException ioe) {</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; Log.w(TAG, "Got error connecting to zygote,=
 retrying. msg=3D " + ioe.getMessage());</span></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; }</span></span></font></div><div><font color=3D"#ff0000"><=
span style=3D"font-size: 13.005px; line-height: 20.808px;"><br></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"=
data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; try {</span></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; Thread.sleep(1000);</span></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } cat=
ch (InterruptedException ie) {</span></span></font></div><div><fo=
nt color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-hei=
ght: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"co=
lor: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp=
; &nbsp; &nbsp; }</span></span></font></div><div><font color=3D"#=
ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808px=
;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0=
, 0);">&nbsp; &nbsp; }</span></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><br></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp=
; &nbsp; /**</span></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; &nbsp;* Runs the zygote process's select loop. Ac=
cepts new connections as</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: r=
gb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* they happen, and reads comman=
ds from connections one spawn-request's</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* worth at a tim=
e.</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp;*</span></span></font></div><div><font color=3D"#ff00=
00"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><=
span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0)=
;">&nbsp; &nbsp; &nbsp;* @throws MethodAndArgsCaller in a child p=
rocess when a main() should</span></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* be executed.</span></span>=
</font></div><div><font color=3D"#ff0000"><span style=3D"font-siz=
e: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-=
wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;*/</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp=
; private static void runSelectLoop(String abiList) throws Method=
AndArgsCaller {</span></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=20=
0);">&nbsp; &nbsp; &nbsp; &nbsp; ArrayList&lt;FileDescriptor&gt;=20=
fds =3D new ArrayList&lt;FileDescriptor&gt;();</span></span></fon=
t></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13=
.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; A=
rrayList&lt;ZygoteConnection&gt; peers =3D new ArrayList&lt;Zygot=
eConnection&gt;();</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><br></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wi=
z-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &n=
bsp; &nbsp; &nbsp; fds.add(sServerSocket.getFileDescriptor());</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; peers.add(null);</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><br></span></font></div><div><font color=3D"#ff000=
0"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);=
">&nbsp; &nbsp; &nbsp; &nbsp; while (true) {</span></span></font>=
</div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.0=
05px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; StructPollfd[] pollFds =3D new StructPollfd[fds.size()=
];</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (int i =3D 0; i &lt; pollFd=
s.length; ++i) {</span></span></font></div><div><font color=3D"#f=
f0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;=
"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=
 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pol=
lFds[i] =3D new StructPollfd();</span></span></font></div><div><f=
ont color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-he=
ight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"c=
olor: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; pollFds[i].fd =3D fds.get(i);</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; pollFds[i].events =3D (short) POLLIN;</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font co=
lor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=20=
20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=20=
rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Os.poll(pollFds, -1);</s=
pan></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; } catch (ErrnoException ex) {</span></=
span></font></div><div><font color=3D"#ff0000"><span style=3D"fon=
t-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"=
data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new RuntimeException("=
poll failed", ex);</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span>=
</font></div><div><font color=3D"#ff0000"><span style=3D"font-siz=
e: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-=
wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; for (int i =3D pollFds.length - 1; i &gt;=3D 0;=
 --i) {</span></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ((pollFds=
[i].revents &amp; POLLIN) =3D=3D 0) {</span></span></font></div><=
div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; l=
ine-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; continue;</span></span></font></d=
iv><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005p=
x; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font colo=
r=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20=
.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rg=
b(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; if (i =3D=3D 0) {</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; ZygoteConnection newPeer =3D acceptCommandPeer(abiL=
ist);</span></span></font></div><div><font color=3D"#ff0000"><spa=
n style=3D"font-size: 13.005px; line-height: 20.808px;"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
peers.add(newPeer);</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; fds.add(newPeer.getFileDesciptor());</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; } else {</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; boolean done =3D peers.get(i).r=
unOnce();</span></span></font></div><div><font color=3D"#ff0000">=
<span style=3D"font-size: 13.005px; line-height: 20.808px;"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; if (done) {</span></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=20=
0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; peers.remove(i);</span></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fds.remove(i);</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span=
></span></font></div><div><font color=3D"#ff0000"><span style=3D"=
font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div=
><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px;=
 line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; }</span></span></font></div><div><font color=3D"#ff0000"><s=
pan style=3D"font-size: 13.005px; line-height: 20.808px;"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nb=
sp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><font c=
olor=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height:=
 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color:=
 rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font></div><div><f=
ont color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-he=
ight: 20.808px;"><br></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; /**</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp;* Class not instantiable.</span></sp=
an></font></div><div><font color=3D"#ff0000"><span style=3D"font-=
size: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;*=
/</span></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wi=
z-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &n=
bsp; private ZygoteInit() {</span></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; }</span></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><br></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=20=
0);">&nbsp; &nbsp; /**</span></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb=
(0, 0, 0);">&nbsp; &nbsp; &nbsp;* Helper exception class which ho=
lds a method and arguments and</span></span></font></div><div><fo=
nt color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-hei=
ght: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"co=
lor: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* can call them. This is=20=
used as part of a trampoline to get rid of</span></span></font></=
div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005=
px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;* the initial=
 process setup stack frames.</span></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp;*/</span></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; public static class M=
ethodAndArgsCaller extends Exception</span></span></font></div><d=
iv><font color=3D"#ff0000"><span style=3D"font-size: 13.005px; li=
ne-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=
=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; implements Runnable {</span></span></font></div><div><font col=
or=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 2=
0.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: r=
gb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /** method to call */</=
span></span></font></div><div><font color=3D"#ff0000"><span style=
=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp=
; &nbsp; &nbsp; private final Method mMethod;</span></span></font=
></div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.=
005px; line-height: 20.808px;"><br></span></font></div><div><font=
 color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heigh=
t: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"colo=
r: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; /** argument array=20=
*/</span></span></font></div><div><font color=3D"#ff0000"><span s=
tyle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-w=
iz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp; &nbsp; private final String[] mArgs;</span></span></=
font></div><div><font color=3D"#ff0000"><span style=3D"font-size:=
 13.005px; line-height: 20.808px;"><br></span></font></div><div><=
font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-h=
eight: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"=
color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; public MethodAn=
dArgsCaller(Method method, String[] args) {</span></span></font><=
/div><div><font color=3D"#ff0000"><span style=3D"font-size: 13.00=
5px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span=
" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; mMethod =3D method;</span></span></font></div><div><fon=
t color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-heig=
ht: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"col=
or: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mArg=
s =3D args;</span></span></font></div><div><font color=3D"#ff0000=
"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);"=
>&nbsp; &nbsp; &nbsp; &nbsp; }</span></span></font></div><div><fo=
nt color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-hei=
ght: 20.808px;"><br></span></font></div><div><font color=3D"#ff00=
00"><span style=3D"font-size: 13.005px; line-height: 20.808px;"><=
span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0)=
;">&nbsp; &nbsp; &nbsp; &nbsp; public void run() {</span></span><=
/font></div><div><font color=3D"#ff0000"><span style=3D"font-size=
: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-w=
iz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; try {</span></span></font></div><div><font color=
=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.=
808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb=
(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; mMethod.invoke(null, new Object[] { mArgs });</span></span></f=
ont></div><div><font color=3D"#ff0000"><span style=3D"font-size:=20=
13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz=
-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; } catch (IllegalAccessException ex) {</span></span=
></font></div><div><font color=3D"#ff0000"><span style=3D"font-si=
ze: 13.005px; line-height: 20.808px;"><span data-wiz-span=3D"data=
-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new RuntimeException(ex);<=
/span></span></font></div><div><font color=3D"#ff0000"><span styl=
e=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-=
span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; } catch (InvocationTargetException=
 ex) {</span></span></font></div><div><font color=3D"#ff0000"><sp=
an style=3D"font-size: 13.005px; line-height: 20.808px;"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Throwable cau=
se =3D ex.getCause();</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
if (cause instanceof RuntimeException) {</span></span></font></di=
v><div><font color=3D"#ff0000"><span style=3D"font-size: 13.005px=
; line-height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw (RuntimeException) cause=
;</span></span></font></div><div><font color=3D"#ff0000"><span st=
yle=3D"font-size: 13.005px; line-height: 20.808px;"><span data-wi=
z-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else if (cause i=
nstanceof Error) {</span></span></font></div><div><font color=3D"=
#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808p=
x;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=20=
0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; throw (Error) cause;</span></span></font></div><div>=
<font color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-=
height: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D=
"color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; }</span></span></font></div><div><font color=3D"#ff=
0000"><span style=3D"font-size: 13.005px; line-height: 20.808px;"=
><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0,=20=
0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thro=
w new RuntimeException(ex);</span></span></font></div><div><font=20=
color=3D"#ff0000"><span style=3D"font-size: 13.005px; line-height=
: 20.808px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color=
: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</spa=
n></span></font></div><div><font color=3D"#ff0000"><span style=3D=
"font-size: 13.005px; line-height: 20.808px;"><span data-wiz-span=
=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0);">&nbsp; &nbsp; &=
nbsp; &nbsp; }</span></span></font></div><div><font color=3D"#ff0=
000"><span style=3D"font-size: 13.005px; line-height: 20.808px;">=
<span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0, 0, 0=
);">&nbsp; &nbsp; }</span></span></font></div><div><font color=3D=
"#ff0000"><span style=3D"font-size: 13.005px; line-height: 20.808=
px;"><span data-wiz-span=3D"data-wiz-span" style=3D"color: rgb(0,=
 0, 0);">}</span></span></font></div></span></div></body></html>

------=_Next_Part_0138528078.115--

------=_Next_Part_0415584234.833--

