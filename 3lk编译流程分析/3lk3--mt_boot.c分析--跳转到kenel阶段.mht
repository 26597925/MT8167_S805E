From: WizMime<support@wiz.cn>
Subject: =?gb2312?B?M2xrMy0tbXRfYm9vdC5jt9bO9i0tzPjXqrW9a2VuZWy917bO?=
Date: Date: Mon, 23 Oct 2017 08:43:15 +0800
MIME-Version: 1.0
Content-Type: multipart/related;
	type="multipart/alternative";
	boundary="----=_Next_Part_0415426968.942"

This is a multi-part message in MIME format.

------=_Next_Part_0415426968.942
Content-Type: multipart/alternative;
	boundary="----=_Next_Part_0138475656.264"


------=_Next_Part_0138475656.264
Content-Type: text/plain;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

This is a multi-part message in MIME format.

------=_Next_Part_0138475656.264
Content-Type: text/html;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML><html><head>=0D=0A<meta http-equiv=3D"Content-Type=
" content=3D"text/html; charset=3Dgb2312">=0A=0A<title>3lk3--mt_b=
oot.c=B7=D6=CE=F6--=CC=F8=D7=AA=B5=BDkenel=BD=D7=B6=CE</title>=0A=
    <!--mark |wiz_custom_css| for wizeditor replace it-->=0A<styl=
e id=3D"wiz_custom_css">html, body {            font-size: 15px;=20=
       }        body {            font-family: Helvetica, 'Hiragi=
no Sans GB', '=CE=A2=C8=ED=D1=C5=BA=DA', 'Microsoft YaHei UI', Si=
mSun, SimHei, arial, sans-serif;            line-height: 1.6;   =20=
        margin: 0;            padding: 20px 15px;            padd=
ing: 1.33rem 1rem;        }        h1, h2, h3, h4, h5, h6 {     =20=
      margin: 20px 0 10px;            margin: 1.33rem 0 0.667rem;=
            padding: 0;            font-weight: bold;        }  =20=
     h1 {            font-size: 21px;            font-size: 1.4re=
m;        }        h2 {            font-size: 20px;            fo=
nt-size: 1.33rem;        }        h3 {            font-size: 18px=
;            font-size: 1.2rem;        }        h4 {            f=
ont-size: 17px;            font-size: 1.13rem;        }        h5=
 {            font-size: 15px;            font-size: 1rem;      =20=
 }        h6 {            font-size: 15px;            font-size:=20=
1rem;            color: #777777;            margin: 1rem 0;     =20=
  }        div, p, ul, ol, dl, li {            margin: 0;       =20=
}        blockquote, table, pre, code {            margin: 8px 0;=
        }        ul, ol {            padding-left: 32px;        =20=
   padding-left: 2.13rem;        }        blockquote {          =20=
 padding: 0 12px;            padding: 0 0.8rem;        }        b=
lockquote > :first-child {            margin-top: 0;        }   =20=
    blockquote > :last-child {            margin-bottom: 0;     =20=
  }        img {            border: 0;            max-width: 100%=
;            height: auto !important;            margin: 2px 0; =20=
      }        table {            border-collapse: collapse;    =20=
       border: 1px solid #bbbbbb;        }        td, th {      =20=
     padding: 4px 8px;            border-collapse: collapse;    =20=
       border: 1px solid #bbbbbb;			        }        @media only=20=
screen and (-webkit-max-device-width: 1024px), only screen and (-=
o-max-device-width: 1024px), only screen and (max-device-width: 1=
024px), only screen and (-webkit-min-device-pixel-ratio: 3), only=
 screen and (-o-min-device-pixel-ratio: 3), only screen and (min-=
device-pixel-ratio: 3) {            html, body {                f=
ont-size: 17px;            }            body {                lin=
e-height: 1.7;                padding: 0.75rem 0.9375rem;       =20=
        color: #353c47;            }            h1 {            =20=
   font-size: 2.125rem;            }            h2 {            =20=
   font-size: 1.875rem;            }            h3 {            =20=
   font-size: 1.625rem;            }            h4 {            =20=
   font-size: 1.375rem;            }            h5 {            =20=
   font-size: 1.125rem;            }            h6 {            =20=
   color: inherit;            }            ul, ol {             =20=
  padding-left: 2.5rem;            }            blockquote {    =20=
           padding: 0 0.9375rem;            }        }</style></h=
ead>=0A=0A<body spellcheck=3D"false" ><div><span data-wiz-span=3D=
"data-wiz-span" style=3D"color: rgb(255, 0, 0); font-size: 0.867r=
em;"><b>vendor/mediatek/proprietary/bootable/bootloader/lk/app/mt=
_boot/mt_boot.c</b></span><br></div><div><span data-wiz-span=3D"d=
ata-wiz-span"><div><span data-wiz-span=3D"data-wiz-span"><font co=
lor=3D"#ff0000"></font></span></div><div><div><span data-wiz-span=
=3D"data-wiz-span"><font color=3D"#ff0000"></font></span></div><d=
iv><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">/* Copyr=
ight Statement:</span></font></div><div><font color=3D"#ff0000"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">*</span></font></div><div><font color=3D"=
#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">* This software/firmware and re=
lated documentation ("MediaTek Software") are</span></font></div>=
<div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">* protected=
 under relevant copyright laws. The information contained herein<=
/span></font></div><div><font color=3D"#ff0000"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">* is confidential and proprietary to MediaTek Inc. and/or=
 its licensors.</span></font></div><div><font color=3D"#ff0000"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">* Without the prior written permission of=
 MediaTek inc. and/or its licensors,</span></font></div><div><fon=
t color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">* any reproduction, m=
odification, use or disclosure of MediaTek Software,</span></font=
></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">* an=
d information contained herein, in whole or in part, shall be str=
ictly prohibited.</span></font></div><div><font color=3D"#ff0000"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">*/</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">/* MediaTek Inc. (C) 2015. All=
 rights reserved.</span></font></div><div><font color=3D"#ff0000"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">*</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">* BY OPENING THIS FILE, RECEIV=
ER HEREBY UNEQUIVOCALLY ACKNOWLEDGES AND AGREES</span></font></di=
v><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">* THAT TH=
E SOFTWARE/FIRMWARE AND ITS DOCUMENTATIONS ("MEDIATEK SOFTWARE")<=
/span></font></div><div><font color=3D"#ff0000"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">* RECEIVED FROM MEDIATEK AND/OR ITS REPRESENTATIVES ARE P=
ROVIDED TO RECEIVER ON</span></font></div><div><font color=3D"#ff=
0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">* AN "AS-IS" BASIS ONLY. MEDIATEK=20=
EXPRESSLY DISCLAIMS ANY AND ALL WARRANTIES,</span></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">* EXPRESS OR=20=
IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF</=
span></font></div><div><font color=3D"#ff0000"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR NON=
INFRINGEMENT.</span></font></div><div><font color=3D"#ff0000"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">* NEITHER DOES MEDIATEK PROVIDE ANY WARRANT=
Y WHATSOEVER WITH RESPECT TO THE</span></font></div><div><font co=
lor=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">* SOFTWARE OF ANY THIRD=20=
PARTY WHICH MAY BE USED BY, INCORPORATED IN, OR</span></font></di=
v><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">* SUPPLIE=
D WITH THE MEDIATEK SOFTWARE, AND RECEIVER AGREES TO LOOK ONLY TO=
 SUCH</span></font></div><div><font color=3D"#ff0000"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">* THIRD PARTY FOR ANY WARRANTY CLAIM RELATING THERE=
TO. RECEIVER EXPRESSLY ACKNOWLEDGES</span></font></div><div><font=
 color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">* THAT IT IS RECEIVER=
'S SOLE RESPONSIBILITY TO OBTAIN FROM ANY THIRD PARTY ALL PROPER=20=
LICENSES</span></font></div><div><font color=3D"#ff0000"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">* CONTAINED IN MEDIATEK SOFTWARE. MEDIATEK SHALL=
 ALSO NOT BE RESPONSIBLE FOR ANY MEDIATEK</span></font></div><div=
><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">* SOFTWARE RELE=
ASES MADE TO RECEIVER'S SPECIFICATION OR TO CONFORM TO A PARTICUL=
AR</span></font></div><div><font color=3D"#ff0000"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">* STANDARD OR OPEN FORUM. RECEIVER'S SOLE AND EXCLUSIV=
E REMEDY AND MEDIATEK'S ENTIRE AND</span></font></div><div><font=20=
color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">* CUMULATIVE LIABILITY=
 WITH RESPECT TO THE MEDIATEK SOFTWARE RELEASED HEREUNDER WILL BE=
,</span></font></div><div><font color=3D"#ff0000"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">* AT MEDIATEK'S OPTION, TO REVISE OR REPLACE THE MEDIAT=
EK SOFTWARE AT ISSUE,</span></font></div><div><font color=3D"#ff0=
000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">* OR REFUND ANY SOFTWARE LICENSE FE=
ES OR SERVICE CHARGE PAID BY RECEIVER TO</span></font></div><div>=
<font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">* MEDIATEK FOR S=
UCH MEDIATEK SOFTWARE AT ISSUE.</span></font></div><div><font col=
or=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">*/</span></font></div><di=
v><font color=3D"#ff0000"><br></font></div><div><font color=3D"#f=
f0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">#include &lt;atags.h&gt;</span></=
font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
#include &lt;app.h&gt;</span></font></div><div><font color=3D"#ff=
0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">#include &lt;debug.h&gt;</span></f=
ont></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#=
include &lt;arch.h&gt;</span></font></div><div><font color=3D"#ff=
0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">#include &lt;arch/arm.h&gt;</span>=
</font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">#include &lt;arch/arm/mmu.h&gt;</span></font></div><div><font c=
olor=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">#include &lt;dev/udc.h&=
gt;</span></font></div><div><font color=3D"#ff0000"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">#include &lt;reg.h&gt;</span></font></div><div><font=20=
color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">#include &lt;string.h&=
gt;</span></font></div><div><font color=3D"#ff0000"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">#include &lt;stdlib.h&gt;</span></font></div><div><fo=
nt color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#include &lt;kernel/t=
hread.h&gt;</span></font></div><div><font color=3D"#ff0000"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">#include &lt;arch/ops.h&gt;</span></font></di=
v><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#include=20=
&lt;ctype.h&gt;</span></font></div><div><font color=3D"#ff0000"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">#include &lt;platform/mt_rtc.h&gt;</span>=
</font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">#include &lt;target.h&gt;</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">#include &lt;platform.h&gt;</s=
pan></font></div><div><font color=3D"#ff0000"><br></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#include &lt;=
platform/mt_reg_base.h&gt;</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">#include &lt;platform/boot_mod=
e.h&gt;</span></font></div><div><font color=3D"#ff0000"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">#include &lt;platform/bootimg.h&gt;</span></font>=
</div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifde=
f MTK_GPT_SCHEME_SUPPORT</span></font></div><div><font color=3D"#=
ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">#include &lt;platform/partition.=
h&gt;</span></font></div><div><font color=3D"#ff0000"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">#else</span></font></div><div><font color=3D"#ff000=
0"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">#include &lt;mt_partition.h&gt;</span=
></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">#endif</span></font></div><div><font color=3D"#ff0000"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">#include &lt;platform/mt_disp_drv.h&gt;</span><=
/font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>#include &lt;platform/env.h&gt;</span></font></div><div><font co=
lor=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">#include &lt;target/cust=
_usb.h&gt;</span></font></div><div><font color=3D"#ff0000"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">#include &lt;platform/mt_gpt.h&gt;</span></fon=
t></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#if=
 defined(MTK_SECURITY_SW_SUPPORT) &amp;&amp; defined(MTK_VERIFIED=
_BOOT_SUPPORT)</span></font></div><div><font color=3D"#ff0000"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">#include "oemkey.h"</span></font></div><di=
v><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span><=
/font></div><div><font color=3D"#ff0000"><br></font></div><div><f=
ont color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#define BOOT_STATE=
_GREEN &nbsp; 0x0</span></font></div><div><font color=3D"#ff0000"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">#define BOOT_STATE_ORANGE &nbsp;0x1</sp=
an></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">#define BOOT_STATE_YELLOW &nbsp;0x2</span></font></div><div><f=
ont color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#define BOOT_STATE=
_RED &nbsp; &nbsp; 0x3</span></font></div><div><font color=3D"#ff=
0000"><br></font></div><div><font color=3D"#ff0000"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">#ifdef MBLOCK_LIB_SUPPORT</span></font></div><div><fo=
nt color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#include &lt;mblock.h=
&gt;</span></font></div><div><font color=3D"#ff0000"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">#endif</span></font></div><div><font color=3D"#ff000=
0"><br></font></div><div><font color=3D"#ff0000"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">#ifdef MTK_AB_OTA_UPDATER</span></font></div><div><font=20=
color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">#include "bootctrl.h"<=
/span></font></div><div><font color=3D"#ff0000"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">#endif</span></font></div><div><font color=3D"#ff0000"><b=
r></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">#ifdef MTK_KERNEL_POWER_OFF_CHARGING</span></font></div><div><=
font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#include "platfor=
m/mtk_wdt.h"</span></font></div><div><font color=3D"#ff0000"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">extern int kernel_charging_boot(void);</span=
></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">extern int pmic_detect_powerkey(void);</span></font></div><div=
><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern void mt6=
575_power_off(void);</span></font></div><div><font color=3D"#ff00=
00"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">extern void mt65xx_backlight_off(voi=
d);</span></font></div><div><font color=3D"#ff0000"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">#endif</span></font></div><div><font color=3D"#ff0000=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">extern void jumparch64(u32 addr, u32 a=
rg1, u32 arg2);</span></font></div><div><font color=3D"#ff0000"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">extern void jumparch64_smc(u32 addr, u32=20=
arg1, u32 arg2, u32 arg3);</span></font></div><div><font color=3D=
"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">extern u32 memory_size(void);</span></font></div>=
<div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern unsi=
gned *target_atag_devinfo_data(unsigned *ptr);</span></font></div=
><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern uns=
igned *target_atag_videolfb(unsigned *ptr);</span></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern unsign=
ed *target_atag_mdinfo(unsigned *ptr);</span></font></div><div><f=
ont color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern unsigned *t=
arget_atag_ptp(unsigned *ptr);</span></font></div><div><font colo=
r=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">extern void platform_unini=
t(void);</span></font></div><div><font color=3D"#ff0000"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">extern int mboot_android_load_bootimg_hdr(char *=
part_name, unsigned long addr);</span></font></div><div><font col=
or=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">extern int mboot_android_=
load_bootimg(char *part_name, unsigned long addr);</span></font><=
/div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern=
 int mboot_android_load_recoveryimg_hdr(char *part_name, unsigned=
 long addr);</span></font></div><div><font color=3D"#ff0000"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">extern int mboot_android_load_recoveryimg(ch=
ar *part_name, unsigned long addr);</span></font></div><div><font=
 color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">extern int mboot_andr=
oid_load_factoryimg_hdr(char *part_name, unsigned long addr);</sp=
an></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">extern int mboot_android_load_factoryimg(char *part_name, unsi=
gned long addr);</span></font></div><div><font color=3D"#ff0000">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">extern void custom_port_in_kernel(BOOTMO=
DE boot_mode, char *command);</span></font></div><div><font color=
=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">extern const char* mt_disp_=
get_lcm_id(void);</span></font></div><div><font color=3D"#ff0000"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">extern unsigned int DISP_GetVRamSize(vo=
id);</span></font></div><div><font color=3D"#ff0000"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">extern int mt_disp_is_lcm_connected(void);</span></f=
ont></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">e=
xtern int fastboot_init(void *base, unsigned size);</span></font>=
</div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">exter=
n int sec_boot_check (int try_lock);</span></font></div><div><fon=
t color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">extern int seclib_set=
_oemkey(u8 *key, u32 key_size);</span></font></div><div><font col=
or=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">extern BI_DRAM bi_dram[MA=
X_NR_BANK];</span></font></div><div><font color=3D"#ff0000"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">#ifdef DEVICE_TREE_SUPPORT</span></font></div=
><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#include &=
lt;libfdt.h&gt;</span></font></div><div><font color=3D"#ff0000"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">#ifdef USE_ITS_BOOTIMG</span></font></div=
><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#include &=
lt;platform/dtb.h&gt;</span></font></div><div><font color=3D"#ff0=
000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">#endif</span></font></div><div><fon=
t color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">extern unsigned int *=
device_tree, device_tree_size;</span></font></div><div><font colo=
r=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></div>=
<div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern unsi=
gned int g_boot_state;</span></font></div><div><font color=3D"#ff=
0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">extern int platform_skip_hibernati=
on(void) __attribute__((weak));</span></font></div><div><font col=
or=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">int g_is_64bit_kernel =3D 0;</span></font></=
div><div><font color=3D"#ff0000"><br></font></div><div><font colo=
r=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">boot_img_hdr *g_boot_hdr =3D=
 NULL;</span></font></div><div><font color=3D"#ff0000"><br></font=
></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#def=
ine CMDLINE_LEN &nbsp; 1024</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">static char g_cmdline[CMDLINE_=
LEN] =3D COMMANDLINE_TO_KERNEL;</span></font></div><div><font col=
or=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">char g_boot_reason[][16]=3D=
 {"power_key","usb","rtc","wdt","wdt_by_pass_pwk","tool_by_pass_p=
wk","2sec_reboot","kernel_panic","reboot","watchdog","kernel_rest=
art","aee","recovery","bootloader","thermal","thermal_spm","spm",=
"unknown"};</span></font></div><div><font color=3D"#ff0000"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">#if defined(MTK_SECURITY_SW_SUPPORT) &amp;&am=
p; defined(MTK_VERIFIED_BOOT_SUPPORT)</span></font></div><div><fo=
nt color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">u8 g_oemkey[OEM_PUBK_=
SZ] =3D {OEM_PUBK};</span></font></div><div><font color=3D"#ff000=
0"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">#endif</span></font></div><div><font=20=
color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">signed int fg_swocv_v;</span></font></div=
><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">signed int=
 fg_swocv_i;</span></font></div><div><font color=3D"#ff0000"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">int shutdown_time;</span></font></div><div><=
font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">int boot_voltage;=
</span></font></div><div><font color=3D"#ff0000"><br></font></div=
><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef MTK=
_AB_OTA_UPDATER</span></font></div><div><font color=3D"#ff0000"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">/* FIXME: need to provide public key id a=
nd system partition path */</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">#define PUBLIC_KEY_ID "Android=
:#7e4333f9bba00adfe0ede979e28ed1920492b40f"</span></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">static char *=
p_AB_suffix;</span></font></div><div><font color=3D"#ff0000"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">static uint8 AB_retry_count;</span></font></=
div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif=20=
/* MTK_AB_OTA_UPDATER */</span></font></div><div><font color=3D"#=
ff0000"><br></font></div><div><font color=3D"#ff0000"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">/* Please define SN_BUF_LEN in cust_usb.h */</span>=
</font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">#ifndef SN_BUF_LEN</span></font></div><div><font color=3D"#ff00=
00"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">#define SN_BUF_LEN &nbsp;19 &nbsp;/*=
 fastboot use 13 bytes as default, max is 19 */</span></font></di=
v><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</s=
pan></font></div><div><font color=3D"#ff0000"><br></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#define FDT_B=
UFF_SIZE &nbsp;1024</span></font></div><div><font color=3D"#ff000=
0"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">#define FDT_BUFF_PATTERN &nbsp;"BUFFE=
ND"</span></font></div><div><font color=3D"#ff0000"><br></font></=
div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#define=
 DEFAULT_SERIAL_NUM "0123456789ABCDEF"</span></font></div><div><f=
ont color=3D"#ff0000"><br></font></div><div><font color=3D"#ff000=
0"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">#define KERNEL_64BITS 1</span></font>=
</div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#defi=
ne KERNEL_32BITS 0</span></font></div><div><font color=3D"#ff0000=
"><br></font></div><div><font color=3D"#ff0000"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">#define DTB_MAX_SIZE &nbsp; &nbsp;(512*1024)</span></font=
></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">/*</=
span></font></div><div><font color=3D"#ff0000"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">&nbsp;* Support read barcode from /dev/pro_info to be seri=
al number.</span></font></div><div><font color=3D"#ff0000"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">&nbsp;* Then pass the serial number from cmdli=
ne to kernel.</span></font></div><div><font color=3D"#ff0000"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">&nbsp;*/</span></font></div><div><font colo=
r=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">/* #define SERIAL_NUM_FROM=
_BARCODE */</span></font></div><div><font color=3D"#ff0000"><br><=
/font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>#if defined(CONFIG_MTK_USB_UNIQUE_SERIAL) || (defined(MTK_SECURI=
TY_SW_SUPPORT) &amp;&amp; defined(MTK_SEC_FASTBOOT_UNLOCK_SUPPORT=
))</span></font></div><div><font color=3D"#ff0000"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">#define SERIALNO_LEN &nbsp; &nbsp;38 &nbsp;/* from pre=
loader */</span></font></div><div><font color=3D"#ff0000"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">char sn_buf[SN_BUF_LEN+1] =3D ""; /* will read=20=
from EFUSE_CTR_BASE */</span></font></div><div><font color=3D"#ff=
0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">#else</span></font></div><div><fon=
t color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#define SERIALNO_LEN=20=
&nbsp; &nbsp;38</span></font></div><div><font color=3D"#ff0000"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">char sn_buf[SN_BUF_LEN+1] =3D FASTBOOT_DE=
VNAME;</span></font></div><div><font color=3D"#ff0000"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">#endif</span></font></div><div><font color=3D"#ff0=
000"><br></font></div><div><font color=3D"#ff0000"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">static struct udc_device surf_udc_device =3D {</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span=
></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">.vendor_id &nbsp;=3D USB_VENDORI=
D,</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">.product_id =3D USB_PR=
ODUCTID,</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">.version_id =3D=20=
USB_VERSIONID,</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">.manufactu=
rer &nbsp; =3D USB_MANUFACTURER,</span></font></div><div><font co=
lor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spa=
ce:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">.product &nbsp; &nbsp;=3D USB_PRODUCT_NAME,</span></font>=
</div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">};</s=
pan></font></div><div><font color=3D"#ff0000"><br></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">char *cmdline=
_get(void)</span></font></div><div><font color=3D"#ff0000"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">{</span></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">retu=
rn g_cmdline;</span></font></div><div><font color=3D"#ff0000"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#f=
f0000"><br></font></div><div><font color=3D"#ff0000"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">bool cmdline_append(const char* append_string)</span=
></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">{</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">//cmdline size check</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">int append_len;</span></fo=
nt></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-sp=
an" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">append_len =3D strlen(append_string=
);</span></font></div><div><font color=3D"#ff0000"><br></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">if ((append_len + strlen(g_cmdline)) &gt;=
 CMDLINE_LEN - 2) { //careful about whitespace between two string=
s</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"[MBO=
OT] ERROR CMDLINE overflow\n");</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">video_printf("[MBOOT] ERROR CMDLINE overflow\n");</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">assert(0);</span></font></div><=
div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">snpri=
ntf(g_cmdline, CMDLINE_LEN - 1, "%s %s", g_cmdline, append_string=
);</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">return true;</span></f=
ont></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}=
</span></font></div><div><font color=3D"#ff0000"><br></font></div=
><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">bool cmdli=
ne_overwrite(const char* overwrite_string)</span></font></div><di=
v><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">{</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">int cmd_len;</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">cmd_len =3D strlen(overwrite_string);</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">if (cmd_len &gt; CMDLINE_LEN - 1) {<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"[MBOOT=
] ERROR CMDLINE overflow\n");</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">return false;</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">strncpy(g_cmdline, overwrite=
_string, CMDLINE_LEN - 1);</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">return true;</span></font></div><div><font color=3D"#ff0000"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#=
ff0000"><br></font></div><div><font color=3D"#ff0000"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">void msg_header_error(char *img_name)</span></font>=
</div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">{</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"[MBOOT] Lo=
ad '%s' partition Error\n", img_name);</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">dprintf(CRITICAL,"\n*******************************=
************************\n");</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">dprintf(CRITICAL,"ERROR.ERROR.ERROR.ERROR.ERROR.ERROR.ERROR.ER=
ROR.ERROR\n");</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CR=
ITICAL,"*******************************************************\n=
");</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"&gt;=
 If you use NAND boot\n");</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">dprintf(CRITICAL,"&gt; (1) %s is wrong !!!! \n", img_name);</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"&gt; (2) p=
lease make sure the image you've downloaded is correct\n");</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"\n&gt; If yo=
u use MSDC boot\n");</span></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dpri=
ntf(CRITICAL,"&gt; (1) %s is not founded in SD card !!!! \n",img_=
name);</span></font></div><div><font color=3D"#ff0000"><span clas=
s=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"=
&gt; (2) please make sure the image is put in SD card\n");</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"*************=
******************************************\n");</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">dprintf(CRITICAL,"ERROR.ERROR.ERROR.ERROR.=
ERROR.ERROR.ERROR.ERROR.ERROR\n");</span></font></div><div><font=20=
color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-s=
pace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">dprintf(CRITICAL,"*************************************=
******************\n");</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">m=
tk_wdt_disable();</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">mdelay(=
8000);</span></font></div><div><font color=3D"#ff0000"><span clas=
s=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">mtk_arch_reset(1);=
</span></font></div><div><font color=3D"#ff0000"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><br></=
font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
void msg_img_error(char *img_name)</span></font></div><div><font=20=
color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">{</span></font></div><=
div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">dprintf(CRITICAL,"[MBOOT] Load '%s' partition E=
rror\n", img_name);</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprin=
tf(CRITICAL,"\n**************************************************=
*****\n");</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITIC=
AL,"ERROR.ERROR.ERROR.ERROR.ERROR.ERROR.ERROR.ERROR.ERROR\n");</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"*********=
**********************************************\n");</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"&gt; Please check ke=
rnel and rootfs in %s are both correct.\n",img_name);</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"******************=
*************************************\n");</span></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">dprintf(CRITICAL,"ERROR.ERROR.ERROR.ERROR.ERROR=
.ERROR.ERROR.ERROR.ERROR\n");</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">dprintf(CRITICAL,"********************************************=
***********\n");</span></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">mtk_wdt_=
disable();</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">mdelay(8000);<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">mtk_arch_reset(1);</span>=
</font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">}</span></font></div><div><font color=3D"#ff0000"><br></font></=
div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">//*****=
****</span></font></div><div><font color=3D"#ff0000"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">//* Notice : it's kernel start addr (and not include=
 any debug header)</span></font></div><div><font color=3D"#ff0000=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">extern unsigned int g_kmem_off;</span>=
</font></div><div><font color=3D"#ff0000"><br></font></div><div><=
font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">//*********</span=
></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">//* Notice : it's rootfs start addr (and not include any debug=
 header)</span></font></div><div><font color=3D"#ff0000"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">extern unsigned int g_rmem_off;</span></font></d=
iv><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef U=
SE_ITS_BOOTIMG</span></font></div><div><font color=3D"#ff0000"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">extern unsigned int g_smem_off;</span></fo=
nt></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#e=
ndif</span></font></div><div><font color=3D"#ff0000"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">extern unsigned int g_rimg_sz;</span></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern int g_=
nr_bank;</span></font></div><div><font color=3D"#ff0000"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">extern unsigned int boot_time;</span></font></di=
v><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern BO=
OT_ARGUMENT *g_boot_arg;</span></font></div><div><font color=3D"#=
ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">#ifdef MTK_KERNEL_POWER_OFF_CHAR=
GING</span></font></div><div><font color=3D"#ff0000"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">extern bool g_boot_reason_change;</span></font></div=
><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</sp=
an></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">extern int has_set_p2u;</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">extern unsigned int g_fb_base;=
</span></font></div><div><font color=3D"#ff0000"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">extern unsigned int g_fb_size;</span></font></div><div><=
font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff00=
00"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">void *g_fdt;</span></font></div><div=
><font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff=
0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">bool dtb_overlay(void* fdt, int si=
ze)</span></font></div><div><font color=3D"#ff0000"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">{</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">char *base_=
buf;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">char *overlay_buf;</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">struct fdt_header *blob;</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">struct fdt_header *new_blob;=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">size_t blob_len =3D 0, o=
verlay_len =3D 0, new_blob_size =3D 0;</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">int ret;</span></font></div><div><font color=3D"#ff=
0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">g_=
fdt =3D fdt;</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef LK_PR=
OFILING</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">unsigned int time=
_overlay;</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span></=
font></div><div><font color=3D"#ff0000"><br></font></div><div><fo=
nt color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whit=
e-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">if (fdt =3D=3D NULL) {</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">dprintf(CRITICAL, "fdt is NULL\n");</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">return FALSE;</span></font></div><div><fo=
nt color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whit=
e-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (size =3D=
=3D 0) {</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICA=
L, "fdt size is zero\n");</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">return FALSE;</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span><=
/font></div><div><font color=3D"#ff0000"><br></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">overlay_buf =3D load_overlay_dtbo("odmdtbo", &amp;o=
verlay_len);</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if ((overlay=
_buf =3D=3D NULL) || (overlay_len =3D=3D 0)) {</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">dprintf(CRITICAL, "load overlay dtbo faile=
d !\n");</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">return FALSE;</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div>=
<font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">str=
uct fdt_header *fdth =3D (struct fdt_header*)g_fdt;</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">fdth-&gt;totalsize =3D cpu_to_fdt32(si=
ze);</span></font></div><div><font color=3D"#ff0000"><br></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">ret =3D fdt_open_into(g_fdt, g_fdt, siz=
e);</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret) {</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL, "fdt_open_into fa=
iled \n");</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">return FALSE;=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">ret =3D fdt_check_header(g_fdt);</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">if (ret) {</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">dprintf(CRITICAL, "fdt_check_header check failed !\n=
");</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">return FALSE;</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span=
></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font=20=
color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">base_buf=20=
=3D fdt;</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">blob_len =3D siz=
e;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">blob =3D fdt_install_b=
lob(base_buf, blob_len);</span></font></div><div><font color=3D"#=
ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
if (!blob) {</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRI=
TICAL, "fdt_install_blob failed !\n");</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">return FALSE;</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">}</span></font></div><div><font color=3D"#ff0000"><br></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">dprintf(INFO, "blob_len len: 0x%x, overl=
ay_len: 0x%x\n", blob_len, overlay_len);</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">#ifdef LK_PROFILING</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">time_overlay =3D get_timer(0);</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">#endif</span></font></div><div><font color=3D"#f=
f0000"><br></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D apply_overlay(=
blob, blob_len, overlay_buf, overlay_len, fdt);</span></font></di=
v><div><font color=3D"#ff0000"><br></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">#ifdef LK_PROFILING</span></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dpr=
intf(INFO, "[PROFILE] ------- Overlay takes %d ms -------- \n", (=
int)get_timer(time_overlay));</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">#endif</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret) {</spa=
n></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL, "apply_ove=
rlay failed !\n");</span></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">retur=
n FALSE;</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font><=
/div><div><font color=3D"#ff0000"><br></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">g_fdt =3D fdt;</span></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">new=
_blob_size =3D fdt32_to_cpu(*(unsigned int *)(g_fdt+0x4));</span>=
</font></div><div><font color=3D"#ff0000"><br></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">return TRUE;</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><fon=
t color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"=
><br></font></div><div><font color=3D"#ff0000"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">static bool setup_fdt(void* fdt, int size)</span></font></=
div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">{</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">int ret;</span></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">u32 addr =3D (u32)fdt;</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">g_fdt =3D fdt;</span></font></div><div><font colo=
r=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef MTK_3LEVEL_PAGETABL=
E</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">arch_mmu_map((uint64_t)=
 ROUNDDOWN(addr, PAGE_SIZE), (uint32_t) ROUNDDOWN(addr, PAGE_SIZE=
),</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);"> &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; MMU_MEMORY_TYPE_NORMAL_WRITE_BACK | MMU_MEMO=
RY_AP_P_RW_U_NA, ROUNDUP(size, PAGE_SIZE));</span></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">ret =3D fdt_open_into(g_fdt, g_=
fdt, size); //DTB maximum size is 2MB</span></font></div><div><fo=
nt color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whit=
e-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">if (ret) return FALSE;</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">ret =3D fdt_check_header(g_fdt);</span></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">if (ret) return FALSE;</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">return TRUE;</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><fon=
t color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">extern int mboot_recovery_load_raw_part=
(char *part_name, unsigned long *addr, unsigned int size);</span>=
</font></div><div><font color=3D"#ff0000"><br></font></div><div><=
font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">bool bootimage_he=
ader_valid(char *buf)</span></font></div><div><font color=3D"#ff0=
000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">{</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">if (strncmp(buf, BOOT_MAGIC, BOOT_MAGIC_SIZE) =3D=3D 0)</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">return TRUE;</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">else</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">return FALSE;</span></font></div><div><font color=3D"#ff0=
000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font col=
or=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">void boot_get_os_version(unsigned *os_versio=
n)</span></font></div><div><font color=3D"#ff0000"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">{</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (NULL =3D=
=3D os_version)</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">return;<=
/span></font></div><div><font color=3D"#ff0000"><br></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">if (g_boot_hdr &amp;&amp; (TRUE =3D=3D bootima=
ge_header_valid(g_boot_hdr))) {</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">*os_version =3D g_boot_hdr-&gt;os_version;</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">else {</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">*os_version =3D=
 0;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><=
div><font color=3D"#ff0000"><br></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>return;</span></font></div><div><font color=3D"#ff0000"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000=
"><br></font></div><div><font color=3D"#ff0000"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">void platform_parse_bootopt(u8* bootopt_str)</span></font=
></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">{</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">int i =3D 0;</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">int find =3D 0;</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">/* search "bootopt" string */</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">for (; i &lt; (BOOT_ARGS_SIZE-0x16); i++) {=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">if ( 0 =3D=3D strncmp(&=
amp;bootopt_str[i], "bootopt=3D", sizeof("bootopt=3D")-1)) {</spa=
n></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">/* skip SMC, LK option */</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">//Kernel option offset 0=
x12</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">if ( 0 =3D=3D strncmp=
(&amp;bootopt_str[i+0x12], "64", sizeof("64")-1)) {</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">				</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">g_is_64bit_kernel =3D 1;</span></fo=
nt></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-sp=
an" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">				</span=
></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">find =3D 1;</span></font></div><=
div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">				</span></span><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">break;</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">}</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">if ( 0 =3D=3D strncmp=
(&amp;bootopt_str[i+0x12], "32", sizeof("32")-1)) {</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">				</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">find =3D 1;</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">				</span></span><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">break;</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">}</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (=
!find) {</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICA=
L, "Warning! No bootopt info!\n");</span></font></div><div><font=20=
color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-s=
pace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">//No endless loop here because it will stuck when boot=
 partition data lost</span></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</s=
pan></font></div><div><font color=3D"#ff0000"><br></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></fon=
t></div><div><font color=3D"#ff0000"><br></font></div><div><font=20=
color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">#if defined(CFG_DTB_EA=
RLY_LOADER_SUPPORT)</span></font></div><div><font color=3D"#ff000=
0"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">int bldr_load_dtb(char* boot_load_par=
tition)</span></font></div><div><font color=3D"#ff0000"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">{</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">char *p=
tr;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">char *dtb_sz;</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span>=
</span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">u32 dtb_kernel_addr;</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">u32 zimage_addr,zimage_size,dtb_size,=
addr;</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">u32 dtb_addr =3D 0;</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">u32 tmp;</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">u32 offset;</span></font></div><div><font=20=
color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-s=
pace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">unsigned char *magic;</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">boot_img_hdr *p_boot_hdr;</span></font></div><div><font co=
lor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spa=
ce:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">int ret =3D 0;</span></font></div><div><font color=3D"#ff=
0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ch=
ar part_name[16];</span></font></div><div><font color=3D"#ff0000"=
><br></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D malloc (DTB_MAX_SI=
ZE);</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">if (ptr =3D=3D NULL) {=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL, "mall=
oc failed!\n");</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">return -=
1;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><=
div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">if (Check_RTC_Recovery_Mode() || unshield_recov=
ery_detection() ) {</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">boot=
_load_partition =3D "recovery";</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">}</span></font></div><div><font color=3D"#ff0000"><br></fo=
nt></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#i=
fdef MTK_AB_OTA_UPDATER</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">/=
* no more recovery partition in A/B system update, instead choose=
 boot_a or boot_b */</span></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">snpr=
intf(part_name, sizeof(part_name), "boot%s", p_AB_suffix);</span>=
</font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">#else</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">/* use input argu=
ment as usaual */</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">snprint=
f(part_name, sizeof(part_name), "%s", boot_load_partition);</span=
></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">#endif</span></font></div><div><font color=3D"#ff0000"><br></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">//load boot hdr</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">ret =3D mboot_recovery_load_raw_part(part_n=
ame, ptr, sizeof(boot_img_hdr)+0x800);</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">if (ret &lt; 0) {</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">dprintf(CRITICAL, "mboot_recovery_load_raw_part(%s, %d) f=
ailed, ret: 0x%x\n", part_name, sizeof(boot_img_hdr)+0x800, ret);=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">goto _end;</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">}</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">if (FALSE =3D=3D bootimage_header_valid(ptr)) {</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">dprintf(CRITICAL, "bootimage_header_va=
lid failed\n");</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D=20=
-1;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">goto _end;</span></fo=
nt></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-sp=
an" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font col=
or=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">p_boot_hdr =3D=
 (void *)ptr;</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dtb_kernel_=
addr =3D p_boot_hdr-&gt;tags_addr;</span></font></div><div><font=20=
color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">platform_=
parse_bootopt(p_boot_hdr-&gt;cmdline);</span></font></div><div><f=
ont color=3D"#ff0000"><br></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (!=
g_is_64bit_kernel) {</span></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">//O=
ffset into zImage &nbsp; &nbsp;Value &nbsp; Description</span></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span>=
</span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">//0x24 &nbsp;0x016F2818 &nbsp;Mag=
ic number used to identify this is an ARM Linux zImage</span></fo=
nt></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-sp=
an" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">//0x28 &nbsp;start address &nbsp;=20=
The address the zImage starts at</span></font></div><div><font co=
lor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spa=
ce:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">//0x2C &nbsp;end address The address the zImage ends at<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">/* bootimg header size i=
s 0x800, the kernel img text is next to the header */</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">zimage_addr =3D ptr + p_boot_hdr-&g=
t;page_size;</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">zimage_size=
 =3D *(unsigned int *)((unsigned int)zimage_addr+0x2c) - *(unsign=
ed int *)((unsigned int)zimage_addr+0x28);</span></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">//dtb_addr =3D (unsigned int)zimage_addr + zim=
age_size;</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">offset =3D p_b=
oot_hdr-&gt;page_size + zimage_size;</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">tmp =3D ROUNDDOWN( p_boot_hdr-&gt;page_size + zimage=
_size, p_boot_hdr-&gt;page_size);</span></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">ret =3D partition_read(part_name, (off_t)tmp, ptr, (siz=
e_t)DTB_MAX_SIZE);</span></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (r=
et &lt; 0) {</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CR=
ITICAL, "partition_read failed, ret: 0x%x\n", ret);</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">goto _end;</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"=
><br></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">dtb_addr =3D ptr + offset=
 - tmp;</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dtb_size =3D fdt=
32_to_cpu(*(unsigned int *)(ptr + (offset - tmp) +0x4));</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span>=
</span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font c=
olor=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">else {</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">/* bootimg header size is 0=
x800, the kernel img text is next to the header */</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">int i;</span></font></div><div><font c=
olor=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">zimage_si=
ze =3D p_boot_hdr-&gt;kernel_size;</span></font></div><div><font=20=
color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-s=
pace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">offset =3D p_boot_hdr-&gt;page_size + p_boot_hdr-&gt;k=
ernel_size - (DTB_MAX_SIZE);</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">tmp =3D ROUNDUP(offset, p_boot_hdr-&gt;page_size);</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">ret =3D partition_read(part_name, (=
off_t)tmp, ptr, (size_t)DTB_MAX_SIZE);</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">if (ret &lt; 0) {</span></font></div><div><font co=
lor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spa=
ce:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">dprintf(CRITICAL, "partition_read failed, ret: 0x%x\n",=
 ret);</span></font></div><div><font color=3D"#ff0000"><span clas=
s=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">			</span></span><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">goto _end;</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><fo=
nt color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dtb_a=
ddr =3D 0;</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dtb_size =3D=20=
0;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">addr =3D ptr + (DTB_M=
AX_SIZE) - 4;</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">for (i=3D0=
; i&lt;(DTB_MAX_SIZE-4); i++, addr--) {</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">//FDT_MAGIC 0xd00dfeed</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">//dtb append after image.gz may not 4 byte align=
ment</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">magic =3D (unsigned c=
har *)addr;</span></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if ( *(magi=
c + 3) =3D=3D 0xED &amp;&amp;</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);"> &nbsp; &nbsp; &nbsp; &nbsp;*(magic + 2) =3D=3D 0xFE &amp;=
&amp;</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">			</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"> &nbsp; &nbsp; &n=
bsp; &nbsp;*(magic + 1) =3D=3D 0x0D &amp;&amp;</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);"> &nbsp; &nbsp; &nbsp; &nbsp;*(magic + 0)=20=
=3D=3D 0xD0) {</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">				</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dtb_add=
r =3D addr;</span></font></div><div><font color=3D"#ff0000"><br><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">				</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">break;</span></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}<=
/span></font></div><div><font color=3D"#ff0000"><br></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">if (dtb_addr =3D=3D 0) {</span></font></div><=
div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">dprintf(CRITICAL, "can't find dtb\n");</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">ret =3D -1;</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">goto _end;</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><br=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">dtb_sz =3D (char *)(dtb_addr+=
4);</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">dtb_size =3D *(dtb_sz=
) * 0x1000000 + *(dtb_sz+1)*0x10000 + *(dtb_sz+2) * 0x100 + *(dtb=
_sz+3);</span></font></div><div><font color=3D"#ff0000"><br></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL, "Kernel(%d) zimag=
e_size:0x%x,dtb_addr:0x%x(dtb_size:0x%x)\n",g_is_64bit_kernel, zi=
mage_size, dtb_addr, dtb_size);</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">}</span></font></div><div><font color=3D"#ff0000"><br></fo=
nt></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#i=
fdef MTK_3LEVEL_PAGETABLE</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>arch_mmu_map((uint64_t) ROUNDDOWN(dtb_kernel_addr, PAGE_SIZE), (=
uint32_t) ROUNDDOWN(dtb_kernel_addr, PAGE_SIZE), MMU_MEMORY_TYPE_=
NORMAL_WRITE_BACK | MMU_MEMORY_AP_P_RW_U_NA, ROUNDUP(dtb_size, PA=
GE_SIZE));</span></font></div><div><font color=3D"#ff0000"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">#endif</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>dprintf(INFO, "Copy DTB from 0x%x to 0x%x(size: 0x%x)\n", dtb_ad=
dr, dtb_kernel_addr, dtb_size);</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">memcpy(dtb_kernel_addr, (void *)dtb_addr, dtb_size);</span=
></font></div><div><font color=3D"#ff0000"><br></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">//placed setup_fdt() after bldr_load_dtb() due to=
 it set the fdt_header-&gt; totalsize</span></font></div><div><fo=
nt color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whit=
e-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">ret =3D setup_fdt((void *)dtb_kernel_addr, DTB_MAX_S=
IZE);</span><span class=3D"Apple-tab-span" style=3D"white-space:p=
re"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">//0x200000);</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(C=
RITICAL, "[LK] fdt setup addr:0x%x status:%d!!!\n", dtb_kernel_ad=
dr, ret);</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret =3D=3D=20=
FALSE) {</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICA=
L, "setup_fdt fail, ret: 0x%x!\n", ret);</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">ret =3D -1;</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">}</span></font></div><div><font color=3D"#ff0000"><br></font></=
div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">_end:</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">free(ptr);</span></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">return ret;</span></font></div><div><fon=
t color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div>=
<div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</spa=
n></font></div><div><font color=3D"#ff0000"><br></font></div><div=
><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">static void che=
ck_hibernation()</span></font></div><div><font color=3D"#ff0000">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">{</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">int hibboot =3D 0;</span></font></div><div><font color=3D"#ff00=
00"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">#define TMPBUF_SIZE 128</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">char tmpbuf[TMPBUF_SIZE];</span></fon=
t></div><div><font color=3D"#ff0000"><br></font></div><div><font=20=
color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-s=
pace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">hibboot =3D get_env("hibboot") =3D=3D NULL ? 0 : atoi(g=
et_env("hibboot"));</span></font></div><div><font color=3D"#ff000=
0"><br></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">switch (g_boot_mode) {</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">case RECOVERY_BOOT:</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">case FACTORY_BOOT:</span></fo=
nt></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-sp=
an" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">case ALARM_BOOT:</span></font></di=
v><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef MT=
K_KERNEL_POWER_OFF_CHARGING</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">case KERNEL_POWER_OFF_CHARGING_BOOT:</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">case LOW_POWER_OFF_CHARGING_BOOT:</span></font></=
div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">goto SKIP_HIB_BOOT;</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><f=
ont color=3D"#ff0000"><br></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (p=
latform_skip_hibernation &amp;&amp; platform_skip_hibernation())<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">goto SKIP_HIB_BOOT;</spa=
n></font></div><div><font color=3D"#ff0000"><br></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">if (get_env("resume") !=3D NULL) {</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">if (1 =3D=3D hibboot) {</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">snprintf(tmpbuf, TMPBUF_SIZE, "%s%s"=
, " resume=3D", get_env("resume"));</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">cmdline_append(tmpbuf);</span></font></div><div><fon=
t color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#if defined(MTK_MLC_N=
AND_SUPPORT)</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">snprintf(t=
mpbuf, TMPBUF_SIZE, "%s%s", " ubi.mtd=3D", get_env("ubi_data_mtd"=
));</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">cmdline_append(tmpbuf=
);</span></font></div><div><font color=3D"#ff0000"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">#endif</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">//cmd=
line_append(" no_console_suspend");</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">} else if (0 !=3D hibboot)</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">dprintf(CRITICAL,"resume =3D %s but hibboot =3D %=
s\n", get_env("resume"), get_env("hibboot"));</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">} else {</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">dprintf(CRITICAL,"resume =3D NULL \n");</span></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff000=
0"><br></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">return;</span></font></d=
iv><div><font color=3D"#ff0000"><br></font></div><div><font color=
=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">SKIP_HIB_BOOT:</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">if (hibboot !=3D 0)</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">if (set_env("hibboot", "0") !=3D 0)</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"lk_env hib=
boot set failed!!!\n");</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">i=
f (get_env("resume") !=3D NULL)</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">if (set_env("resume", '\0') !=3D 0)</span></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">dprintf(CRITICAL,"lk_evn resume set resume fa=
iled!!!\n");</span></font></div><div><font color=3D"#ff0000"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff=
0000"><br></font></div><div><font color=3D"#ff0000"><br></font></=
div><div><font color=3D"#ff0000"><br></font></div><div><font colo=
r=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><br><=
/font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>#ifdef DEVICE_TREE_SUPPORT</span></font></div><div><font color=3D=
"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">void lk_jump64(u32 addr, u32 arg1, u32 arg2, u32=20=
arg3)</span></font></div><div><font color=3D"#ff0000"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">{</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(C=
RITICAL,"\n[LK]jump to K64 0x%x\n", addr);</span></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">dprintf(INFO,"smc jump\n");</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">jumparch64_smc(addr, arg1, arg2, arg3);</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"Do nothing no=
w! wait for SMC done\n");</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>while (1)</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">;</span></fon=
t></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</=
span></font></div><div><font color=3D"#ff0000"><br></font></div><=
div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">void memcpy_=
u8(unsigned char *dest, unsigned char *src, unsigned int size)</s=
pan></font></div><div><font color=3D"#ff0000"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">{</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">unsigned int i;</=
span></font></div><div><font color=3D"#ff0000"><br></font></div><=
div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">for (i =3D 0; i &lt; size; i++) {</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">*(dest + i) =3D *(src + i);</span></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font co=
lor=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><di=
v><font color=3D"#ff0000"><br></font></div><div><font color=3D"#f=
f0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">extern bool decompress_kernel(uns=
igned char *in, void *out, int inlen, int outlen);</span></font><=
/div><div><font color=3D"#ff0000"><br></font></div><div><font col=
or=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">#if defined(MTK_GOOGLE_TR=
USTY_SUPPORT)</span></font></div><div><font color=3D"#ff0000"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">int trusty_dts_append(void *fdt)</span></fo=
nt></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">{<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">int offset, ret =3D 0;</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">int nodeoffset =3D 0;</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">unsigned int trusty_reserved_m=
em[4] =3D {0};</span></font></div><div><font color=3D"#ff0000"><b=
r></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">offset =3D fdt_path_offset(fd=
t, "/reserved-memory");</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">n=
odeoffset =3D fdt_add_subnode(fdt, offset, "trusty-reserved-memor=
y");</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">if (nodeoffset &lt; 0)=
 {</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL, "Wa=
rning: can't add trusty-reserved-memory node in device tree\n");<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">return 1;</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">ret =3D fdt_setprop_string(fdt, nodeoffset, "compatible", "medi=
atek,trusty-reserved-memory");</span></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">if (ret) {</span></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf=
(CRITICAL, "Warning: can't add trusty compatible property in devi=
ce tree\n");</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">return 1;</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">ret =3D fdt_setprop(fdt, nodeoffset, "no-map", NU=
LL, 0);</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret) {</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL, "Warning: ca=
n't add trusty no-map property in device tree\n");</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">return 1;</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">trusty_rese=
rved_mem[0] =3D 0;</span></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">trusty=
_reserved_mem[1] =3D (u32)cpu_to_fdt32(g_boot_arg-&gt;tee_reserve=
d_mem.start);</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">trusty_rese=
rved_mem[2] =3D 0;</span></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">trusty=
_reserved_mem[3] =3D (u32)cpu_to_fdt32(g_boot_arg-&gt;tee_reserve=
d_mem.size);</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D fdt_=
setprop(fdt, nodeoffset, "reg", trusty_reserved_mem, sizeof(unsig=
ned int)*4);</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret) {</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL, "Warnin=
g: can't add trusty reg property in device tree\n");</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">return 1;</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(C=
RITICAL,"trusty-reserved-memory is appended (0x%llx, 0x%llx)\n",<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);"> &nbsp; &nbsp; &nbsp; &nb=
sp;g_boot_arg-&gt;tee_reserved_mem.start, g_boot_arg-&gt;tee_rese=
rved_mem.size);</span></font></div><div><font color=3D"#ff0000"><=
br></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">return ret;</span></font></d=
iv><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span>=
</font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">#endif</span></font></div><div><font color=3D"#ff0000"><br></fo=
nt></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ex=
tern void Debug_log_EMI_MPU(void) __attribute__((weak));</span></=
font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
int boot_linux_fdt(void *kernel, unsigned *tags,</span></font></d=
iv><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;unsi=
gned machtype,</span></font></div><div><font color=3D"#ff0000"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=20=
&nbsp; &nbsp; &nbsp; &nbsp;void *ramdisk, unsigned ramdisk_size)<=
/span></font></div><div><font color=3D"#ff0000"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">{</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">void *fdt =3D t=
ags;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">int ret;</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">int offset;</span></font></div><div><f=
ont color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#define TMPBUF_SIZ=
E 200</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">char tmpbuf[TMPBUF_SI=
ZE];</span></font></div><div><font color=3D"#ff0000"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">#ifdef MTK_DTBO_FEATURE</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">bool rtn;</span></font></div><div><font color=3D"#ff0=
000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">#endif</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">dt_dram_info mem_reg_property[128];</span></font></di=
v><div><font color=3D"#ff0000"><br></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">int i;</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">void (*entry)(un=
signed,unsigned,unsigned*) =3D kernel;</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">unsigned int lk_t =3D 0;</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">unsigned int pl_t =3D 0;</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">unsigned int boot_reason =3D 0;</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">char buf[FDT_BUFF_SIZE+8], *ptr;</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">int decompress_outbuf_size =3D 0x1C000=
00;</span></font></div><div><font color=3D"#ff0000"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">#ifndef USE_ITS_BOOTIMG</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">unsigned int zimage_size;</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">unsigned int dtb_addr=3D0;</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">unsigned int dtb_size;</span></font></div><div><fon=
t color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (g_i=
s_64bit_kernel) {</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">unsign=
ed char *magic;</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">unsigned=
 int addr;</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">unsigned int=20=
zimage_addr =3D (unsigned int)target_get_scratch_address();</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">/* to boot k64*/</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">dprintf(INFO,"64 bits kernel\n");</s=
pan></font></div><div><font color=3D"#ff0000"><br></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">dprintf(INFO,"g_boot_hdr=3D%p\n", g_boot_hdr);=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(INFO,"g_boot_hd=
r-&gt;kernel_size=3D0x%08x\n", g_boot_hdr-&gt;kernel_size);</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">zimage_size =3D (g_boot_hdr-&=
gt;kernel_size);</span></font></div><div><font color=3D"#ff0000">=
<br></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">if (g_boot_hdr-&gt;kernel_=
addr &amp; 0x7FFFF) {</span></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">d=
printf(CRITICAL,"64 bit kernel can't boot at g_boot_hdr-&gt;kerne=
l_addr=3D0x%08x\n",g_boot_hdr-&gt;kernel_addr);</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">dprintf(CRITICAL,"Please check your boot=
img setting\n");</span></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">while=20=
(1)</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">				</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">;</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0=
000"><br></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">addr =3D (unsigned in=
t)(zimage_addr + zimage_size);</span></font></div><div><font colo=
r=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><br><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">for (dtb_size =3D 0; dtb_size &=
lt; zimage_size; dtb_size++, addr--) {</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">//FDT_MAGIC 0xd00dfeed ... dtf</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">//dtb append after image.gz may not 4 byt=
e alignment</span></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">magic =3D (=
unsigned char *)addr;</span></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">i=
f ( *(magic + 3) =3D=3D 0xED &amp;&amp;</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);"> &nbsp; &nbsp; &nbsp; &nbsp;*(magic + 2) =3D=3D=20=
0xFE &amp;&amp;</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"> &nbsp;=
 &nbsp; &nbsp; &nbsp;*(magic + 1) =3D=3D 0x0D &amp;&amp;</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);"> &nbsp; &nbsp; &nbsp; &nbsp;*(m=
agic + 0) =3D=3D 0xD0)</span></font></div><div><font color=3D"#ff=
0000"><br></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">{</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">				</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">dtb_addr =3D addr;</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">				</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">dprintf(INFO,"get dtb_addr=3D0x%08x, dtb_size=3D=
0x%08x\n", dtb_addr, dtb_size);</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">				</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">dprintf(INFO,"copy dtb, fdt=3D0x%08x\n", (unsigned int)=
fdt);</span></font></div><div><font color=3D"#ff0000"><br></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">				</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">//fix size to 4 byte alignment</spa=
n></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">dtb_size =3D (dtb_size + 0=
x3) &amp; (~0x3);</span></font></div><div><font color=3D"#ff0000"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">#if CFG_DTB_EARLY_LOADER_SUPPORT</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">				</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">//skip dtb copy, we load dtb=
 in preloader</span></font></div><div><font color=3D"#ff0000"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">#else</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">				</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">memcpy_u8(fdt, (void *)dtb_addr, dtb_size);</span></font></div=
><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		=09=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">dtb_addr =3D (unsigned in=
t)fdt;</span></font></div><div><font color=3D"#ff0000"><br></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">				</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">break;</span></font></div><div><fo=
nt color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whit=
e-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span=
></font></div><div><font color=3D"#ff0000"><br></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">if (dtb_size !=3D zimage_size) {</span></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">zimage_size -=3D dtb_size;</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">} else {</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">dprintf(CRITICAL,"can't find device tree\n");</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><=
font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dpr=
intf(INFO,"zimage_addr=3D0x%08x, zimage_size=3D0x%08x\n", zimage_=
addr, zimage_size);</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dpri=
ntf(INFO,"decompress kernel image...");</span></font></div><div><=
font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">/*=20=
for 64bit decompreesed size.</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;"> * LK start: 0x41E00000, Kernel Start: 0x40080000</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);"> * Max is 0x41E00000 - 0x40080000 =3D=
 0x1D80000.</span></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"> * using 0x1=
C00000=3D28MB for decompressed kernel image size */</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">#ifdef KERNEL_DECOMPRESS_SIZE</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">decompress_outbuf_size =3D KER=
NEL_DECOMPRESS_SIZE;</span></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#en=
dif</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">if (decompress_kernel=
((unsigned char *)zimage_addr, (void *)g_boot_hdr-&gt;kernel_addr=
, (int)zimage_size, (int)decompress_outbuf_size)) {</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"decompress kernel=20=
image fail!!!\n");</span></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">whil=
e (1)</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">				</span></span><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">;</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">} else {</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(INFO,=
"32 bits kernel\n");</span></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">zim=
age_size =3D *(unsigned int *)((unsigned int)kernel+0x2c) - *(uns=
igned int *)((unsigned int)kernel+0x28);</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">dtb_addr =3D (unsigned int)kernel + zimage_size;=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><di=
v><font color=3D"#ff0000"><br></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">i=
f (fdt32_to_cpu(*(unsigned int *)dtb_addr) =3D=3D FDT_MAGIC) {</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">dtb_size =3D fdt32_to_cpu(=
*(unsigned int *)(dtb_addr+0x4));</span></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">} else {</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprint=
f(CRITICAL,"Can't find device tree. Please check your kernel imag=
e\n");</span></font></div><div><font color=3D"#ff0000"><span clas=
s=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">while (1)</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">;</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">//dprintf(CRITICAL,"use default device tree\n");</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">//dtb_addr =3D (unsigned in=
t)&amp;device_tree;</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">//dt=
b_size =3D device_tree_size;</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">}</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(INFO,"dtb_addr=
 =3D 0x%08X, dtb_size =3D 0x%08X\n", dtb_addr, dtb_size);</span><=
/font></div><div><font color=3D"#ff0000"><br></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">if (((unsigned int)fdt + dtb_size) &gt; g_fb_base)=20=
{</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"[ERR=
OR] dtb end address (0x%08X) is beyond the memory (0x%08X).\n", (=
unsigned int)fdt+dtb_size, g_fb_base);</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">return FALSE;</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">}</span></font></div><div><font color=3D"#ff0000"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">#if CFG_DTB_EARLY_LOADER_SUPPORT</span></font></div><=
div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">//skip dtb copy, we load dtb in preloader</span=
></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">#else</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">memcpy(fdt, (voi=
d *)dtb_addr, dtb_size);</span></font></div><div><font color=3D"#=
ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></div><div><=
font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff00=
00"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">#else // USE_ITS_BOOTIMG</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">if (g_smem_off &amp;&amp; !strncmp((=
(struct dtb_header *)g_smem_off)-&gt;magic, DTB_MAGIC, sizeof(DTB=
_MAGIC))) {</span></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">unsigned int=
 platform_id =3D 0, soc_rev =3D 0, version_id =3D 0; // These sho=
uld be got from IDME???</span></font></div><div><font color=3D"#f=
f0000"><br></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">// multi-dtb found</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">struct dtb_entry *dtb_ptr=20=
=3D (struct dtb_entry *)(g_smem_off + sizeof(struct dtb_header));=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">for (i=3D0; i&lt;(int)(=
(struct dtb_header *)g_smem_off)-&gt;num_of_dtbs; i++) {</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">// Compare platform/version/soc=
 revision id with current dtb entry</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">if (dtb_ptr-&gt;platform_id =3D=3D platform_id &amp;=
&amp; dtb_ptr-&gt;soc_rev =3D=3D soc_rev &amp;&amp; dtb_ptr-&gt;v=
ersion_id =3D=3D version_id) {</span></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">				</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">memcpy(fdt, (void *)(g_smem_off + dtb_ptr-&gt;offset), d=
tb_ptr-&gt;size);</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">				</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">brea=
k;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">// Move to next dtb entry</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">dtb_ptr ++;</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">} else if (=
g_smem_off)</span></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">memcpy(fdt,=20=
(void *)g_smem_off, device_tree_size);</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">else</span></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">memcp=
y(fdt, (void *)&amp;device_tree, device_tree_size);</span></font>=
</div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endi=
f</span></font></div><div><font color=3D"#ff0000"><br></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">strcpy(&amp;buf[FDT_BUFF_SIZE], FDT_BUFF_P=
ATTERN);</span></font></div><div><font color=3D"#ff0000"><br></fo=
nt></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#i=
f CFG_DTB_EARLY_LOADER_SUPPORT</span></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">//skip dtb setup, we setup dtb in platform.c</span></font><=
/div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#else<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D setup_fdt(fdt, DT=
B_MAX_SIZE);</span><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">//MIN(0x100000, (g_fb_base-(unsigned int)fdt)));</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">if (ret =3D=3D FALSE) return F=
ALSE;</span></font></div><div><font color=3D"#ff0000"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">#endif</span></font></div><div><font color=3D"#ff00=
00"><br></font></div><div><font color=3D"#ff0000"><br></font></di=
v><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef MT=
K_DTBO_FEATURE</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">rtn =3D dt=
b_overlay(fdt, dtb_size);</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>dtb_size =3D fdt32_to_cpu(*(unsigned int *)(fdt+0x4));</span></f=
ont></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#=
endif</span></font></div><div><font color=3D"#ff0000"><br></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">extern int target_fdt_jtag(void *fdt)_=
_attribute__((weak));</span></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if=20=
(target_fdt_jtag) {</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">targ=
et_fdt_jtag(fdt);</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span=
></font></div><div><font color=3D"#ff0000"><br></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">extern int target_fdt_model(void *fdt)__attribute=
__((weak));</span></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (target_fd=
t_model) {</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">target_fdt_mo=
del(fdt);</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font>=
</div><div><font color=3D"#ff0000"><br></font></div><div><font co=
lor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spa=
ce:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">extern int target_fdt_cpus(void *fdt)__attribute__((weak)=
);</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">if (target_fdt_cpus) {=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">target_fdt_cpus(fdt);</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div>=
<font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0=
000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">#ifndef MACH_FPGA</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">/* MD standard alone partition feature sta=
rt */</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">/* NOTE: This MUST be=
fore setup_mem_property_use_mblock_info !!!!!! */</span></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">if (g_boot_mode !=3D RECOVERY_BOOT) {</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">extern void load_modem_ima=
ge(void)__attribute__((weak));</span></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">if (load_modem_image) {</span></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">load_modem_image();</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">} else {</span></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRI=
TICAL,"[ccci] modem standalone not support\n");</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>} else {</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITIC=
AL,"[ccci] recovery mode, no need load modem\n");</span></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">/* MD standard alone partition feature end */</span></font></di=
v><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</s=
pan></font></div><div><font color=3D"#ff0000"><br></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef MTK_SE=
CURITY_ANTI_ROLLBACK</span></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret=20=
=3D sec_otp_ver_update();</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>imgver_not_sync_warning(g_boot_arg-&gt;pl_imgver_status,ret);</s=
pan></font></div><div><font color=3D"#ff0000"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">#endif</span></font></div><div><font color=3D"#ff0000"><br>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">extern int setup_mem_property_u=
se_mblock_info(dt_dram_info *, size_t) __attribute__((weak));</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">if (setup_mem_property_use_m=
block_info) {</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D se=
tup_mem_property_use_mblock_info(</span></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;mem_reg_propert=
y[0],</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"> &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp;sizeof(mem_reg_property)/sizeof(dt_dram_info));<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">if (ret) return FALSE;</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">} else {</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">for (i =3D 0; i &lt; g_nr_bank; ++i) {</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	=09=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">unsigned int fb_size =3D=20=
(i =3D=3D g_nr_bank-1) ? g_fb_size : 0;</span></font></div><div><=
font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff00=
00"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">#ifndef MTK_LM_MODE</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">mem_reg_property[i].start_hi =3D cpu_to=
_fdt32(0);</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">mem_reg_prop=
erty[i].start_lo =3D cpu_to_fdt32(bi_dram[i].start);</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">mem_reg_property[i].size_hi =3D cpu=
_to_fdt32(0);</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">mem_reg_p=
roperty[i].size_lo =3D cpu_to_fdt32(bi_dram[i].size-fb_size);</sp=
an></font></div><div><font color=3D"#ff0000"><br></font></div><di=
v><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#else</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">mem_reg_property[i].start_hi =3D=
 cpu_to_fdt32(bi_dram[i].start&gt;&gt;32);</span></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">mem_reg_property[i].start_lo =3D cpu_to_fdt32=
(bi_dram[i].start);</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">mem=
_reg_property[i].size_hi =3D cpu_to_fdt32((bi_dram[i].size-fb_siz=
e)&gt;&gt;32);</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">mem_reg_=
property[i].size_lo =3D cpu_to_fdt32(bi_dram[i].size-fb_size);</s=
pan></font></div><div><font color=3D"#ff0000"><br></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">dprintf(INFO," mem_reg_proper=
ty[%d].start_hi =3D 0x%08X\n", i, mem_reg_property[i].start_hi);<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(INFO," mem_reg_=
property[%d].start_lo =3D 0x%08X\n", i, mem_reg_property[i].start=
_lo);</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">			</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(INFO," me=
m_reg_property[%d].size_hi =3D 0x%08X\n", i, mem_reg_property[i].=
size_hi);</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(INFO,=
" mem_reg_property[%d].size_lo =3D 0x%08X\n", i, mem_reg_property=
[i].size_lo);</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span>=
</span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font c=
olor=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern int=
 target_fdt_dram_dummy_read(void *fdt, unsigned int rank_num)__at=
tribute__((weak));</span></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (ta=
rget_fdt_dram_dummy_read) {</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">ret =3D target_fdt_dram_dummy_read(fdt, g_nr_bank);</span></fo=
nt></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-sp=
an" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">if (ret)</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">dprintf(CRITICAL,"ERROR: DRAM dummy read address=
 incorrect\n");</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span><=
/font></div><div><font color=3D"#ff0000"><br></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">extern int set_fdt_dbg_info(void *fdt)__attribute__=
((weak));</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (set_fdt_dbg=
_info) {</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D set_fdt=
_dbg_info(fdt);</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret)=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL, "ERR=
OR: debug info base and size incorrect\n");</span></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff000=
0"><br></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">offset =3D fdt_path_offs=
et(fdt, "/memory");</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">exter=
n int get_mblock_num(void) __attribute__((weak));</span></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">ret =3D fdt_setprop(fdt, offset, "reg",=20=
mem_reg_property,</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"> &nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;((int)get=
_mblock_num? get_mblock_num(): g_nr_bank ) * sizeof(dt_dram_info)=
);</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret) return FALSE;=
</span></font></div><div><font color=3D"#ff0000"><br></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">if (platform_atag_append) {</span></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">ret =3D platform_atag_append(fdt);</spa=
n></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">if (ret) return FALSE;</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><fon=
t color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef MBLOCK_LIB_SUP=
PORT</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D fdt_memory_app=
end(fdt);</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret) return=
 FALSE;</span></font></div><div><font color=3D"#ff0000"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">#endif</span></font></div><div><font color=3D"#ff=
0000"><br></font></div><div><font color=3D"#ff0000"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">#if defined(MTK_GOOGLE_TRUSTY_SUPPORT)</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">ret =3D trusty_dts_append(fdt);</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span=
></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">if (ret) return FALSE;</span></f=
ont></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#=
endif</span></font></div><div><font color=3D"#ff0000"><br></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">offset =3D fdt_path_offset(fdt, "/chos=
en");</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D fdt_setprop_c=
ell(fdt, offset, "linux,initrd-start",(unsigned int) ramdisk);</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">if (ret) return FALSE;</spa=
n></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">ret =3D fdt_setprop_cell(fdt,=
 offset, "linux,initrd-end", (unsigned int)ramdisk + ramdisk_size=
);</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret) return FALSE;=
</span></font></div><div><font color=3D"#ff0000"><br></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">ptr =3D (char *)target_atag_boot((unsigned=20=
*)buf);</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D fdt_setpr=
op(fdt, offset, "atag,boot", buf, ptr - buf);</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">if (ret) return FALSE;</span></font></div><div=
><font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff=
0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">pt=
r =3D (char *)target_atag_lastpc((unsigned *)buf);</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">ret =3D fdt_setprop(fdt, offset, "atag,=
lastpc", buf, ptr - buf);</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>if (ret) return FALSE;</span></font></div><div><font color=3D"#f=
f0000"><br></font></div><div><font color=3D"#ff0000"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">#if defined(MTK_DLPT_SUPPORT)</span></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">ptr =3D (char *)target_atag_imix_r((unsigned *)=
buf);</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D fdt_setprop(f=
dt, offset, "atag,imix_r", buf, ptr - buf);</span></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">if (ret) return FALSE;</span></font></div><div>=
<font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">snprintf(buf, FDT_BUFF_SIZE, "%d",=
 fg_swocv_v);</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D buf=
 + strlen(buf);</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D f=
dt_setprop(fdt, offset, "atag,fg_swocv_v", buf, ptr - buf);</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"fg_swocv_v b=
uf [%s], [0x%x:0x%x:%d]\n", buf, (unsigned)buf, (unsigned)ptr, pt=
r - buf);</span></font></div><div><font color=3D"#ff0000"><br></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">snprintf(buf, FDT_BUFF_SIZE, "%d",=
 fg_swocv_i);</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D buf=
 + strlen(buf);</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D f=
dt_setprop(fdt, offset, "atag,fg_swocv_i", buf, ptr - buf);</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"fg_swocv_i b=
uf [%s], [0x%x:0x%x:%d]\n", buf, (unsigned)buf, (unsigned)ptr, pt=
r - buf);</span></font></div><div><font color=3D"#ff0000"><br></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">snprintf(buf, FDT_BUFF_SIZE, "%d",=
 shutdown_time);</span></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D=20=
buf + strlen(buf);</span></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D=
 fdt_setprop(fdt, offset, "atag,shutdown_time", buf, ptr - buf);<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"shutdow=
n_time buf [%s], [0x%x:0x%x:%d]\n", buf, (unsigned)buf, (unsigned=
)ptr, ptr - buf);</span></font></div><div><font color=3D"#ff0000"=
><br></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">snprintf(buf, FDT_BUFF_SIZ=
E, "%d", boot_voltage);</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">p=
tr =3D buf + strlen(buf);</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>ret =3D fdt_setprop(fdt, offset, "atag,boot_voltage", buf, ptr -=
 buf);</span></font></div><div><font color=3D"#ff0000"><span clas=
s=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"=
boot_voltage buf [%s], [0x%x:0x%x:%d]\n", buf, (unsigned)buf, (un=
signed)ptr, ptr - buf);</span></font></div><div><font color=3D"#f=
f0000"><br></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D (char *)target=
_atag_mem((unsigned *)buf);</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">ret =3D fdt_setprop(fdt, offset, "atag,mem", buf, ptr - buf);</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">if (ret) return FALSE;</sp=
an></font></div><div><font color=3D"#ff0000"><br></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">if (target_atag_partition_data) {</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">ptr =3D (char *)target_atag_partition=
_data((unsigned *)buf);</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
if (ptr !=3D buf) {</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret=
 =3D fdt_setprop(fdt, offset, "atag,mem", buf, ptr - buf);</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">if (ret) return FALSE;</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">#if !(defined(MTK_UFS_BOOTING) || defined(M=
TK_EMMC_SUPPORT))</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (tar=
get_atag_nand_data) {</span></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">pt=
r =3D (char *)target_atag_nand_data((unsigned *)buf);</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">if (ptr !=3D buf) {</span></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">ret =3D fdt_setprop(fdt, offset, "atag=
,mem", buf, ptr - buf);</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>if (ret) return FALSE;</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
}</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">extern unsigned int *target_ata=
g_vcore_dvfs(unsigned *ptr)__attribute__((weak));</span></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">if (target_atag_vcore_dvfs) {</span></fo=
nt></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-sp=
an" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">ptr =3D (char *)target_atag_vcore_=
dvfs((unsigned *)buf);</span></font></div><div><font color=3D"#ff=
0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">r=
et =3D fdt_setprop(fdt, offset, "atag,vcore_dvfs", buf, ptr - buf=
);</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret) return FALSE=
;</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">} else {</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"Not Support VCORE DV=
FS\n");</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></=
div><div><font color=3D"#ff0000"><br></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">//some platform might not have this function, use weak refe=
rence for</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern unsigned=
 *target_atag_dfo(unsigned *ptr)__attribute__((weak));</span></fo=
nt></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-sp=
an" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">if (target_atag_dfo) {</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">ptr =3D (char *)target_atag_dfo((uns=
igned *)buf);</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D fd=
t_setprop(fdt, offset, "atag,dfo", buf, ptr - buf);</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">if (ret) return FALSE;</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D=
"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (g_boot_mode =3D=
=3D META_BOOT || g_boot_mode =3D=3D ADVMETA_BOOT || g_boot_mode =3D=
=3D ATE_FACTORY_BOOT || g_boot_mode =3D=3D FACTORY_BOOT) {</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">ptr =3D (char *)target_atag_me=
ta((unsigned *)buf);</span></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret=
 =3D fdt_setprop(fdt, offset, "atag,meta", buf, ptr - buf);</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">if (ret) return FALSE;</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">//sprintf(cmdline, "%s%s", cmd=
line, " rdinit=3Dsbin/multi_init");</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">cmdline_append("rdinit=3Dsbin/multi_init");</span></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span>=
</span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">unsigned int meta_com_id =3D g_bo=
ot_arg-&gt;meta_com_id;</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
if ((meta_com_id &amp; 0x0001) !=3D 0) {</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">cmdline_append("androidboot.usbconfig=3D1");</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">} else {</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">cmdline_append("androidboot.usbconfig=3D=
0");</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">if (g_boot_mode =3D=3D META_BOOT) {</span></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span=
></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">if ((meta_com_id &amp; 0x0002) !=
=3D 0) {</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">				</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">cmdline_appen=
d("androidboot.mblogenable=3D0");</span></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">} else {</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">				</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">cm=
dline_append("androidboot.mblogenable=3D1");</span></font></div><=
div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div=
><font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff=
0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">pt=
r =3D (char *)target_atag_devinfo_data((unsigned *)buf);</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span>=
</span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">ret =3D fdt_setprop(fdt, offset,=20=
"atag,devinfo", buf, ptr - buf);</span></font></div><div><font co=
lor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spa=
ce:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">if (ret) return FALSE;</span></font></div><div><font colo=
r=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">#ifndef MACH_FPGA_NO_DISPLAY</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">ptr =3D (char *)target_atag_videolfb((uns=
igned *)buf);</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D fdt=
_setprop(fdt, offset, "atag,videolfb", buf, ptr - buf);</span></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">if (ret) return FALSE;</span></fon=
t></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#el=
se</span></font></div><div><font color=3D"#ff0000"><br></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">extern int mt_disp_config_frame_buffer(vo=
id *fdt)__attribute__((weak));</span></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">if (mt_disp_config_frame_buffer) {</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">ret =3D mt_disp_config_frame_buffer(fdt);</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font=
 color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">#endif</span></font></div><div><font col=
or=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern int l=
astpc_decode(void *fdt)__attribute__((weak));</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">if (lastpc_decode) {</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">ret =3D lastpc_decode(fdt);</span></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">if (ret) return FALSE;</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000=
"><br></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">if (target_atag_mdinfo) {=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D (char *)target_=
atag_mdinfo((unsigned *)buf);</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">ret =3D fdt_setprop(fdt, offset, "atag,mdinfo", buf, ptr -=20=
buf);</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret) return FA=
LSE;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">} else {</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"DFO_MODEN_INFO Only=
 support in MT6582/MT6592\n");</span></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">}</span></font></div><div><font color=3D"#ff0000"><br></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">extern unsigned int *update_md_hdr_i=
nfo_to_dt(unsigned int *ptr, void *fdt)__attribute__((weak));</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">if (update_md_hdr_info_to_dt=
) {</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D (char *)updat=
e_md_hdr_info_to_dt((unsigned int *)buf, fdt);</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">ret =3D fdt_setprop(fdt, offset, "ccci,mod=
em_info", buf, ptr - buf);</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">if (ret)</span></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">return FALS=
E;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">else</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">dprintf(CRITICAL,"[ccci] create modem m=
em info DT OK\n");</span></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">} else=
 {</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"[cc=
ci] modem mem info not support\n");</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><br>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">extern unsigned int *update_lk_=
arg_info_to_dt(unsigned int *ptr, void *fdt)__attribute__((weak))=
;</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">if (update_lk_arg_info_=
to_dt) {</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D (char *=
)update_lk_arg_info_to_dt((unsigned int *)buf, fdt);</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">ret =3D fdt_setprop(fdt, offset, "cc=
ci,modem_info_v2", buf, ptr - buf);</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">if (ret)</span></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">re=
turn FALSE;</span></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">else</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"[ccci] creat=
e modem arguments info DT OK\n");</span></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">} else {</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprint=
f(CRITICAL,"[ccci] modem mem arguments info using v1\n");</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span=
></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font=20=
color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern un=
signed int *target_atag_ptp(unsigned *ptr)__attribute__((weak));<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">if (target_atag_ptp) {</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D (char *)target_ata=
g_ptp((unsigned *)buf);</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
ret =3D fdt_setprop(fdt, offset, "atag,ptp", buf, ptr - buf);</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">if (ret)</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">return FALSE;</span></font></div><div><fo=
nt color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whit=
e-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">else</span></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dpri=
ntf(CRITICAL,"Create PTP DT OK\n");</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">} else {</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dpri=
ntf(CRITICAL,"PTP_INFO Only support in MT6795\n");</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D=
"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern unsigned i=
nt *target_atag_masp_data(unsigned *ptr)__attribute__((weak));</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">if (target_atag_masp_data)=20=
{</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D (char *)target=
_atag_masp_data((unsigned *)buf);</span></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">ret =3D fdt_setprop(fdt, offset, "atag,masp", buf, ptr=20=
- buf);</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret)</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">return FALSE;</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">else</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">dprintf(CRITICAL,"create masp atag OK\n");</span></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">} else {</span></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">dprintf(CRITICAL,"masp atag not support in this platfor=
m\n");</span></font></div><div><font color=3D"#ff0000"><span clas=
s=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></d=
iv><div><font color=3D"#ff0000"><br></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">extern unsigned int *target_atag_tee(unsigned *ptr)__attribute=
__((weak));</span></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (target_at=
ag_tee) {</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D (char=20=
*)target_atag_tee((unsigned *)buf);</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">ret =3D fdt_setprop(fdt, offset, "tee_reserved_mem",=20=
buf, ptr - buf);</span></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret=
) return FALSE;</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">} else {<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"tee_re=
served_mem not supported\n");</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">}</span></font></div><div><font color=3D"#ff0000"><br></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">extern unsigned int *target_atag_isram(=
unsigned *ptr)__attribute__((weak));</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">if (target_atag_isram) {</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">ptr =3D (char *)target_atag_isram((unsigned *)buf);<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D fdt_setprop(fdt,=
 offset, "non_secure_sram", buf, ptr - buf);</span></font></div><=
div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">if (ret) return FALSE;</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">} else {</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">dprintf(CRITICAL,"non_secure_sram not supported\n");</span></fo=
nt></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-sp=
an" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font col=
or=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">#ifdef MTK_AB_OTA_UPDATER</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">/* when boot to recovery, do not append "sk=
ip_initramfs" to command line */</span></font></div><div><font co=
lor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spa=
ce:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">if (g_boot_mode !=3D RECOVERY_BOOT)</span></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">cmdline_append("skip_initramfs");</span></font=
></div><div><font color=3D"#ff0000"><br></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">snprintf(tmpbuf, TMPBUF_SIZE, "system%s",p_AB_suffix);</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">part_t* part =3D mt_part_g=
et_partition(tmpbuf);</span></font></div><div><font color=3D"#ff0=
000"><br></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">snprintf(tmpbuf, TMPBU=
F_SIZE, "rootwait ro init=3D/init root=3D/dev/dm-0 dm=3D\"system=20=
none ro,0 1 android-verity PARTUUID=3D%s %s\" androidboot.slot_su=
ffix=3D%s", part-&gt;info-&gt;uuid, PUBLIC_KEY_ID,p_AB_suffix);</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">cmdline_append(tmpbuf);</s=
pan></font></div><div><font color=3D"#ff0000"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">#ifdef USER_BUILD</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">c=
mdline_append("buildvariant=3Duser");</span></font></div><div><fo=
nt color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#else</span></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">cmdline_append("buildvariant=3Deng");</s=
pan></font></div><div><font color=3D"#ff0000"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">#endif</span></font></div><div><font color=3D"#ff0000"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">#endif /* MTK_AB_OTA_UPDATER */</span></font=
></div><div><font color=3D"#ff0000"><br></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">if (!has_set_p2u) {</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">#ifdef USER_BUILD</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">cmdline_append("printk.disable_uart=3D=
1");</span></font></div><div><font color=3D"#ff0000"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">#else</span></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">cmdli=
ne_append(" printk.disable_uart=3D0 ddebug_query=3D\"file *mediat=
ek* +p ; file *gpu* =3D_\"");</span></font></div><div><font color=
=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></div><=
div><font color=3D"#ff0000"><br></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">/*Append pre-loader boot time to kernel command line*/</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span=
></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">pl_t =3D g_boot_arg-&gt;boot_tim=
e;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">snprintf(tmpbuf, TMPB=
UF_SIZE, "%s%d", "bootprof.pl_t=3D", pl_t);</span></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">cmdline_append(tmpbuf);</span></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">/*Append lk boot time to kernel command line*/=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">lk_t =3D ((unsigned int=
)get_timer(boot_time));</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
snprintf(tmpbuf, TMPBUF_SIZE, "%s%d", "bootprof.lk_t=3D", lk_t);<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">cmdline_append(tmpbuf);<=
/span></font></div><div><font color=3D"#ff0000"><br></font></div>=
<div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef LK_P=
ROFILING</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICA=
L,"[PROFILE] ------- boot_time takes %d ms -------- \n", lk_t);</=
span></font></div><div><font color=3D"#ff0000"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">#endif</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">/*Append pre-loader boot reason to=
 kernel command line*/</span></font></div><div><font color=3D"#ff=
0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">#ifdef MTK_KERNEL_POWER_OFF_CHARGI=
NG</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">if (g_boot_reason_chan=
ge) {</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">boot_reason =3D 4;=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">} else</span></font></di=
v><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">{</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">boot_reason =3D g_boot_arg-&gt;boot_reason;</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">snprintf(tmpbuf, TMPBUF_SIZE, "%s%d", "boot_reason=3D=
", boot_reason);</span></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">cmdline_=
append(tmpbuf);</span></font></div><div><font color=3D"#ff0000"><=
br></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">/* Append androidboot.serial=
no=3Dxxxxyyyyzzzz in cmdline */</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">snprintf(tmpbuf, TMPBUF_SIZE, "%s%s", "androidboot.serialn=
o=3D", sn_buf);</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">cmdline_a=
ppend(tmpbuf);</span></font></div><div><font color=3D"#ff0000"><b=
r></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">snprintf(tmpbuf, TMPBUF_SIZE,=
 "%s%s", &nbsp;"androidboot.bootreason=3D", g_boot_reason[boot_re=
ason]);</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">cmdline_append(tm=
pbuf);</span></font></div><div><font color=3D"#ff0000"><br></font=
></div><div><font color=3D"#ff0000"><br></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">extern unsigned int *target_commandline_force_gpt(char *=
cmd)__attribute__((weak));</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">if (target_commandline_force_gpt) {</span></font></div><div><fo=
nt color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whit=
e-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">target_commandline_force_gpt((char *)cmdline_get())=
;</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><d=
iv><font color=3D"#ff0000"><br></font></div><div><font color=3D"#=
ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
extern void ccci_append_tel_fo_setting(char *cmdline)__attribute_=
_((weak));</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (ccci_appen=
d_tel_fo_setting) {</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ccci=
_append_tel_fo_setting((char *)cmdline_get());</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#f=
f0000"><br></font></div><div><font color=3D"#ff0000"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">#ifndef USER_BUILD</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">cmdline_append("initcall_debug=3D1");</span></font></div><=
div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span=
></font></div><div><font color=3D"#ff0000"><br></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">extern int dfd_set_base_addr(void *fdt)__attribut=
e__((weak));</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (dfd_set_=
base_addr) {</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D dfd=
_set_base_addr(fdt);</span></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if=20=
(ret) {</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICA=
L,"[DFD] failed to get base address (%d)\n", ret);</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">}</span></font></div><div><font color=3D"#ff0000"><br></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">extern unsigned int get_usb2jtag(void) _=
_attribute__((weak));</span></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ext=
ern unsigned int set_usb2jtag(unsigned int en) &nbsp;__attribute_=
_((weak));</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (get_usb2jt=
ag) {</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (get_usb2jtag()=
 =3D=3D 1)</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">cmdline_appe=
nd("usb2jtag_mode=3D1");</span></font></div><div><font color=3D"#=
ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>else</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">			</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">cmdline_append("u=
sb2jtag_mode=3D0");</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</sp=
an></font></div><div><font color=3D"#ff0000"><br></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">check_hibernation();</span></font></div><div><f=
ont color=3D"#ff0000"><br></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">/*DTS=
 memory will be modified during lk boot process</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);"> * so we need to put the cmdline in the la=
st mile*/</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">mrdump_append_c=
mdline();</span></font></div><div><font color=3D"#ff0000"><br></f=
ont></div><div><font color=3D"#ff0000"><br></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">ptr =3D (char *)target_atag_commmandline((unsigned *)=
buf, (char *)cmdline_get());</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">ret =3D fdt_setprop(fdt, offset, "atag,cmdline", buf, ptr - buf=
);</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret) return FALSE;=
</span></font></div><div><font color=3D"#ff0000"><br></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">ret =3D fdt_setprop_string(fdt, offset, "bo=
otargs", (char *)cmdline_get());</span></font></div><div><font co=
lor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spa=
ce:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">if (ret) return FALSE;</span></font></div><div><font colo=
r=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern int *t=
arget_fdt_firmware(void *fdt, char *serialno)__attribute__((weak)=
);</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">if (target_fdt_firmwar=
e) {</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">target_fdt_firmware(f=
dt, sn_buf);</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></fo=
nt></div><div><font color=3D"#ff0000"><br></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">/* This depends on target_fdt_firmware, must after tar=
get_fdt_firmware */</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">exter=
n int update_md_opt_to_fdt_firmware(void *fdt)__attribute__((weak=
));</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">if (update_md_opt_to_f=
dt_firmware) {</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">update_md=
_opt_to_fdt_firmware(fdt);</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">}</span></font></div><div><font color=3D"#ff0000"><br></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">ret =3D fdt_pack(fdt);</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">if (ret) return FALSE;</span></font></div>=
<div><font color=3D"#ff0000"><br></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">dprintf(CRITICAL,"booting linux @ %p, ramdisk @ %p (%d)\n",</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);"> &nbsp; &nbsp; &nbsp; &nbsp;=
kernel, ramdisk, ramdisk_size);</span></font></div><div><font col=
or=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (strcmp(&=
amp;buf[FDT_BUFF_SIZE], FDT_BUFF_PATTERN) !=3D 0) {</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"ERROR: fdt buff ove=
rflow\n");</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">return FALSE;=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><di=
v><font color=3D"#ff0000"><br></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">e=
nter_critical_section();</span></font></div><div><font color=3D"#=
ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
/* do any platform specific cleanup before kernel entry */</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">platform_uninit();</span></font=
></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifd=
ef HAVE_CACHE_PL310</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">l2_di=
sable();</span></font></div><div><font color=3D"#ff0000"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">#endif</span></font></div><div><font color=3D"#f=
f0000"><br></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">arch_disable_cache(UCA=
CHE);</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">arch_disable_mmu();</=
span></font></div><div><font color=3D"#ff0000"><br></font></div><=
div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifndef MACH=
_FPGA</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">extern void platform_=
sec_post_init(void)__attribute__((weak));</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">if (platform_sec_post_init) {</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">platform_sec_post_init();</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"=
#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></div><div>=
<font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0=
000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">#ifdef MTK_KERNEL_POWER_OFF_CHARGIN=
G</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">/*Prevent the system ju=
mps to Kernel if we unplugged Charger/USB before*/</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">if (kernel_charging_boot() =3D=3D -1) {=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"[%s]=20=
Unplugged Usb/Charger in Kernel Charging Mode Before Jumping to K=
ernel, Power Off\n", __func__);</span></font></div><div><font col=
or=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">#ifndef NO_POWER_OFF</spa=
n></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">mt6575_power_off();</span></=
font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
#endif</span></font></div><div><font color=3D"#ff0000"><br></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">}</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">if (kernel_charging_boot() =3D=3D 1) {</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">if (pmic_detect_powerkey()) {</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">dprintf(CRITICAL,"[%s] PowerKey Pressed=20=
in Kernel Charging Mode Before Jumping to Kernel, Reboot Os\n", _=
_func__);</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">//mt65xx_back=
light_off();</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">//mt_disp_=
power(0);</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">mtk_arch_rese=
t(1);</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"=
#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></div><div>=
<font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if=20=
(clear_rtc_aldom_flag) {</span></font></div><div><font color=3D"#=
ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>if (clear_rtc_aldom_flag()) {</span></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">dprintf(CRITICAL,"clear RTC AL_DOM flag for kernel panic/=
restart/aee\n");</span></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><fon=
t color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf=
(CRITICAL,"DRAM Rank :%d\n", g_nr_bank);</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">for (i =3D 0; i &lt; g_nr_bank; i++) {</span></fo=
nt></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#i=
fndef MTK_LM_MODE</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprint=
f(CRITICAL,"DRAM Rank[%d] Start =3D 0x%x, Size =3D 0x%x\n", i, (u=
nsigned int)bi_dram[i].start, (unsigned int)bi_dram[i].size);</sp=
an></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">#else</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICA=
L,"DRAM Rank[%d] Start =3D 0x%llx, Size =3D 0x%llx\n", i, bi_dram=
[i].start, bi_dram[i].size);</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000=
"><br></font></div><div><font color=3D"#ff0000"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">#ifdef MBLOCK_LIB_SUPPORT</span></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">mblock_show_info();</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></div><div=
><font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff=
0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dp=
rintf(CRITICAL,"cmdline: %s\n", (char *)cmdline_get());</span></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"lk boot time =3D=
 %d ms\n", lk_t);</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf=
(CRITICAL,"lk boot mode =3D %d\n", g_boot_mode);</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">dprintf(CRITICAL,"lk boot reason =3D %s\n=
", g_boot_reason[boot_reason]);</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">dprintf(CRITICAL,"lk finished --&gt; jump to linux kernel=20=
%s\n\n", g_is_64bit_kernel ? "64Bit" : "32Bit");</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">if (Debug_log_EMI_MPU)</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">Debug_log_EMI_MPU();</span></font></div><d=
iv><font color=3D"#ff0000"><br></font></div><div><font color=3D"#=
ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
if (g_is_64bit_kernel) {</span></font></div><div><font color=3D"#=
ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>lk_jump64((u32)entry, (u32)tags, 0, KERNEL_64BITS);</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">} else {</span></font></div><div><fon=
t color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef MTK_SMC_K32_SU=
PPORT</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">lk_jump64((u32)ent=
ry, (u32)machtype, (u32)tags, KERNEL_32BITS);</span></font></div>=
<div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#else</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">entry(0, machtype, tags);</sp=
an></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">#endif</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">while (1);</span></font></div><div><fo=
nt color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whit=
e-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">return 0;</span></font></div><div><font color=3D"#ff=
0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font co=
lor=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><br=
></font></div><div><font color=3D"#ff0000"><br></font></div><div>=
<font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif // DEVICE=
_TREE_SUPPORT</span></font></div><div><font color=3D"#ff0000"><br=
></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">void boot_linux(void *kernel, unsigned *tags,</span></font></d=
iv><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">&nbsp; &=
nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unsigned machtype=
,</span></font></div><div><font color=3D"#ff0000"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 void *ramdisk, unsigned ramdisk_size)</span></font></div><div><f=
ont color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">{</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">int i;</span></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">unsigned *ptr =3D tags;</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">void (*entry)(unsigned,unsigned,unsigned*) =3D kernel;</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span=
></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">unsigned int lk_t =3D 0;</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span=
></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">unsigned int pl_t =3D 0;</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span=
></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">unsigned int boot_reason =3D 0;<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">int ret =3D 0;</span></fo=
nt></div><div><font color=3D"#ff0000"><br></font></div><div><font=
 color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#define TMPBUF_SIZE 1=
28</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">char tmpbuf[TMPBUF_SIZ=
E];</span></font></div><div><font color=3D"#ff0000"><br></font></=
div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef=20=
DEVICE_TREE_SUPPORT</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">boot_=
linux_fdt((void *)kernel, (unsigned *)tags,</span></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; machtype,</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"> &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (void *)ramdisk, ramdisk_si=
ze);</span></font></div><div><font color=3D"#ff0000"><br></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">while (1) ;</span></font></div><div><fo=
nt color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font><=
/div><div><font color=3D"#ff0000"><br></font></div><div><font col=
or=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef MTK_SECURITY_ANTI_=
ROLLBACK</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D sec_otp_=
ver_update();</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">imgver_not_=
sync_warning(g_boot_arg-&gt;pl_imgver_status,ret);</span></font><=
/div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif=
</span></font></div><div><font color=3D"#ff0000"><br></font></div=
><div><font color=3D"#ff0000"><br></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">/* CORE */</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">*ptr++ =3D 2=
;</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">*ptr++ =3D 0x54410001;<=
/span></font></div><div><font color=3D"#ff0000"><br></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">ptr =3D target_atag_boot(ptr);</span></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">ptr =3D target_atag_mem(ptr);</span></fo=
nt></div><div><font color=3D"#ff0000"><br></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">if (target_atag_partition_data) {</span></font></div><=
div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">ptr =3D target_atag_partition_data(ptr);</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><fon=
t color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#if !(defined(MTK_UFS=
_BOOTING) || defined(MTK_EMMC_SUPPORT))</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">if (target_atag_nand_data) {</span></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">ptr =3D target_atag_nand_data(ptr);</span></fo=
nt></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-sp=
an" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font col=
or=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">//some platform might not have this functio=
n, use weak reference for</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>extern unsigned *target_atag_dfo(unsigned *ptr)__attribute__((we=
ak));</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">if (target_atag_dfo)=20=
{</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D target_atag_df=
o(ptr);</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></=
div><div><font color=3D"#ff0000"><br></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">if (g_boot_mode =3D=3D META_BOOT || g_boot_mode =3D=3D ADVM=
ETA_BOOT || g_boot_mode =3D=3D ATE_FACTORY_BOOT || g_boot_mode =3D=
=3D FACTORY_BOOT) {</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ptr=20=
=3D target_atag_meta(ptr);</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">cmdline_append("rdinit=3Dsbin/multi_init");</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">unsigned int meta_com_id =3D g_boot_arg-&g=
t;meta_com_id;</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if ((meta=
_com_id &amp; 0x0001) !=3D 0) {</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">cmdline_append("androidboot.usbconfig=3D1");</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">} else {</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">cmdline_append("androidboot.usbconfig=3D0");</spa=
n></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">if (g_boot_mode =3D=3D META_BOOT) {</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">if ((meta_com_id &amp; 0x0002) !=3D 0=
) {</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">				</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">cmdline_append("andro=
idboot.mblogenable=3D0");</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">} else {</span></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">				</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">cmdline_ap=
pend("androidboot.mblogenable=3D1");</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font=
 color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D=20=
target_atag_devinfo_data(ptr);</span></font></div><div><font colo=
r=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">/*Append pre-=
loader boot time to kernel command line*/</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">pl_t =3D g_boot_arg-&gt;boot_time;</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">snprintf(tmpbuf, TMPBUF_SIZE, "%s%d",=20=
"bootprof.pl_t=3D", pl_t);</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">cmdline_append(tmpbuf);</span></font></div><div><font color=3D"=
#ff0000"><br></font></div><div><font color=3D"#ff0000"><span clas=
s=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">/*Append lk boot t=
ime to kernel command line*/</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">lk_t =3D ((unsigned int)get_timer(boot_time));</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">snprintf(tmpbuf, TMPBUF_SIZE, "%s%d", "bo=
otprof.lk_t=3D", lk_t);</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">c=
mdline_append(tmpbuf);</span></font></div><div><font color=3D"#ff=
0000"><br></font></div><div><font color=3D"#ff0000"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">#ifdef LK_PROFILING</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">printf("[PROFILE] ------- boot_time takes %d ms -------- \=
n", lk_t);</span></font></div><div><font color=3D"#ff0000"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">#endif</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>if (!has_set_p2u) {</span></font></div><div><font color=3D"#ff00=
00"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">#ifdef USER_BUILD</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">cmdline_append("printk.disable_uart=3D1");=
</span></font></div><div><font color=3D"#ff0000"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">#else</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">cmdline_a=
ppend(" printk.disable_uart=3D0 ddebug_query=3D\"file *mediatek*=20=
+p ; file *gpu* =3D_\"");</span></font></div><div><font color=3D"=
#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">/*Appen=
d pre-loader boot reason to kernel command line*/</span></font></=
div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef=20=
MTK_KERNEL_POWER_OFF_CHARGING</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">if (g_boot_reason_change) {</span></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">boot_reason =3D 4;</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>} else</span></font></div><div><font color=3D"#ff0000"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">#endif</span></font></div><div><font color=3D"#ff=
0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">{<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">boot_reason =3D g_boot_a=
rg-&gt;boot_reason;</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">snprintf(tmpbuf, TMPBUF_SIZE=
, "%s%d", "boot_reason=3D", boot_reason);</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">cmdline_append(tmpbuf);</span></font></div><div>=
<font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">/*=20=
Append androidboot.serialno=3Dxxxxyyyyzzzz in cmdline */</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span>=
</span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">snprintf(tmpbuf, TMPBUF_SIZE, "%s=
%s", "androidboot.serialno=3D", sn_buf);</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">cmdline_append(tmpbuf);</span></font></div><div><=
font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">snpr=
intf(tmpbuf, TMPBUF_SIZE, "%s%s", &nbsp;"androidboot.bootreason=3D=
", g_boot_reason[boot_reason]);</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">cmdline_append(tmpbuf);</span></font></div><div><font colo=
r=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">check_hiberna=
tion();</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D target_at=
ag_commmandline(ptr, (char *)cmdline_get());</span></font></div><=
div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">ptr =3D target_atag_initrd(ptr,(unsigned long)=20=
ramdisk, ramdisk_size);</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">p=
tr =3D target_atag_videolfb(ptr);</span></font></div><div><font c=
olor=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">extern uns=
igned int *target_atag_mdinfo(unsigned *ptr)__attribute__((weak))=
;</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">if (target_atag_mdinfo)=
 {</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">ptr =3D target_atag_m=
dinfo(ptr);</span></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">} else {</spa=
n></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"DFO_MODEN_=
INFO Only support in MT6582/MT6592\n");</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000">=
<br></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">extern unsigned int *target=
_atag_masp_data(unsigned *ptr)__attribute__((weak));</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">if (target_atag_masp_data) {</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span=
></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">ptr =3D (char *)target_atag_masp=
_data((unsigned *)ptr);</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}=
 else {</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL=
,"masp atag not support in this platform\n");</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff00=
00"><br></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">/* END */</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">*ptr++ =3D 0;</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">*ptr++ =3D 0;</span></font></div><div><font color=
=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">#if 0</span></font></div><div><font color=3D"#=
ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
dprintf(CRITICAL,"atag start:0x%08X, end:0x%08X\n", tags, ptr);</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">for (unsigned int*scan=3Dt=
ags, i=3D0; scan!=3Dptr; scan++, i++) {</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">dprintf(CRITICAL,"0x%08X%c", *scan, (i%4=3D=3D0)?=
'\n':'\t');</span></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"\n");</span></font=
></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#end=
if</span></font></div><div><font color=3D"#ff0000"><br></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">dprintf(CRITICAL,"booting linux @ %p, ram=
disk @ %p (%d)\n",</span></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"> &nbsp=
; &nbsp; &nbsp; &nbsp;kernel, ramdisk, ramdisk_size);</span></fon=
t></div><div><font color=3D"#ff0000"><br></font></div><div><font=20=
color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-s=
pace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">enter_critical_section();</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">/* do any platform specific cleanup before kernel entr=
y */</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">platform_uninit();</sp=
an></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">#ifdef HAVE_CACHE_PL310</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">l2_disable();</span></font></div><div><font color=3D"#ff0000"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">#endif</span></font></div><div><font colo=
r=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">arch_disable_=
cache(UCACHE);</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">arch_disab=
le_mmu();</span></font></div><div><font color=3D"#ff0000"><br></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">extern void platform_sec_post_init=
(void)__attribute__((weak));</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">if (platform_sec_post_init) {</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">platform_sec_post_init();</span></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><br></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span>=
</span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">arch_uninit();</span></font></div=
><div><font color=3D"#ff0000"><br></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">#ifdef MTK_KERNEL_POWER_OFF_CH=
ARGING</span></font></div><div><font color=3D"#ff0000"><span clas=
s=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">/*Prevent the syst=
em jumps to Kernel if we unplugged Charger/USB before*/</span></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">if (kernel_charging_boot() =3D=3D=20=
-1) {</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"=
[%s] Unplugged Usb/Charger in Kernel Charging Mode Before Jumping=
 to Kernel, Power Off\n", __func__);</span></font></div><div><fon=
t color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifndef NO_POWER_OFF<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">mt6575_power_off();</spa=
n></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">#endif</span></font></div><div><font color=3D"#ff0000"><br></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font co=
lor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spa=
ce:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">if (kernel_charging_boot() =3D=3D 1) {</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">if (pmic_detect_powerkey()) {</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"[%s] PowerKey Pre=
ssed in Kernel Charging Mode Before Jumping to Kernel, Reboot Os\=
n", __func__);</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">//mt65xx=
_backlight_off();</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">//mt_=
disp_power(0);</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">mtk_arch=
_reset(1);</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">}</span></font></div><div><font colo=
r=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">dprintf(CRITICAL,"DRAM Rank :%d\n", g_nr_bank)=
;</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">for (i =3D 0; i &lt; g_=
nr_bank; i++) {</span></font></div><div><font color=3D"#ff0000"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">#ifndef MTK_LM_MODE</span></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">dprintf(CRITICAL,"DRAM Rank[%d] Start =3D 0x%x=
, Size =3D 0x%x\n", i, (unsigned int)bi_dram[i].start, (unsigned=20=
int)bi_dram[i].size);</span></font></div><div><font color=3D"#ff0=
000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">#else</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">dprintf(CRITICAL,"DRAM Rank[%d] Start =3D 0x%llx, Siz=
e =3D 0x%llx\n", i, bi_dram[i].start, bi_dram[i].size);</span></f=
ont></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#=
endif</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div>=
<div><font color=3D"#ff0000"><br></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">#ifdef MBLOCK_LIB_SUPPORT</spa=
n></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">mblock_show_info();</span></f=
ont></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#=
endif</span></font></div><div><font color=3D"#ff0000"><br></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"cmdline: %s\n", (cha=
r *)cmdline_get());</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprin=
tf(CRITICAL,"lk boot time =3D %d ms\n", lk_t);</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">dprintf(CRITICAL,"lk boot mode =3D %d\n", g=
_boot_mode);</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRIT=
ICAL,"lk boot reason =3D %s\n", g_boot_reason[boot_reason]);</spa=
n></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"lk finished=
 --&gt; jump to linux kernel\n\n");</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">entry(0, machtype, tags);</span></font></div><div><fon=
t color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div>=
<div><font color=3D"#ff0000"><br></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">#ifdef MTK_AB_OTA_UPDATER</spa=
n></font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">static void load_bootimg_by_suffix(void)</span></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">{</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">int ret;</span></font></div><div><fo=
nt color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whit=
e-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">unsigned int kimg_load_addr;</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">char bootimg_name[16];</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">int is_normal_boot;</span></font></div><div><font=20=
color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">#if defined(CFG_NAND_B=
OOT)</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">char cmdline_tmpbuf[10=
0];</span></font></div><div><font color=3D"#ff0000"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">#endif</span></font></div><div><font color=3D"#ff0000=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">#ifdef LK_PROFILING</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">unsigned int time_load_bootimg =3D get_time=
r(0);</span></font></div><div><font color=3D"#ff0000"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">#endif</span></font></div><div><font color=3D"#ff00=
00"><br></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">/* set normal mode when=
 retry count &gt; 0 */</span></font></div><div><font color=3D"#ff=
0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if=
 (AB_retry_count &gt; 0) {</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">switch (g_boot_mode) {</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">case NORMAL_BOOT:</span></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ca=
se ALARM_BOOT:</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">				</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">is_norm=
al_boot =3D 1;</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">				</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">break;<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">case META_BOOT:</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">case ADVMETA_BOOT:</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">case SW_REBOOT:</span></font></div=
><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef MTK=
_KERNEL_POWER_OFF_CHARGING</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">case KERNEL_POWER_OFF_CHARGING_BOOT:</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">case LOW_POWER_OFF_CHARGING_BOOT:</span></font><=
/div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif=
</span></font></div><div><font color=3D"#ff0000"><span class=3D"A=
pple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">case FACTORY_BOOT:</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">case ATE_FACTORY_BOOT:</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">case RECOVERY_BOOT:</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">case FASTBOOT:</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">case DOWNLOAD_BOOT:</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">case UNKNOWN_BOOT:</span></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">default:</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">				</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">is_normal_boot =3D 0;</span></font></div><div><font color=3D"#=
ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">				</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">break;</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font=
></div><div><font color=3D"#ff0000"><br></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">ret =3D set_normal_boot(p_AB_suffix, is_normal_boot);</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL, "[%s:%d=
] set_normal_boot(%s, %d): %d\n", __func__, __LINE__, p_AB_suffix=
, is_normal_boot, ret);</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}=
</span></font></div><div><font color=3D"#ff0000"><br></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">/* load bootimg with suffix: boot_a or boot=
_b */</span></font></div><div><font color=3D"#ff0000"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">#ifdef MTK_GPT_SCHEME_SUPPORT</span></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">snprintf(bootimg_name, sizeof(bootimg_name), "b=
oot%s", p_AB_suffix);</span></font></div><div><font color=3D"#ff0=
000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">#else</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">snprintf(bootimg_name, sizeof(bootimg_name), "%s%s", P=
ART_BOOTIMG, p_AB_suffix);</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></div><div=
><font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff=
0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dp=
rintf(INFO, "[%s:%d] bootimg_name: %s\n", __func__, __LINE__, boo=
timg_name);</span></font></div><div><font color=3D"#ff0000"><br><=
/font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>#if defined(CFG_NAND_BOOT)</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">snprintf(cmdline_tmpbuf, sizeof(cmdline_tmpbuf), "%s%x%s%x", NA=
ND_MANF_CMDLINE, nand_flash_man_code, NAND_DEV_CMDLINE, nand_flas=
h_dev_id);</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">cmdline_append=
(cmdline_tmpbuf);</span></font></div><div><font color=3D"#ff0000"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">#endif</span></font></div><div><font co=
lor=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D mbo=
ot_android_load_bootimg_hdr(bootimg_name, CFG_BOOTIMG_LOAD_ADDR);=
</span></font></div><div><font color=3D"#ff0000"><br></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">if (ret &lt; 0) {</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">msg_header_error("Android Boot Image");</span></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font co=
lor=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (g_is_64=
bit_kernel) {</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">kimg_load_=
addr =3D (unsigned int)target_get_scratch_address();</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">} else {</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">kimg_load_addr =3D (g_boot_hdr!=3DNULL) ? g_boot_hdr=
-&gt;kernel_addr : CFG_BOOTIMG_LOAD_ADDR;</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000=
"><br></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D mboot_android_loa=
d_bootimg(bootimg_name, kimg_load_addr);</span></font></div><div>=
<font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if=20=
(ret &lt; 0) {</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">msg_img_e=
rror("Android Boot Image");</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">}</span></font></div><div><font color=3D"#ff0000"><br></font></=
div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef=20=
LK_PROFILING</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRIT=
ICAL,"[PROFILE] ------- load %s takes %d ms -------- \n", bootimg=
_name, (int)get_timer(time_load_bootimg));</span></font></div><di=
v><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span><=
/font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>}</span></font></div><div><font color=3D"#ff0000"><br></font></d=
iv><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">void get=
_AB_OTA_param(void)</span></font></div><div><font color=3D"#ff000=
0"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">{</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">p_AB_suffix =3D get_suffix();</span></font></div><div><font co=
lor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spa=
ce:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">AB_retry_count =3D get_retry_count(p_AB_suffix);</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span>=
</span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL, "[%s:%d] p_AB_s=
uffix: %s, AB_retry_count: %d\n", __func__, __LINE__, p_AB_suffix=
, AB_retry_count);</span></font></div><div><font color=3D"#ff0000=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">#endif /* MTK_AB_OTA_UPDATER *=
/</span></font></div><div><font color=3D"#ff0000"><br></font></di=
v><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">int boot_=
linux_from_storage(void)</span></font></div><div><font color=3D"#=
ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">{</span></font></div><div><font=20=
color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-s=
pace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">int ret=3D0;</span></font></div><div><font color=3D"#ff=
0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">#define CMDLINE_TMP_CONCAT_SIZE 10=
0 &nbsp; &nbsp; //only for string concat, 200 bytes is enough</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">char cmdline_tmpbuf[CMDLINE_=
TMP_CONCAT_SIZE];</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">unsigne=
d int kimg_load_addr;</span></font></div><div><font color=3D"#ff0=
000"><br></font></div><div><font color=3D"#ff0000"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">#ifdef LK_PROFILING</span></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">unsigned int time_load_recovery=3D0;</span></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">unsigned int time_load_bootimg=3D0;</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">unsigned int time_load_factory=3D0;<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">time_load_recovery =3D ge=
t_timer(0);</span></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">time_load_boo=
timg =3D get_timer(0);</span></font></div><div><font color=3D"#ff=
0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">#endif</span></font></div><div><fo=
nt color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000=
"><br></font></div><div><font color=3D"#ff0000"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">#ifdef MTK_AB_OTA_UPDATER</span></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">load_bootimg_by_suffix();</span></font></div><div><font=20=
color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">#else</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">switch (g_boot_mode) {</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">case NORMAL_BOOT:</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">case META_BOOT:</span></font></div><div><font co=
lor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spa=
ce:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">case ADVMETA_BOOT:</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">case SW_REBOOT:</span></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">case=20=
ALARM_BOOT:</span></font></div><div><font color=3D"#ff0000"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">#ifdef MTK_KERNEL_POWER_OFF_CHARGING</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span=
></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">case KERNEL_POWER_OFF_CHARGING_B=
OOT:</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">case LOW_POWER_OFF_CH=
ARGING_BOOT:</span></font></div><div><font color=3D"#ff0000"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">#endif</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">#if defined(CFG_NAND_BOOT)</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">snprintf(cmdline_tmpbuf, C=
MDLINE_TMP_CONCAT_SIZE, "%s%x%s%x",</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);"> &nbsp; &nbsp; &nbsp; &nbsp; NAND_MANF_CMDLINE, nand=
_flash_man_code, NAND_DEV_CMDLINE, nand_flash_dev_id);</span></fo=
nt></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-sp=
an" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span>=
</span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">cmdline_append(cmdline_tmpbuf);</=
span></font></div><div><font color=3D"#ff0000"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">#endif</span></font></div><div><font color=3D"#ff0000"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">#ifdef MTK_GPT_SCHEME_SUPPORT</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">ret =3D mboot_android_load_bootimg_h=
dr("boot", CFG_BOOTIMG_LOAD_ADDR);</span></font></div><div><font=20=
color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">#else</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">ret =3D mboot_android_load_bootimg_hdr(=
PART_BOOTIMG, CFG_BOOTIMG_LOAD_ADDR);</span></font></div><div><fo=
nt color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">if (ret &lt; 0) {</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">				</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">msg_header_error("Android Boot Image");</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div>=
<font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">i=
f (g_is_64bit_kernel) {</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">				</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">kimg_load_addr =3D (unsigned int)target_get_scratch_address();<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">} else {</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">				</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">kimg_load_addr =3D (g_boot_hdr!=3DNU=
LL) ? g_boot_hdr-&gt;kernel_addr : CFG_BOOTIMG_LOAD_ADDR;</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><fon=
t color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">#ifdef MTK_GPT_SCHEME_SUPPORT</span></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span=
></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">ret =3D mboot_android_load_booti=
mg("boot", kimg_load_addr);</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">#else</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">ret =3D mboot_android_load_bootimg(PART_BOOTIMG=
, kimg_load_addr);</span></font></div><div><font color=3D"#ff0000=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">#endif</span></font></div><div><font c=
olor=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret=20=
&lt; 0) {</span></font></div><div><font color=3D"#ff0000"><span c=
lass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">				</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">msg_img_erro=
r("Android Boot Image");</span></font></div><div><font color=3D"#=
ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">}</span></font></div><div><font color=3D"#ff0000"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">#ifdef LK_PROFILING</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">dprintf(CRITICAL,"[PROFILE] ------- load boot.img takes=20=
%d ms -------- \n", (int)get_timer(time_load_bootimg));</span></f=
ont></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#=
endif</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">			</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">break;</span></fo=
nt></div><div><font color=3D"#ff0000"><br></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">case RECOVERY_BOOT:</span></font></div><div><font col=
or=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef MTK_GPT_SCHEME_SUP=
PORT</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D mboot_android=
_load_recoveryimg_hdr("recovery", CFG_BOOTIMG_LOAD_ADDR);</span><=
/font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>#else</span></font></div><div><font color=3D"#ff0000"><span clas=
s=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">			</span></span><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D mboot_an=
droid_load_recoveryimg_hdr(PART_RECOVERY, CFG_BOOTIMG_LOAD_ADDR);=
</span></font></div><div><font color=3D"#ff0000"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">#endif</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (ret=
 &lt; 0) {</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">				</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">msg_header_=
error("Android Recovery Image");</span></font></div><div><font co=
lor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spa=
ce:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><br><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">if (g_is_64bit_kernel) {</span=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">				<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">kimg_load_addr =3D &nbsp;(u=
nsigned int)target_get_scratch_address();</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">} else {</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">				</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">kimg_load_addr =3D (g_boot_hdr!=3DNULL) ? g_boot_hdr-&gt;kerne=
l_addr : CFG_BOOTIMG_LOAD_ADDR;</span></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><br></=
font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
#ifdef MTK_GPT_SCHEME_SUPPORT</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">ret =3D mboot_android_load_recoveryimg("recovery", kimg_lo=
ad_addr);</span></font></div><div><font color=3D"#ff0000"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">#else</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>ret =3D mboot_android_load_recoveryimg(PART_RECOVERY, kimg_load_=
addr);</span></font></div><div><font color=3D"#ff0000"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">#endif</span></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">i=
f (ret &lt; 0) {</span></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">				</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">msg_i=
mg_error("Android Recovery Image");</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">#ifdef LK_PROFILING</span></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">dprintf(CRITICAL,"[PROFILE] ------- load reco=
very.img takes %d ms -------- \n", (int)get_timer(time_load_recov=
ery));</span></font></div><div><font color=3D"#ff0000"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">#endif</span></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">b=
reak;</span></font></div><div><font color=3D"#ff0000"><br></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">case FACTORY_BOOT:</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">case ATE_FACTORY_BOOT:</span></font></div>=
<div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#if defined=
(CFG_NAND_BOOT)</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">snprint=
f(cmdline_tmpbuf, CMDLINE_TMP_CONCAT_SIZE, "%s%x%s%x",</span></fo=
nt></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-sp=
an" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span>=
</span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);"> &nbsp; &nbsp; &nbsp; &nbsp; NAND=
_MANF_CMDLINE, nand_flash_man_code, NAND_DEV_CMDLINE, nand_flash_=
dev_id);</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">cmdline_append=
(cmdline_tmpbuf);</span></font></div><div><font color=3D"#ff0000"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">#endif</span></font></div><div><font co=
lor=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">#ifdef MTK_GPT_SCHEME_SUPPORT</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></s=
pan><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">ret =3D mboot_android_load_bootimg_h=
dr("boot", CFG_BOOTIMG_LOAD_ADDR);</span></font></div><div><font=20=
color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">#else</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">ret =3D mboot_android_load_bootimg_hdr(=
PART_BOOTIMG, CFG_BOOTIMG_LOAD_ADDR);</span></font></div><div><fo=
nt color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">if (ret &lt; 0) {</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">				</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">msg_header_error("Android Boot Image");</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div>=
<font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">i=
f (g_is_64bit_kernel) {</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">				</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">kimg_load_addr =3D &nbsp;(unsigned int)target_get_scratch_addre=
ss();</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">			</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">} else {</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">				</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">kimg_load_addr =3D (g_boot_hdr=
!=3DNULL) ? g_boot_hdr-&gt;kernel_addr : CFG_BOOTIMG_LOAD_ADDR;</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=09=
		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><di=
v><font color=3D"#ff0000"><br></font></div><div><font color=3D"#f=
f0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">#ifdef MTK_GPT_SCHEME_SUPPORT</sp=
an></font></div><div><font color=3D"#ff0000"><span class=3D"Apple=
-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">ret =3D mboot_android_load=
_bootimg("boot", kimg_load_addr);</span></font></div><div><font c=
olor=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">#else</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">ret =3D mboot_android_load_bootimg(PART_=
BOOTIMG, kimg_load_addr);</span></font></div><div><font color=3D"=
#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">if (ret &lt; 0) {</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">				</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">msg_img_error("Android Boot Image");</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">}</span></font></div><div><font color=
=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">#ifdef LK_PROFILING</span><=
/font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab=
-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-=
span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">dprintf(CRITICAL,"[PROFILE] --=
----- load factory.img takes %d ms -------- \n", (int)get_timer(t=
ime_load_factory));</span></font></div><div><font color=3D"#ff000=
0"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">#endif</span></font></div><div><font=20=
color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-s=
pace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">			</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">break;</span></font></div><div><font color=3D"#ff0000=
"><br></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">case FASTBOOT:</span></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span>=
</span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">case DOWNLOAD_BOOT:</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">case UNKNOWN_BOOT:</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">break;</span></font></div><div><font colo=
r=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></fon=
t></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#en=
dif /* MTK_AB_OTA_UPDATER */</span></font></div><div><font color=3D=
"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">#ifndef SKIP_LOADING_RAMDISK</span></font></div><=
div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">if (g_rimg_sz =3D=3D 0) {</span></font></div><d=
iv><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">if (g_boot_hdr !=3D NULL) {</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">g_rimg_sz =3D g_boot_hdr-&gt;ramdisk_size=
;</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><=
div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff000=
0"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">#ifdef MTK_3LEVEL_PAGETABLE</span></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">/* rootfs addr */</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">if (g_boot_hdr !=3D NULL) {</span></font>=
</div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=
 style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">arch_mmu_map((uint64_t)g_boot_hdr-&gt=
;ramdisk_addr, (uint32_t)g_boot_hdr-&gt;ramdisk_addr,</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; MMU_MEMORY_TYPE_NORMAL_WRITE_BACK | MMU_MEMORY_AP_P_RW_U_=
NA, ROUNDUP(g_rimg_sz, PAGE_SIZE));</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0);">#endif</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">/* relocate rootfs (ignore rootfs header) */</span></font></div=
><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" styl=
e=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">memcpy((g_boot_hdr!=3DNULL) ? (char *)g_boo=
t_hdr-&gt;ramdisk_addr : (char *)CFG_RAMDISK_LOAD_ADDR, (char *)(=
g_rmem_off), g_rimg_sz);</span></font></div><div><font color=3D"#=
ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
g_rmem_off =3D (g_boot_hdr!=3DNULL) ? g_boot_hdr-&gt;ramdisk_addr=
 : CFG_RAMDISK_LOAD_ADDR;</span></font></div><div><font color=3D"=
#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></div><div>=
<font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0=
000"><br></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">// 2 weak function for=
 mt6572 memory preserved mode</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">platform_mem_preserved_load_img();</span></font></div><div><fo=
nt color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whit=
e-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">platform_mem_preserved_dump_mem();</span></font></di=
v><div><font color=3D"#ff0000"><br></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">custom_port_in_kernel(g_boot_mode, cmdline_get());</span></font=
></div><div><font color=3D"#ff0000"><br></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">if (g_boot_hdr !=3D NULL) {</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">snprintf(cmdline_tmpbuf, CMDLINE_TMP_CONCAT_SIZE, "%=
s",g_boot_hdr-&gt;cmdline);</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">cmdline_append(cmdline_tmpbuf);</span></font></div><div><font=20=
color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-s=
pace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><br><=
/font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);"=
>#ifdef SELINUX_STATUS</span></font></div><div><font color=3D"#ff=
0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">#if SELINUX_STATUS =3D=3D 1</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">cmdline_append("androidboot.sel=
inux=3Ddisabled");</span></font></div><div><font color=3D"#ff0000=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">#elif SELINUX_STATUS =3D=3D 2</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span>=
</span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">cmdline_append("androidboot.selin=
ux=3Dpermissive");</span></font></div><div><font color=3D"#ff0000=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">#endif</span></font></div><div><font c=
olor=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></d=
iv><div><font color=3D"#ff0000"><br></font></div><div><font color=
=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">#ifdef MTK_POWER_ON_WRITE_PROTECT</span></font=
></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#if=20=
MTK_POWER_ON_WRITE_PROTECT =3D=3D 1</span></font></div><div><font=
 color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#if defined(MTK_EMMC_=
SUPPORT) || defined(MTK_UFS_BOOTING)</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">write_protect_flow();</span></font></div><div><font c=
olor=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">#endif</span></font></d=
iv><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</=
span></font></div><div><font color=3D"#ff0000"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">#endif</span></font></div><div><font color=3D"#ff0000"><br=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">if (g_boot_hdr !=3D NULL) {</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">boot_linux((void *)g_boot_=
hdr-&gt;kernel_addr, (unsigned *)g_boot_hdr-&gt;tags_addr,</span>=
</font></div><div><font color=3D"#ff0000"><span class=3D"Apple-ta=
b-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);"> &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; board_machtype(), (void *)g_boot_hdr-&gt;ramdisk_addr, g_ri=
mg_sz);</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">} else {</span></=
font></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-=
span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span=
></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">boot_linux((void *)CFG_BOOTIMG_L=
OAD_ADDR, (unsigned *)CFG_BOOTARGS_ADDR,</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; board_machty=
pe(), (void *)CFG_RAMDISK_LOAD_ADDR, g_rimg_sz);</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"=
#ff0000"><br></font></div><div><font color=3D"#ff0000"><span clas=
s=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">while (1) ;</span>=
</font></div><div><font color=3D"#ff0000"><br></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">return 0;</span></font></div><div><font color=3D"#=
ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font=20=
color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">#if defined(CONFIG_MTK_USB_UNIQUE_SERIAL)=
 || (defined(MTK_SECURITY_SW_SUPPORT) &amp;&amp; defined(MTK_SEC_=
FASTBOOT_UNLOCK_SUPPORT))</span></font></div><div><font color=3D"=
#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">static char udc_chr[32] =3D {"A=
BCDEFGHIJKLMNOPQRSTUVWSYZ456789"};</span></font></div><div><font=20=
color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">int get_serial(u64 hwkey, u32 chipid, cha=
r ser[SERIALNO_LEN])</span></font></div><div><font color=3D"#ff00=
00"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">{</span></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">u16 hashkey[4];</span></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">u32=
 idx, ser_idx;</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">u32 digit,=
 id;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">u64 tmp =3D hwkey;</sp=
an></font></div><div><font color=3D"#ff0000"><br></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">memset(ser, 0x00, SERIALNO_LEN);</span></font><=
/div><div><font color=3D"#ff0000"><br></font></div><div><font col=
or=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spac=
e:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">/* split to 4 key with 16-bit width each */</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">tmp =3D hwkey;</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">for (idx =3D 0; idx &lt; ARRAY_SIZE(hashkey); idx=
++) {</span></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">hashkey[idx] =3D (=
u16)(tmp &amp; 0xffff);</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
tmp &gt;&gt;=3D 16;</span></font></div><div><font color=3D"#ff000=
0"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=
 data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; co=
lor: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</sp=
an></font></div><div><font color=3D"#ff0000"><br></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">/* hash the key with chip id */</span></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">id =3D chipid;</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">for (idx =3D 0; idx &lt; ARRAY_SIZE(hashkey); idx+=
+) {</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">digit =3D (id % 10);<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">hashkey[idx] =3D (hashke=
y[idx] &gt;&gt; digit) | (hashkey[idx] &lt;&lt; (16-digit));</spa=
n></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">id =3D (id / 10);</span></fo=
nt></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-sp=
an" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0);">}</span></font></div><div><font col=
or=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">/* generate=20=
serail using hashkey */</span></font></div><div><font color=3D"#f=
f0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><=
span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem=
; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">s=
er_idx =3D 0;</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">for (idx =3D=
 0; idx &lt; ARRAY_SIZE(hashkey); idx++) {</span></font></div><di=
v><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">ser[ser_idx++] =3D (hashkey[idx] &amp; 0x001f)=
;</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0);">ser[ser_idx++] =3D (ha=
shkey[idx] &amp; 0x00f8) &gt;&gt; 3;</span></font></div><div><fon=
t color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white=
-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">ser[ser_idx++] =3D (hashkey[idx] &amp; 0x1f00) &gt;&=
gt; 8;</span></font></div><div><font color=3D"#ff0000"><span clas=
s=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ser[ser_idx++] =3D=
 (hashkey[idx] &amp; 0xf800) &gt;&gt; 11;</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">for (i=
dx =3D 0; idx &lt; ser_idx; idx++)</span></font></div><div><font=20=
color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-s=
pace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">ser[idx] =3D udc_chr[(int)ser[idx]];</span></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">ser[ser_idx] =3D 0x00;</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0);">return 0;</span></font></div><div><font color=3D=
"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div><div><fon=
t color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif /* CONFIG_MTK_=
USB_UNIQUE_SERIAL */</span></font></div><div><font color=3D"#ff00=
00"><br></font></div><div><font color=3D"#ff0000"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">#ifdef SERIAL_NUM_FROM_BARCODE</span></font></div><div>=
<font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">static inline in=
t read_product_info(char *buf)</span></font></div><div><font colo=
r=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">{</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">int tmp =3D 0;</span></font></div><div><font colo=
r=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span=
 class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wi=
z-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb=
(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (!buf) ret=
urn 0;</span></font></div><div><font color=3D"#ff0000"><br></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">mboot_recovery_load_raw_part("proinfo=
", buf, SN_BUF_LEN);</span></font></div><div><font color=3D"#ff00=
00"><br></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">for ( ; tmp &lt; SN_BUF=
_LEN; tmp++) {</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if ( (buf=
[tmp] =3D=3D 0 || buf[tmp] =3D=3D 0x20) &amp;&amp; tmp &gt; 0) {<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">break;</span></font></d=
iv><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" st=
yle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span>=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">} else if ( !isalpha(buf[tmp]) &amp;&amp=
; !isdigit(buf[tmp]))</span></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">r=
eturn 0;</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">return tmp;</span></font></div><div><fo=
nt color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></font></div>=
<div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#endif</spa=
n></font></div><div><font color=3D"#ff0000"><br></font></div><div=
><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">#ifdef CONFIG_M=
TK_USB_UNIQUE_SERIAL</span></font></div><div><font color=3D"#ff00=
00"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0);">static inline int read_product_usbid=
(char *serialno)</span></font></div><div><font color=3D"#ff0000">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">{</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">u64 key;</span></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">u32 hrid_size,=
ser_len;</span></font></div><div><font color=3D"#ff0000"><span cl=
ass=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" sty=
le=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">u32 i,chip_code,=
errcode =3D 0;</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">char *cur_=
serialp =3D serialno;</span></font></div><div><font color=3D"#ff0=
000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">cha=
r serial_num[SERIALNO_LEN];</span></font></div><div><font color=3D=
"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">/* read machine t=
ype */</span></font></div><div><font color=3D"#ff0000"><span clas=
s=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">chip_code =3D boar=
d_machtype();</span></font></div><div><font color=3D"#ff0000"><br=
></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-t=
ab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</sp=
an></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-siz=
e: 0.867rem; color: rgb(0, 0, 0);">/* read hrid */</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">hrid_size =3D get_hrid_size();</span></=
font></div><div><font color=3D"#ff0000"><br></font></div><div><fo=
nt color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whit=
e-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">/* check ser_buf len. if need 128bit id, should defi=
ned into cust_usb.h */</span></font></div><div><font color=3D"#ff=
0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if=
(SN_BUF_LEN &nbsp;&lt; hrid_size * 8 ) {</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">hrid_size =3D 2;</span></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">errcode =3D 1;</span></font></div><div><font color=3D"#=
ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0);">	</span></span><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
}</span></font></div><div><font color=3D"#ff0000"><br></font></di=
v><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" sty=
le=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" styl=
e=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span></span><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0);">for(i =3D 0; i &lt; hrid_size/2; i++) {</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0);">key =3D get_devinfo_with_i=
ndex(13+i*2); /* 13, 15 */</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">key =3D (key &lt;&lt; 32) | (unsigned int)get_devinfo_with_ind=
ex(12+i*2); /* 12, 14 */</span></font></div><div><font color=3D"#=
ff0000"><br></font></div><div><font color=3D"#ff0000"><span class=
=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" style=
=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">if (key !=3D 0) {<=
/span></font></div><div><font color=3D"#ff0000"><span class=3D"Ap=
ple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0);">get_serial(key, chip_co=
de, serial_num);</span></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">ser_le=
n =3D strlen(serial_num);</span></font></div><div><font color=3D"=
#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
">}</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">else {</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">			</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0);">ser_len =3D strlen(DEFAULT_SERIAL_NUM=
);</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">			</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0);">memcpy(serial_num, DE=
FAULT_SERIAL_NUM, ser_len);</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0);">			</span></span><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
;">errcode =3D 2;</span></font></div><div><font color=3D"#ff0000"=
><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz=
-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</spa=
n></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">		</=
span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-s=
ize: 0.867rem; color: rgb(0, 0, 0);">/* copy serial from serial_n=
um to sn_buf */</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0);">		</span></span><span data-wiz-span=3D"data-wiz-s=
pan" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">memcpy(c=
ur_serialp, serial_num, ser_len);</span></font></div><div><font c=
olor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-sp=
ace:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0);">		</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0);">cur_serialp +=3D ser_len;</span></font></div><div><font=
 color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-=
space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0);">	</span></span><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0);">}</span></font></div><div><font color=3D"#ff0000"><spa=
n class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-w=
iz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rg=
b(0, 0, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">cur_serialp=20=
=3D '\0';</span></font></div><div><font color=3D"#ff0000"><br></f=
ont></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-s=
pan" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-sp=
an" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">	</span><=
/span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0);">return errcode;</span></font></div=
><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">}</span></=
font></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"da=
ta-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">=
#endif</span></font></div><div><font color=3D"#ff0000"><br></font=
></div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); backg=
round-color: rgb(255, 255, 0);">void mt_boot_init(const struct ap=
p_descriptor *app) <b><span data-wiz-span=3D"data-wiz-span" style=
=3D"color: rgb(0, 0, 255);">&nbsp;--&gt;=B4=D3=B8=C3=BA=AF=CA=FD=CC=
=F8=D7=AA=B5=BDkernel=BD=D7=B6=CE=A3=AC=D2=BB=C8=A5=B2=BB=B8=B4=B7=
=B5</span></b></span></font></div><div><font color=3D"#ff0000"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">{</spa=
n></font></div><div><font color=3D"#ff0000"><span class=3D"Apple-=
tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); backg=
round-color: rgb(255, 255, 0);">	</span></span><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0); background-color: rgb(255, 255, 0);">unsigned usb_init =3D=20=
0;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
; background-color: rgb(255, 255, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0); background-color: rgb(255, 255, 0);">unsigned sz =3D=
 0;</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
; background-color: rgb(255, 255, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0); background-color: rgb(255, 255, 0);">int sec_ret =3D=
 0, errcode =3D 0;</span></font></div><div><font color=3D"#ff0000=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">#i=
fdef SERIAL_NUM_FROM_BARCODE</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255, 2=
55, 0);">char tmp[SN_BUF_LEN+1] =3D {0};</span></font></div><div>=
<font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"w=
hite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255=
, 255, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-col=
or: rgb(255, 255, 0);">unsigned ser_len =3D 0;</span></font></div=
><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-=
color: rgb(255, 255, 0);">#endif</span></font></div><div><font co=
lor=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-spa=
ce:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=
 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0=
);">	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(=
255, 255, 0);">char serial_num[SERIALNO_LEN];</span></font></div>=
<div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-c=
olor: rgb(255, 255, 0);">#ifdef MTK_AB_OTA_UPDATER</span></font><=
/div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span"=20=
style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-colo=
r: rgb(255, 255, 0);">	</span></span><span data-wiz-span=3D"data-=
wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); back=
ground-color: rgb(255, 255, 0);">int ret;</span></font></div><div=
><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-color=
: rgb(255, 255, 0);">#endif</span></font></div><div><font color=3D=
"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0); background-color: rgb(255, 255, 0);">#ifdef CONFIG=
_MTK_USB_UNIQUE_SERIAL</span></font></div><div><font color=3D"#ff=
0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255, 255,=20=
0);">errcode =3D read_product_usbid(sn_buf);</span></font></div><=
div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D=
"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(2=
55, 255, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-c=
olor: rgb(255, 255, 0);">if(errcode) {</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255,=20=
255, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-colo=
r: rgb(255, 255, 0);">dprintf(CRITICAL,"serial number errcode :(%=
d)\n",errcode);</span></font></div><div><font color=3D"#ff0000"><=
span class=3D"Apple-tab-span" style=3D"white-space:pre"><span dat=
a-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=
 rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	</span></spa=
n><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">}<=
/span></font></div><div><font color=3D"#ff0000"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0); background-color: rgb(255, 255, 0);">#else</span></font></=
div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" s=
tyle=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-color=
: rgb(255, 255, 0);">	</span></span><span data-wiz-span=3D"data-w=
iz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); backg=
round-color: rgb(255, 255, 0);">memcpy(sn_buf, DEFAULT_SERIAL_NUM=
, strlen(DEFAULT_SERIAL_NUM));</span></font></div><div><font colo=
r=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255,=20=
255, 0);">#endif</span></font></div><div><font color=3D"#ff0000">=
<br></font></div><div><font color=3D"#ff0000"><span data-wiz-span=
=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0,=
 0); background-color: rgb(255, 255, 0);">#ifdef SERIAL_NUM_FROM_=
BARCODE</span></font></div><div><font color=3D"#ff0000"><span cla=
ss=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-sp=
an=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=20=
0, 0); background-color: rgb(255, 255, 0);">	</span></span><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">ser_len =3D=
 read_product_info(tmp);</span></font></div><div><font color=3D"#=
ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre">=
<span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867re=
m; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	</s=
pan></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-si=
ze: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255, 255=
, 0);">if (ser_len =3D=3D 0) {</span></font></div><div><font colo=
r=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space=
:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0=
.867rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);=
">		</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"=
font-size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(2=
55, 255, 0);">ser_len =3D strlen(DEFAULT_SERIAL_NUM);</span></fon=
t></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-spa=
n" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-c=
olor: rgb(255, 255, 0);">		</span></span><span data-wiz-span=3D"d=
ata-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=20=
background-color: rgb(255, 255, 0);">strncpy(tmp, DEFAULT_SERIAL_=
NUM, ser_len);</span></font></div><div><font color=3D"#ff0000"><s=
pan class=3D"Apple-tab-span" style=3D"white-space:pre"><span data=
-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color:=20=
rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">}</=
span></font></div><div><font color=3D"#ff0000"><span class=3D"App=
le-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); ba=
ckground-color: rgb(255, 255, 0);">	</span></span><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0); background-color: rgb(255, 255, 0);">memset( sn_buf, 0,=20=
sizeof(sn_buf));</span></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">s=
trncpy( sn_buf, tmp, ser_len);</span></font></div><div><font colo=
r=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255,=20=
255, 0);">#endif</span></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">s=
n_buf[SN_BUF_LEN] =3D '\0';</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255, 2=
55, 0);">surf_udc_device.serialno =3D sn_buf;</span></font></div>=
<div><font color=3D"#ff0000"><br></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	<=
/span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-=
size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255, 2=
55, 0);">if (g_boot_mode =3D=3D FASTBOOT)</span></font></div><div=
><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"=
white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"f=
ont-size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(25=
5, 255, 0);">		</span></span><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-c=
olor: rgb(255, 255, 0);">goto fastboot;</span></font></div><div><=
font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff00=
00"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.8=
67rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">=
#ifdef MTK_SECURITY_SW_SUPPORT</span></font></div><div><font colo=
r=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255,=20=
255, 0);">#if MTK_FORCE_VERIFIED_BOOT_SIG_VFY</span></font></div>=
<div><font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=
=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D=
"font-size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(=
255, 255, 0);">	</span></span><span data-wiz-span=3D"data-wiz-spa=
n" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-=
color: rgb(255, 255, 0);">/* verify oem image with android verifi=
ed boot signature instead of mediatek proprietary signature */</s=
pan></font></div><div><font color=3D"#ff0000"><span class=3D"Appl=
e-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"data=
-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); bac=
kground-color: rgb(255, 255, 0);">	</span></span><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0); background-color: rgb(255, 255, 0);">/* verification is p=
ostponed to boot image loading stage */</span></font></div><div><=
font color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"wh=
ite-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"fon=
t-size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255,=
 255, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" s=
tyle=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-colo=
r: rgb(255, 255, 0);">/* note in this case, boot/recovery image w=
ill be verified even when secure boot is disabled */</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-co=
lor: rgb(255, 255, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); ba=
ckground-color: rgb(255, 255, 0);">g_boot_state =3D BOOT_STATE_RE=
D;</span></font></div><div><font color=3D"#ff0000"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0); background-color: rgb(255, 255, 0);">#else</span></font=
></div><div><font color=3D"#ff0000"><span class=3D"Apple-tab-span=
" style=3D"white-space:pre"><span data-wiz-span=3D"data-wiz-span"=
 style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-co=
lor: rgb(255, 255, 0);">	</span></span><span data-wiz-span=3D"dat=
a-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); ba=
ckground-color: rgb(255, 255, 0);">if (0 !=3D sec_boot_check(0))=20=
{</span></font></div><div><font color=3D"#ff0000"><span class=3D"=
Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D"=
data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);=
 background-color: rgb(255, 255, 0);">		</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0); background-color: rgb(255, 255, 0);">g_boot_state =3D=
 BOOT_STATE_RED;</span></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">}=
</span></font></div><div><font color=3D"#ff0000"><span data-wiz-s=
pan=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0,=
 0, 0); background-color: rgb(255, 255, 0);">#endif</span></font>=
</div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); backgr=
ound-color: rgb(255, 255, 0);">#endif</span></font></div><div><fo=
nt color=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000=
"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><span=20=
data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; col=
or: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	</span></=
span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);"=
>/* Will not return */</span></font></div><div><font color=3D"#ff=
0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255, 255,=20=
0);">boot_linux_from_storage();</span></font></div><div><font col=
or=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">fastboot=
:</span></font></div><div><font color=3D"#ff0000"><span data-wiz-=
span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0=
, 0, 0); background-color: rgb(255, 255, 0);">#ifdef MTK_AB_OTA_U=
PDATER</span></font></div><div><font color=3D"#ff0000"><span clas=
s=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-spa=
n=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0=
, 0); background-color: rgb(255, 255, 0);">	</span></span><span d=
ata-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; colo=
r: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">ret =3D set=
_normal_boot(p_AB_suffix, 0);</span></font></div><div><font color=
=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:=
pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.=
867rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);"=
>	</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"fo=
nt-size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255=
, 255, 0);">dprintf(CRITICAL, "[%s:%d] set_normal_boot(%s, 0): %d=
\n", __func__, __LINE__, p_AB_suffix, ret);</span></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-col=
or: rgb(255, 255, 0);">#endif</span></font></div><div><font color=
=3D"#ff0000"><br></font></div><div><font color=3D"#ff0000"><span=20=
class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-wiz=
-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(=
0, 0, 0); background-color: rgb(255, 255, 0);">	</span></span><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">target_=
fastboot_init();</span></font></div><div><font color=3D"#ff0000">=
<span class=3D"Apple-tab-span" style=3D"white-space:pre"><span da=
ta-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color=
: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	</span></sp=
an><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.86=
7rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">i=
f (!usb_init)</span></font></div><div><font color=3D"#ff0000"><sp=
an class=3D"Apple-tab-span" style=3D"white-space:pre"><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0); background-color: rgb(255, 255, 0);">		</span></span=
><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867r=
em; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">/*H=
ong-Rong: wait for porting*/</span></font></div><div><font color=3D=
"#ff0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre=
"><span data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867=
rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	=09=
</span></span><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255,=20=
255, 0);">udc_init(&amp;surf_udc_device);</span></font></div><div=
><font color=3D"#ff0000"><br></font></div><div><font color=3D"#ff=
0000"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><s=
pan data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=
 color: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	</spa=
n></span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size=
: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255, 255,=20=
0);">mt_part_dump();</span></font></div><div><font color=3D"#ff00=
00"><span class=3D"Apple-tab-span" style=3D"white-space:pre"><spa=
n data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; c=
olor: rgb(0, 0, 0); background-color: rgb(255, 255, 0);">	</span>=
</span><span data-wiz-span=3D"data-wiz-span" style=3D"font-size:=20=
0.867rem; color: rgb(0, 0, 0); background-color: rgb(255, 255, 0)=
;">sz =3D target_get_max_flash_size();</span></font></div><div><f=
ont color=3D"#ff0000"><span class=3D"Apple-tab-span" style=3D"whi=
te-space:pre"><span data-wiz-span=3D"data-wiz-span" style=3D"font=
-size: 0.867rem; color: rgb(0, 0, 0); background-color: rgb(255,=20=
255, 0);">	</span></span><span data-wiz-span=3D"data-wiz-span" st=
yle=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-color=
: rgb(255, 255, 0);">fastboot_init(target_get_scratch_address(),=20=
sz);</span></font></div><div><font color=3D"#ff0000"><span class=3D=
"Apple-tab-span" style=3D"white-space:pre"><span data-wiz-span=3D=
"data-wiz-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0)=
; background-color: rgb(255, 255, 0);">	</span></span><span data-=
wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem; color: r=
gb(0, 0, 0); background-color: rgb(255, 255, 0);">udc_start();</s=
pan></font></div><div><font color=3D"#ff0000"><br></font></div><d=
iv><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span"=20=
style=3D"font-size: 0.867rem; color: rgb(0, 0, 0); background-col=
or: rgb(255, 255, 0);">}</span></font></div><div><font color=3D"#=
ff0000"><br></font></div><div><font color=3D"#ff0000"><br></font>=
</div><div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wi=
z-span" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">APP_S=
TART(mt_boot)</span></font></div><div><font color=3D"#ff0000"><sp=
an data-wiz-span=3D"data-wiz-span" style=3D"font-size: 0.867rem;=20=
color: rgb(0, 0, 0);">.init =3D mt_boot_init,</span></font></div>=
<div><font color=3D"#ff0000"><span data-wiz-span=3D"data-wiz-span=
" style=3D"font-size: 0.867rem; color: rgb(0, 0, 0);">&nbsp;APP_E=
ND</span></font></div></div></div></span></div></body></html>

------=_Next_Part_0138475656.264--

------=_Next_Part_0415426968.942--

